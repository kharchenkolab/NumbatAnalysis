
Attaching package: ‘dplyr’

The following objects are masked from ‘package:stats’:

    filter, lag

The following objects are masked from ‘package:base’:

    intersect, setdiff, setequal, union


Attaching package: ‘data.table’

The following objects are masked from ‘package:dplyr’:

    between, first, last

ℹ Loading numbat
Registered S3 method overwritten by 'vegan':
  method     from      
  rev.hclust dendextend
Warning message:
replacing previous import ‘Matrix::expand’ by ‘ggtree::expand’ when loading ‘numbat’ 
INFO [2022-04-07 20:20:53] Parsing gene order file: /home/tenggao/inferCNV/hg38_gene_order.txt
INFO [2022-04-07 20:20:53] Parsing cell annotations file: /home/tenggao/paper_data/infercnv_out/47491_Primary_0.1_0/47491_Primary_annot.tsv
INFO [2022-04-07 20:20:53] ::order_reduce:Start.
INFO [2022-04-07 20:20:53] .order_reduce(): expr and order match.
INFO [2022-04-07 20:20:53] ::process_data:order_reduce:Reduction from positional data, new dimensions (r,c) = 21034,494 Total=180067221 Min=0 Max=6089512.
INFO [2022-04-07 20:20:53] num genes removed taking into account provided gene ordering list: 2169 = 10.3118760102691% removed.
INFO [2022-04-07 20:20:53] -filtering out cells < 100 or > Inf, removing 0 % of cells
INFO [2022-04-07 20:20:53] validating infercnv_obj
INFO [2022-04-07 20:20:53] ::process_data:Start
INFO [2022-04-07 20:20:53] 

	STEP 1: incoming data

INFO [2022-04-07 20:20:53] 

	STEP 02: Removing lowly expressed genes

INFO [2022-04-07 20:20:53] ::above_min_mean_expr_cutoff:Start
INFO [2022-04-07 20:20:53] Removing 5098 genes from matrix as below mean expr threshold: 0.1
INFO [2022-04-07 20:20:53] validating infercnv_obj
INFO [2022-04-07 20:20:53] There are 13767 genes and 494 cells remaining in the expr matrix.
INFO [2022-04-07 20:20:54] Removed 2259 genes having fewer than 3 min cells per gene = 16.4088 % genes removed here
INFO [2022-04-07 20:20:54] validating infercnv_obj
INFO [2022-04-07 20:20:54] 

	STEP 03: normalization by sequencing depth

INFO [2022-04-07 20:20:54] normalizing counts matrix by depth
INFO [2022-04-07 20:20:55] Computed total sum normalization factor as median libsize: 2213.000000
INFO [2022-04-07 20:20:55] Adding h-spike
INFO [2022-04-07 20:20:55] -hspike modeling of Plasma_ref
INFO [2022-04-07 20:22:40] validating infercnv_obj
INFO [2022-04-07 20:22:40] normalizing counts matrix by depth
INFO [2022-04-07 20:22:40] Using specified normalization factor: 2213.000000
INFO [2022-04-07 20:22:41] 

	STEP 04: log transformation of data

INFO [2022-04-07 20:22:41] transforming log2xplus1()
INFO [2022-04-07 20:22:41] -mirroring for hspike
INFO [2022-04-07 20:22:41] transforming log2xplus1()
INFO [2022-04-07 20:22:43] 

	STEP 08: removing average of reference data (before smoothing)

INFO [2022-04-07 20:22:43] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 20:22:43] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 20:22:46] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 20:26:34] -mirroring for hspike
INFO [2022-04-07 20:26:34] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 20:26:34] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 20:26:37] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 20:26:41] 

	STEP 09: apply max centered expression threshold: 3

INFO [2022-04-07 20:26:41] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 20:26:41] -mirroring for hspike
INFO [2022-04-07 20:26:41] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 20:26:44] 

	STEP 10: Smoothing data per cell by chromosome

INFO [2022-04-07 20:26:44] smooth_by_chromosome: chr: chr1
INFO [2022-04-07 20:26:45] smooth_by_chromosome: chr: chr2
INFO [2022-04-07 20:26:45] smooth_by_chromosome: chr: chr3
INFO [2022-04-07 20:26:46] smooth_by_chromosome: chr: chr4
INFO [2022-04-07 20:26:46] smooth_by_chromosome: chr: chr5
INFO [2022-04-07 20:26:47] smooth_by_chromosome: chr: chr6
INFO [2022-04-07 20:26:47] smooth_by_chromosome: chr: chr7
INFO [2022-04-07 20:26:48] smooth_by_chromosome: chr: chr8
INFO [2022-04-07 20:26:48] smooth_by_chromosome: chr: chr9
INFO [2022-04-07 20:26:49] smooth_by_chromosome: chr: chr10
INFO [2022-04-07 20:26:49] smooth_by_chromosome: chr: chr11
INFO [2022-04-07 20:26:49] smooth_by_chromosome: chr: chr12
INFO [2022-04-07 20:26:50] smooth_by_chromosome: chr: chr13
INFO [2022-04-07 20:26:50] smooth_by_chromosome: chr: chr14
INFO [2022-04-07 20:26:51] smooth_by_chromosome: chr: chr15
INFO [2022-04-07 20:26:51] smooth_by_chromosome: chr: chr16
INFO [2022-04-07 20:26:52] smooth_by_chromosome: chr: chr17
INFO [2022-04-07 20:26:52] smooth_by_chromosome: chr: chr18
INFO [2022-04-07 20:26:53] smooth_by_chromosome: chr: chr19
INFO [2022-04-07 20:26:53] smooth_by_chromosome: chr: chr20
INFO [2022-04-07 20:26:54] smooth_by_chromosome: chr: chr21
INFO [2022-04-07 20:26:54] smooth_by_chromosome: chr: chr22
INFO [2022-04-07 20:26:54] -mirroring for hspike
INFO [2022-04-07 20:26:54] smooth_by_chromosome: chr: chrA
INFO [2022-04-07 20:26:55] smooth_by_chromosome: chr: chr_0
INFO [2022-04-07 20:26:55] smooth_by_chromosome: chr: chr_B
INFO [2022-04-07 20:26:55] smooth_by_chromosome: chr: chr_0pt5
INFO [2022-04-07 20:26:55] smooth_by_chromosome: chr: chr_C
INFO [2022-04-07 20:26:55] smooth_by_chromosome: chr: chr_1pt5
INFO [2022-04-07 20:26:56] smooth_by_chromosome: chr: chr_D
INFO [2022-04-07 20:26:56] smooth_by_chromosome: chr: chr_2pt0
INFO [2022-04-07 20:26:56] smooth_by_chromosome: chr: chr_E
INFO [2022-04-07 20:26:56] smooth_by_chromosome: chr: chr_3pt0
INFO [2022-04-07 20:26:56] smooth_by_chromosome: chr: chr_F
INFO [2022-04-07 20:27:01] 

	STEP 11: re-centering data across chromosome after smoothing

INFO [2022-04-07 20:27:01] ::center_smooth across chromosomes per cell
INFO [2022-04-07 20:27:02] -mirroring for hspike
INFO [2022-04-07 20:27:02] ::center_smooth across chromosomes per cell
INFO [2022-04-07 20:27:06] 

	STEP 12: removing average of reference data (after smoothing)

INFO [2022-04-07 20:27:06] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 20:27:06] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 20:27:09] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 20:27:09] -mirroring for hspike
INFO [2022-04-07 20:27:09] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 20:27:09] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 20:27:12] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 20:27:17] 

	STEP 14: invert log2(FC) to FC

INFO [2022-04-07 20:27:17] invert_log2(), computing 2^x
INFO [2022-04-07 20:27:17] -mirroring for hspike
INFO [2022-04-07 20:27:17] invert_log2(), computing 2^x
INFO [2022-04-07 20:27:24] 

	STEP 15: Clustering samples (not defining tumor subclusters)

INFO [2022-04-07 20:27:24] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 20:27:24] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 20:27:31] cut tree into: 1 groups
INFO [2022-04-07 20:27:31] -processing all_observations,all_observations_s1
INFO [2022-04-07 20:27:31] define_signif_tumor_subclusters(), tumor: Plasma_ref
INFO [2022-04-07 20:27:31] -mirroring for hspike
INFO [2022-04-07 20:27:31] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 20:27:31] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 20:27:31] cut tree into: 1 groups
INFO [2022-04-07 20:27:31] -processing all_observations,all_observations_s1
INFO [2022-04-07 20:27:31] define_signif_tumor_subclusters(), tumor: simnorm_cell_Plasma_ref
INFO [2022-04-07 20:27:31] cut tree into: 1 groups
INFO [2022-04-07 20:27:31] -processing simnorm_cell_Plasma_ref,simnorm_cell_Plasma_ref_s1
INFO [2022-04-07 20:27:44] 

	STEP 17: HMM-based CNV prediction

INFO [2022-04-07 20:27:44] predict_CNV_via_HMM_on_whole_tumor_samples
INFO [2022-04-07 20:27:46] -done predicting CNV based on initial tumor subclusters
INFO [2022-04-07 20:27:46] get_predicted_CNV_regions(consensus)
INFO [2022-04-07 20:27:46] -processing cell_group_name: Plasma_ref, size: 2
INFO [2022-04-07 20:27:55] -processing cell_group_name: Plasma, size: 492
INFO [2022-04-07 20:28:08] -writing cell clusters file: /home/tenggao/paper_data/infercnv_out/47491_Primary_0.1_0/17_HMM_predHMMi6.hmm_mode-samples.cell_groupings
INFO [2022-04-07 20:28:08] -writing cnv regions file: /home/tenggao/paper_data/infercnv_out/47491_Primary_0.1_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_regions.dat
INFO [2022-04-07 20:28:08] -writing per-gene cnv report: /home/tenggao/paper_data/infercnv_out/47491_Primary_0.1_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_genes.dat
INFO [2022-04-07 20:28:08] -writing gene ordering info: /home/tenggao/paper_data/infercnv_out/47491_Primary_0.1_0/17_HMM_predHMMi6.hmm_mode-samples.genes_used.dat
INFO [2022-04-07 20:28:11] ::plot_cnv:Start
INFO [2022-04-07 20:28:11] ::plot_cnv:Current data dimensions (r,c)=11508,494 Total=16662240 Min=1 Max=4.
INFO [2022-04-07 20:28:11] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 20:28:16] plot_cnv_observation:Start
INFO [2022-04-07 20:28:16] Observation data size: Cells= 492 Genes= 11508
INFO [2022-04-07 20:28:16] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 20:28:21] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 20:28:21] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 20:28:21] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 20:28:21] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 20:28:22] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 20:28:22] Quantiles of plotted data range: 1,3,3,3,4
INFO [2022-04-07 20:28:23] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.1_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.observations.txt
INFO [2022-04-07 20:28:28] plot_cnv_references:Start
INFO [2022-04-07 20:28:28] Reference data size: Cells= 2 Genes= 11508
INFO [2022-04-07 20:28:28] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 20:28:28] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 20:28:28] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 20:28:28] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 20:28:28] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.1_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.references.txt
INFO [2022-04-07 20:28:28] 

	STEP 18: Run Bayesian Network Model on HMM predicted CNVs

INFO [2022-04-07 20:28:29] Initializing new MCM InferCNV Object.
INFO [2022-04-07 20:28:29] validating infercnv_obj
INFO [2022-04-07 20:28:29] Total CNV's:  36
INFO [2022-04-07 20:28:29] Loading BUGS Model.
INFO [2022-04-07 20:28:29] Running Sampling Using Parallel with  30 Cores
INFO [2022-04-07 20:31:36] Obtaining probabilities post-sampling
INFO [2022-04-07 20:32:54] Gibbs sampling time:  4.41741635402044  Minutes
INFO [2022-04-07 20:33:01] ::plot_cnv:Start
INFO [2022-04-07 20:33:01] ::plot_cnv:Current data dimensions (r,c)=11508,494 Total=749984.277729282 Min=0 Max=0.947956558589826.
INFO [2022-04-07 20:33:01] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 20:33:01] plot_cnv_observation:Start
INFO [2022-04-07 20:33:01] Observation data size: Cells= 492 Genes= 11508
INFO [2022-04-07 20:33:01] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 20:33:06] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 20:33:06] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 20:33:06] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 20:33:06] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 20:33:06] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 20:33:06] Quantiles of plotted data range: 0,0,0,0,0.947956558589826
INFO [2022-04-07 20:33:07] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.1_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.observations.txt
INFO [2022-04-07 20:33:11] plot_cnv_references:Start
INFO [2022-04-07 20:33:11] Reference data size: Cells= 2 Genes= 11508
INFO [2022-04-07 20:33:11] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 20:33:11] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 20:33:11] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 20:33:11] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 20:33:11] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.1_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.references.txt
INFO [2022-04-07 20:33:18] 

	STEP 19: Filter HMM predicted CNVs based on the Bayesian Network Model results and BayesMaxPNormal

INFO [2022-04-07 20:33:18] Attempting to removing CNV(s) with a probability of being normal above  0.5
INFO [2022-04-07 20:33:18] Removing  0  CNV(s) identified by the HMM.
INFO [2022-04-07 20:33:18] Reassigning CNVs based on state probabilities.
INFO [2022-04-07 20:33:18] Changing the following CNV's states assigned by the HMM to the following based on the CNV's state probabilities.
 chr1-region_26 : 2  (P= 0.195135633703598 ) ->  1 (P= 0.512709009652529 )
chr1-region_28 : 2  (P= 0.354734173514281 ) ->  1 (P= 0.38500213971736 )
chr1-region_32 : 4  (P= 0.454667953328787 ) ->  3 (P= 0.483019959697498 )
chr11-region_59 : 2  (P= 0.38314223964286 ) ->  1 (P= 0.392272723243637 )
chr11-region_63 : 4  (P= 0.346291758555921 ) ->  3 (P= 0.441748209838367 )
INFO [2022-04-07 20:33:18] Creating Plots for CNV and cell Probabilities.
INFO [2022-04-07 20:33:45] ::plot_cnv:Start
INFO [2022-04-07 20:33:45] ::plot_cnv:Current data dimensions (r,c)=11508,494 Total=749984.277729282 Min=0 Max=0.947956558589826.
INFO [2022-04-07 20:33:45] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 20:33:46] plot_cnv_observation:Start
INFO [2022-04-07 20:33:46] Observation data size: Cells= 492 Genes= 11508
INFO [2022-04-07 20:33:46] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 20:33:50] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 20:33:50] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 20:33:50] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 20:33:50] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 20:33:51] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 20:33:51] Quantiles of plotted data range: 0,0,0,0,0.947956558589826
INFO [2022-04-07 20:33:51] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.1_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.observations.txt
INFO [2022-04-07 20:33:55] plot_cnv_references:Start
INFO [2022-04-07 20:33:55] Reference data size: Cells= 2 Genes= 11508
INFO [2022-04-07 20:33:55] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 20:33:55] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 20:33:55] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 20:33:55] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 20:33:55] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.1_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.references.txt
INFO [2022-04-07 20:33:59] ::plot_cnv:Start
INFO [2022-04-07 20:33:59] ::plot_cnv:Current data dimensions (r,c)=11508,494 Total=16577124 Min=1 Max=4.
INFO [2022-04-07 20:33:59] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 20:34:04] plot_cnv_observation:Start
INFO [2022-04-07 20:34:04] Observation data size: Cells= 492 Genes= 11508
INFO [2022-04-07 20:34:04] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 20:34:09] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 20:34:09] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 20:34:09] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 20:34:09] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 20:34:09] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 20:34:09] Quantiles of plotted data range: 1,3,3,3,4
INFO [2022-04-07 20:34:10] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.1_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.observations.txt
INFO [2022-04-07 20:34:15] plot_cnv_references:Start
INFO [2022-04-07 20:34:15] Reference data size: Cells= 2 Genes= 11508
INFO [2022-04-07 20:34:15] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 20:34:15] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 20:34:15] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 20:34:15] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 20:34:15] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.1_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.references.txt
INFO [2022-04-07 20:34:15] 

	STEP 20: Converting HMM-based CNV states to repr expr vals

INFO [2022-04-07 20:34:18] ::plot_cnv:Start
INFO [2022-04-07 20:34:18] ::plot_cnv:Current data dimensions (r,c)=11508,494 Total=5446086 Min=0 Max=1.5.
INFO [2022-04-07 20:34:18] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 20:34:23] plot_cnv_observation:Start
INFO [2022-04-07 20:34:23] Observation data size: Cells= 492 Genes= 11508
INFO [2022-04-07 20:34:23] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 20:34:28] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 20:34:28] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 20:34:28] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 20:34:28] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 20:34:29] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 20:34:29] Quantiles of plotted data range: 0,1,1,1,1.5
INFO [2022-04-07 20:34:29] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.1_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.observations.txt
INFO [2022-04-07 20:34:34] plot_cnv_references:Start
INFO [2022-04-07 20:34:34] Reference data size: Cells= 2 Genes= 11508
INFO [2022-04-07 20:34:34] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 20:34:34] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 20:34:34] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 20:34:34] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 20:34:34] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.1_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.references.txt
INFO [2022-04-07 20:34:34] 

	STEP 22: Denoising

INFO [2022-04-07 20:34:34] ::process_data:Remove noise, noise threshold defined via ref mean sd_amplifier:  1.5
INFO [2022-04-07 20:34:34] denoising using mean(normal) +- sd_amplifier * sd(normal) per gene per cell across all data
INFO [2022-04-07 20:34:34] :: **** clear_noise_via_ref_quantiles **** : removing noise between bounds:  1 - 1
INFO [2022-04-07 20:34:47] 

## Making the final infercnv heatmap ##
INFO [2022-04-07 20:34:48] ::plot_cnv:Start
INFO [2022-04-07 20:34:48] ::plot_cnv:Current data dimensions (r,c)=11508,494 Total=5683653.28111868 Min=0.780654417360513 Max=1.27655638007911.
INFO [2022-04-07 20:34:48] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 20:34:54] plot_cnv(): auto thresholding at: (0.921107 , 1.078893)
INFO [2022-04-07 20:34:54] plot_cnv_observation:Start
INFO [2022-04-07 20:34:54] Observation data size: Cells= 492 Genes= 11508
INFO [2022-04-07 20:34:54] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 20:34:59] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 20:34:59] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 20:34:59] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 20:34:59] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 20:35:00] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 20:35:00] Quantiles of plotted data range: 0.921106808784506,0.983246389075086,1,1.01714055441634,1.07889319121549
INFO [2022-04-07 20:35:01] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.1_0/infercnv.observations.txt
INFO [2022-04-07 20:35:06] plot_cnv_references:Start
INFO [2022-04-07 20:35:06] Reference data size: Cells= 2 Genes= 11508
INFO [2022-04-07 20:35:06] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 20:35:06] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 20:35:06] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 20:35:06] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 20:35:06] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.1_0/infercnv.references.txt
INFO [2022-04-07 20:35:07] Parsing gene order file: /home/tenggao/inferCNV/hg38_gene_order.txt
INFO [2022-04-07 20:35:07] Parsing cell annotations file: /home/tenggao/paper_data/infercnv_out/47491_Primary_0.3_0/47491_Primary_annot.tsv
INFO [2022-04-07 20:35:07] ::order_reduce:Start.
INFO [2022-04-07 20:35:07] .order_reduce(): expr and order match.
INFO [2022-04-07 20:35:07] ::process_data:order_reduce:Reduction from positional data, new dimensions (r,c) = 21034,494 Total=180752858 Min=0 Max=6089512.
INFO [2022-04-07 20:35:07] num genes removed taking into account provided gene ordering list: 2169 = 10.3118760102691% removed.
INFO [2022-04-07 20:35:07] -filtering out cells < 100 or > Inf, removing 0 % of cells
INFO [2022-04-07 20:35:07] validating infercnv_obj
INFO [2022-04-07 20:35:07] ::process_data:Start
INFO [2022-04-07 20:35:07] 

	STEP 1: incoming data

INFO [2022-04-07 20:35:08] 

	STEP 02: Removing lowly expressed genes

INFO [2022-04-07 20:35:08] ::above_min_mean_expr_cutoff:Start
INFO [2022-04-07 20:35:08] Removing 5083 genes from matrix as below mean expr threshold: 0.1
INFO [2022-04-07 20:35:08] validating infercnv_obj
INFO [2022-04-07 20:35:08] There are 13782 genes and 494 cells remaining in the expr matrix.
INFO [2022-04-07 20:35:08] Removed 2000 genes having fewer than 3 min cells per gene = 14.5117 % genes removed here
INFO [2022-04-07 20:35:08] validating infercnv_obj
INFO [2022-04-07 20:35:09] 

	STEP 03: normalization by sequencing depth

INFO [2022-04-07 20:35:09] normalizing counts matrix by depth
INFO [2022-04-07 20:35:09] Computed total sum normalization factor as median libsize: 2702.000000
INFO [2022-04-07 20:35:09] Adding h-spike
INFO [2022-04-07 20:35:09] -hspike modeling of Plasma_ref
INFO [2022-04-07 20:36:46] validating infercnv_obj
INFO [2022-04-07 20:36:46] normalizing counts matrix by depth
INFO [2022-04-07 20:36:46] Using specified normalization factor: 2702.000000
INFO [2022-04-07 20:36:47] 

	STEP 04: log transformation of data

INFO [2022-04-07 20:36:47] transforming log2xplus1()
INFO [2022-04-07 20:36:47] -mirroring for hspike
INFO [2022-04-07 20:36:47] transforming log2xplus1()
INFO [2022-04-07 20:36:49] 

	STEP 08: removing average of reference data (before smoothing)

INFO [2022-04-07 20:36:49] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 20:36:49] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 20:36:52] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 20:38:48] -mirroring for hspike
INFO [2022-04-07 20:38:48] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 20:38:48] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 20:38:51] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 20:38:55] 

	STEP 09: apply max centered expression threshold: 3

INFO [2022-04-07 20:38:55] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 20:38:55] -mirroring for hspike
INFO [2022-04-07 20:38:55] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 20:38:58] 

	STEP 10: Smoothing data per cell by chromosome

INFO [2022-04-07 20:38:58] smooth_by_chromosome: chr: chr1
INFO [2022-04-07 20:38:58] smooth_by_chromosome: chr: chr2
INFO [2022-04-07 20:38:59] smooth_by_chromosome: chr: chr3
INFO [2022-04-07 20:39:00] smooth_by_chromosome: chr: chr4
INFO [2022-04-07 20:39:00] smooth_by_chromosome: chr: chr5
INFO [2022-04-07 20:39:00] smooth_by_chromosome: chr: chr6
INFO [2022-04-07 20:39:01] smooth_by_chromosome: chr: chr7
INFO [2022-04-07 20:39:01] smooth_by_chromosome: chr: chr8
INFO [2022-04-07 20:39:02] smooth_by_chromosome: chr: chr9
INFO [2022-04-07 20:39:02] smooth_by_chromosome: chr: chr10
INFO [2022-04-07 20:39:03] smooth_by_chromosome: chr: chr11
INFO [2022-04-07 20:39:03] smooth_by_chromosome: chr: chr12
INFO [2022-04-07 20:39:04] smooth_by_chromosome: chr: chr13
INFO [2022-04-07 20:39:04] smooth_by_chromosome: chr: chr14
INFO [2022-04-07 20:39:04] smooth_by_chromosome: chr: chr15
INFO [2022-04-07 20:39:05] smooth_by_chromosome: chr: chr16
INFO [2022-04-07 20:39:05] smooth_by_chromosome: chr: chr17
INFO [2022-04-07 20:39:06] smooth_by_chromosome: chr: chr18
INFO [2022-04-07 20:39:06] smooth_by_chromosome: chr: chr19
INFO [2022-04-07 20:39:07] smooth_by_chromosome: chr: chr20
INFO [2022-04-07 20:39:07] smooth_by_chromosome: chr: chr21
INFO [2022-04-07 20:39:07] smooth_by_chromosome: chr: chr22
INFO [2022-04-07 20:39:08] -mirroring for hspike
INFO [2022-04-07 20:39:08] smooth_by_chromosome: chr: chrA
INFO [2022-04-07 20:39:08] smooth_by_chromosome: chr: chr_0
INFO [2022-04-07 20:39:08] smooth_by_chromosome: chr: chr_B
INFO [2022-04-07 20:39:08] smooth_by_chromosome: chr: chr_0pt5
INFO [2022-04-07 20:39:09] smooth_by_chromosome: chr: chr_C
INFO [2022-04-07 20:39:09] smooth_by_chromosome: chr: chr_1pt5
INFO [2022-04-07 20:39:09] smooth_by_chromosome: chr: chr_D
INFO [2022-04-07 20:39:09] smooth_by_chromosome: chr: chr_2pt0
INFO [2022-04-07 20:39:09] smooth_by_chromosome: chr: chr_E
INFO [2022-04-07 20:39:09] smooth_by_chromosome: chr: chr_3pt0
INFO [2022-04-07 20:39:10] smooth_by_chromosome: chr: chr_F
INFO [2022-04-07 20:39:14] 

	STEP 11: re-centering data across chromosome after smoothing

INFO [2022-04-07 20:39:14] ::center_smooth across chromosomes per cell
INFO [2022-04-07 20:39:15] -mirroring for hspike
INFO [2022-04-07 20:39:15] ::center_smooth across chromosomes per cell
INFO [2022-04-07 20:39:20] 

	STEP 12: removing average of reference data (after smoothing)

INFO [2022-04-07 20:39:20] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 20:39:20] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 20:39:22] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 20:39:23] -mirroring for hspike
INFO [2022-04-07 20:39:23] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 20:39:23] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 20:39:26] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 20:39:30] 

	STEP 14: invert log2(FC) to FC

INFO [2022-04-07 20:39:30] invert_log2(), computing 2^x
INFO [2022-04-07 20:39:31] -mirroring for hspike
INFO [2022-04-07 20:39:31] invert_log2(), computing 2^x
INFO [2022-04-07 20:39:37] 

	STEP 15: Clustering samples (not defining tumor subclusters)

INFO [2022-04-07 20:39:37] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 20:39:37] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 20:39:45] cut tree into: 1 groups
INFO [2022-04-07 20:39:45] -processing all_observations,all_observations_s1
INFO [2022-04-07 20:39:45] define_signif_tumor_subclusters(), tumor: Plasma_ref
INFO [2022-04-07 20:39:45] -mirroring for hspike
INFO [2022-04-07 20:39:45] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 20:39:45] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 20:39:45] cut tree into: 1 groups
INFO [2022-04-07 20:39:45] -processing all_observations,all_observations_s1
INFO [2022-04-07 20:39:45] define_signif_tumor_subclusters(), tumor: simnorm_cell_Plasma_ref
INFO [2022-04-07 20:39:45] cut tree into: 1 groups
INFO [2022-04-07 20:39:45] -processing simnorm_cell_Plasma_ref,simnorm_cell_Plasma_ref_s1
INFO [2022-04-07 20:39:58] 

	STEP 17: HMM-based CNV prediction

INFO [2022-04-07 20:39:58] predict_CNV_via_HMM_on_whole_tumor_samples
INFO [2022-04-07 20:39:59] -done predicting CNV based on initial tumor subclusters
INFO [2022-04-07 20:39:59] get_predicted_CNV_regions(consensus)
INFO [2022-04-07 20:39:59] -processing cell_group_name: Plasma_ref, size: 2
INFO [2022-04-07 20:40:08] -processing cell_group_name: Plasma, size: 492
INFO [2022-04-07 20:40:20] -writing cell clusters file: /home/tenggao/paper_data/infercnv_out/47491_Primary_0.3_0/17_HMM_predHMMi6.hmm_mode-samples.cell_groupings
INFO [2022-04-07 20:40:20] -writing cnv regions file: /home/tenggao/paper_data/infercnv_out/47491_Primary_0.3_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_regions.dat
INFO [2022-04-07 20:40:20] -writing per-gene cnv report: /home/tenggao/paper_data/infercnv_out/47491_Primary_0.3_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_genes.dat
INFO [2022-04-07 20:40:20] -writing gene ordering info: /home/tenggao/paper_data/infercnv_out/47491_Primary_0.3_0/17_HMM_predHMMi6.hmm_mode-samples.genes_used.dat
INFO [2022-04-07 20:40:24] ::plot_cnv:Start
INFO [2022-04-07 20:40:24] ::plot_cnv:Current data dimensions (r,c)=11782,494 Total=17586876 Min=1 Max=4.
INFO [2022-04-07 20:40:24] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 20:40:29] plot_cnv_observation:Start
INFO [2022-04-07 20:40:29] Observation data size: Cells= 492 Genes= 11782
INFO [2022-04-07 20:40:29] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 20:40:34] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 20:40:34] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 20:40:34] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 20:40:34] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 20:40:35] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 20:40:35] Quantiles of plotted data range: 1,3,3,3,4
INFO [2022-04-07 20:40:36] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.3_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.observations.txt
INFO [2022-04-07 20:40:41] plot_cnv_references:Start
INFO [2022-04-07 20:40:41] Reference data size: Cells= 2 Genes= 11782
INFO [2022-04-07 20:40:41] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 20:40:41] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 20:40:41] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 20:40:41] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 20:40:41] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.3_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.references.txt
INFO [2022-04-07 20:40:41] 

	STEP 18: Run Bayesian Network Model on HMM predicted CNVs

INFO [2022-04-07 20:40:43] Initializing new MCM InferCNV Object.
INFO [2022-04-07 20:40:43] validating infercnv_obj
INFO [2022-04-07 20:40:43] Total CNV's:  56
INFO [2022-04-07 20:40:43] Loading BUGS Model.
INFO [2022-04-07 20:40:43] Running Sampling Using Parallel with  30 Cores
INFO [2022-04-07 20:45:17] Obtaining probabilities post-sampling
INFO [2022-04-07 20:47:20] Gibbs sampling time:  6.61466935078303  Minutes
INFO [2022-04-07 20:47:27] ::plot_cnv:Start
INFO [2022-04-07 20:47:27] ::plot_cnv:Current data dimensions (r,c)=11782,494 Total=1106072.86920301 Min=0 Max=0.993940233427008.
INFO [2022-04-07 20:47:27] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 20:47:27] plot_cnv_observation:Start
INFO [2022-04-07 20:47:27] Observation data size: Cells= 492 Genes= 11782
INFO [2022-04-07 20:47:27] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 20:47:32] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 20:47:32] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 20:47:32] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 20:47:32] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 20:47:32] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 20:47:32] Quantiles of plotted data range: 0,0,0,0.536063300227673,0.993940233427008
INFO [2022-04-07 20:47:33] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.3_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.observations.txt
INFO [2022-04-07 20:47:38] plot_cnv_references:Start
INFO [2022-04-07 20:47:38] Reference data size: Cells= 2 Genes= 11782
INFO [2022-04-07 20:47:38] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 20:47:38] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 20:47:38] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 20:47:38] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 20:47:38] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.3_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.references.txt
INFO [2022-04-07 20:47:45] 

	STEP 19: Filter HMM predicted CNVs based on the Bayesian Network Model results and BayesMaxPNormal

INFO [2022-04-07 20:47:45] Attempting to removing CNV(s) with a probability of being normal above  0.5
INFO [2022-04-07 20:47:45] Removing  0  CNV(s) identified by the HMM.
INFO [2022-04-07 20:47:45] Reassigning CNVs based on state probabilities.
INFO [2022-04-07 20:47:45] Changing the following CNV's states assigned by the HMM to the following based on the CNV's state probabilities.
 chr1-region_26 : 2  (P= 0.254753597971193 ) ->  1 (P= 0.478607622582932 )
chr1-region_32 : 4  (P= 0.45987446399706 ) ->  3 (P= 0.47211899592855 )
chr3-region_37 : 4  (P= 0.440821410569909 ) ->  3 (P= 0.499424327608135 )
chr9-region_65 : 4  (P= 0.458497781913346 ) ->  3 (P= 0.459229646782099 )
chr11-region_73 : 2  (P= 0.3977348722118 ) ->  1 (P= 0.415517619904825 )
chr11-region_77 : 4  (P= 0.436513340318409 ) ->  3 (P= 0.450367431925107 )
chr11-region_79 : 4  (P= 0.32670463050859 ) ->  3 (P= 0.463936699772327 )
chr12-region_84 : 4  (P= 0.437506843565227 ) ->  3 (P= 0.462992228206475 )
chr15-region_93 : 4  (P= 0.469845418377849 ) ->  3 (P= 0.470132608091776 )
chr16-region_99 : 4  (P= 0.461584386571708 ) ->  3 (P= 0.471667611528469 )
chr19-region_123 : 4  (P= 0.275151745722342 ) ->  3 (P= 0.471206394539389 )
INFO [2022-04-07 20:47:45] Creating Plots for CNV and cell Probabilities.
INFO [2022-04-07 20:48:25] ::plot_cnv:Start
INFO [2022-04-07 20:48:25] ::plot_cnv:Current data dimensions (r,c)=11782,494 Total=1106072.86920301 Min=0 Max=0.993940233427008.
INFO [2022-04-07 20:48:25] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 20:48:25] plot_cnv_observation:Start
INFO [2022-04-07 20:48:25] Observation data size: Cells= 492 Genes= 11782
INFO [2022-04-07 20:48:25] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 20:48:30] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 20:48:30] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 20:48:30] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 20:48:30] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 20:48:31] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 20:48:31] Quantiles of plotted data range: 0,0,0,0.536063300227673,0.993940233427008
INFO [2022-04-07 20:48:32] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.3_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.observations.txt
INFO [2022-04-07 20:48:36] plot_cnv_references:Start
INFO [2022-04-07 20:48:36] Reference data size: Cells= 2 Genes= 11782
INFO [2022-04-07 20:48:36] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 20:48:36] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 20:48:36] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 20:48:36] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 20:48:36] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.3_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.references.txt
INFO [2022-04-07 20:48:40] ::plot_cnv:Start
INFO [2022-04-07 20:48:40] ::plot_cnv:Current data dimensions (r,c)=11782,494 Total=17348748 Min=1 Max=4.
INFO [2022-04-07 20:48:40] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 20:48:45] plot_cnv_observation:Start
INFO [2022-04-07 20:48:45] Observation data size: Cells= 492 Genes= 11782
INFO [2022-04-07 20:48:45] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 20:48:50] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 20:48:50] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 20:48:50] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 20:48:50] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 20:48:51] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 20:48:51] Quantiles of plotted data range: 1,3,3,3,4
INFO [2022-04-07 20:48:52] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.3_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.observations.txt
INFO [2022-04-07 20:48:57] plot_cnv_references:Start
INFO [2022-04-07 20:48:57] Reference data size: Cells= 2 Genes= 11782
INFO [2022-04-07 20:48:57] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 20:48:57] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 20:48:57] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 20:48:57] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 20:48:57] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.3_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.references.txt
INFO [2022-04-07 20:48:57] 

	STEP 20: Converting HMM-based CNV states to repr expr vals

INFO [2022-04-07 20:49:00] ::plot_cnv:Start
INFO [2022-04-07 20:49:00] ::plot_cnv:Current data dimensions (r,c)=11782,494 Total=5764220 Min=0 Max=1.5.
INFO [2022-04-07 20:49:00] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 20:49:06] plot_cnv_observation:Start
INFO [2022-04-07 20:49:06] Observation data size: Cells= 492 Genes= 11782
INFO [2022-04-07 20:49:06] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 20:49:11] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 20:49:11] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 20:49:11] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 20:49:11] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 20:49:11] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 20:49:11] Quantiles of plotted data range: 0,1,1,1,1.5
INFO [2022-04-07 20:49:12] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.3_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.observations.txt
INFO [2022-04-07 20:49:17] plot_cnv_references:Start
INFO [2022-04-07 20:49:17] Reference data size: Cells= 2 Genes= 11782
INFO [2022-04-07 20:49:17] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 20:49:17] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 20:49:17] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 20:49:17] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 20:49:17] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.3_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.references.txt
INFO [2022-04-07 20:49:17] 

	STEP 22: Denoising

INFO [2022-04-07 20:49:17] ::process_data:Remove noise, noise threshold defined via ref mean sd_amplifier:  1.5
INFO [2022-04-07 20:49:17] denoising using mean(normal) +- sd_amplifier * sd(normal) per gene per cell across all data
INFO [2022-04-07 20:49:17] :: **** clear_noise_via_ref_quantiles **** : removing noise between bounds:  1 - 1
INFO [2022-04-07 20:49:30] 

## Making the final infercnv heatmap ##
INFO [2022-04-07 20:49:31] ::plot_cnv:Start
INFO [2022-04-07 20:49:31] ::plot_cnv:Current data dimensions (r,c)=11782,494 Total=5817802.87066788 Min=0.760428310176815 Max=1.29317932624483.
INFO [2022-04-07 20:49:31] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 20:49:36] plot_cnv(): auto thresholding at: (0.907635 , 1.092365)
INFO [2022-04-07 20:49:36] plot_cnv_observation:Start
INFO [2022-04-07 20:49:36] Observation data size: Cells= 492 Genes= 11782
INFO [2022-04-07 20:49:37] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 20:49:42] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 20:49:42] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 20:49:42] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 20:49:42] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 20:49:43] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 20:49:43] Quantiles of plotted data range: 0.90763545286667,0.981171486302806,1,1.01914262642779,1.09236454713333
INFO [2022-04-07 20:49:44] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.3_0/infercnv.observations.txt
INFO [2022-04-07 20:49:49] plot_cnv_references:Start
INFO [2022-04-07 20:49:49] Reference data size: Cells= 2 Genes= 11782
INFO [2022-04-07 20:49:49] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 20:49:49] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 20:49:49] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 20:49:49] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 20:49:49] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.3_0/infercnv.references.txt
INFO [2022-04-07 20:49:50] Parsing gene order file: /home/tenggao/inferCNV/hg38_gene_order.txt
INFO [2022-04-07 20:49:50] Parsing cell annotations file: /home/tenggao/paper_data/infercnv_out/47491_Primary_0.5_0/47491_Primary_annot.tsv
INFO [2022-04-07 20:49:50] ::order_reduce:Start.
INFO [2022-04-07 20:49:50] .order_reduce(): expr and order match.
INFO [2022-04-07 20:49:50] ::process_data:order_reduce:Reduction from positional data, new dimensions (r,c) = 21034,494 Total=181328303 Min=0 Max=6089512.
INFO [2022-04-07 20:49:50] num genes removed taking into account provided gene ordering list: 2169 = 10.3118760102691% removed.
INFO [2022-04-07 20:49:50] -filtering out cells < 100 or > Inf, removing 0 % of cells
INFO [2022-04-07 20:49:50] validating infercnv_obj
INFO [2022-04-07 20:49:50] ::process_data:Start
INFO [2022-04-07 20:49:50] 

	STEP 1: incoming data

INFO [2022-04-07 20:49:51] 

	STEP 02: Removing lowly expressed genes

INFO [2022-04-07 20:49:51] ::above_min_mean_expr_cutoff:Start
INFO [2022-04-07 20:49:51] Removing 5065 genes from matrix as below mean expr threshold: 0.1
INFO [2022-04-07 20:49:51] validating infercnv_obj
INFO [2022-04-07 20:49:51] There are 13800 genes and 494 cells remaining in the expr matrix.
INFO [2022-04-07 20:49:51] Removed 1953 genes having fewer than 3 min cells per gene = 14.1522 % genes removed here
INFO [2022-04-07 20:49:51] validating infercnv_obj
INFO [2022-04-07 20:49:52] 

	STEP 03: normalization by sequencing depth

INFO [2022-04-07 20:49:52] normalizing counts matrix by depth
INFO [2022-04-07 20:49:52] Computed total sum normalization factor as median libsize: 3283.500000
INFO [2022-04-07 20:49:52] Adding h-spike
INFO [2022-04-07 20:49:52] -hspike modeling of Plasma_ref
INFO [2022-04-07 20:51:29] validating infercnv_obj
INFO [2022-04-07 20:51:29] normalizing counts matrix by depth
INFO [2022-04-07 20:51:29] Using specified normalization factor: 3283.500000
INFO [2022-04-07 20:51:30] 

	STEP 04: log transformation of data

INFO [2022-04-07 20:51:30] transforming log2xplus1()
INFO [2022-04-07 20:51:30] -mirroring for hspike
INFO [2022-04-07 20:51:30] transforming log2xplus1()
INFO [2022-04-07 20:51:32] 

	STEP 08: removing average of reference data (before smoothing)

INFO [2022-04-07 20:51:32] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 20:51:32] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 20:51:35] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 20:53:26] -mirroring for hspike
INFO [2022-04-07 20:53:26] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 20:53:26] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 20:53:29] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 20:53:33] 

	STEP 09: apply max centered expression threshold: 3

INFO [2022-04-07 20:53:33] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 20:53:33] -mirroring for hspike
INFO [2022-04-07 20:53:33] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 20:53:36] 

	STEP 10: Smoothing data per cell by chromosome

INFO [2022-04-07 20:53:36] smooth_by_chromosome: chr: chr1
INFO [2022-04-07 20:53:37] smooth_by_chromosome: chr: chr2
INFO [2022-04-07 20:53:37] smooth_by_chromosome: chr: chr3
INFO [2022-04-07 20:53:38] smooth_by_chromosome: chr: chr4
INFO [2022-04-07 20:53:38] smooth_by_chromosome: chr: chr5
INFO [2022-04-07 20:53:39] smooth_by_chromosome: chr: chr6
INFO [2022-04-07 20:53:39] smooth_by_chromosome: chr: chr7
INFO [2022-04-07 20:53:40] smooth_by_chromosome: chr: chr8
INFO [2022-04-07 20:53:40] smooth_by_chromosome: chr: chr9
INFO [2022-04-07 20:53:40] smooth_by_chromosome: chr: chr10
INFO [2022-04-07 20:53:41] smooth_by_chromosome: chr: chr11
INFO [2022-04-07 20:53:41] smooth_by_chromosome: chr: chr12
INFO [2022-04-07 20:53:42] smooth_by_chromosome: chr: chr13
INFO [2022-04-07 20:53:42] smooth_by_chromosome: chr: chr14
INFO [2022-04-07 20:53:43] smooth_by_chromosome: chr: chr15
INFO [2022-04-07 20:53:43] smooth_by_chromosome: chr: chr16
INFO [2022-04-07 20:53:44] smooth_by_chromosome: chr: chr17
INFO [2022-04-07 20:53:44] smooth_by_chromosome: chr: chr18
INFO [2022-04-07 20:53:44] smooth_by_chromosome: chr: chr19
INFO [2022-04-07 20:53:45] smooth_by_chromosome: chr: chr20
INFO [2022-04-07 20:53:45] smooth_by_chromosome: chr: chr21
INFO [2022-04-07 20:53:46] smooth_by_chromosome: chr: chr22
INFO [2022-04-07 20:53:46] -mirroring for hspike
INFO [2022-04-07 20:53:46] smooth_by_chromosome: chr: chrA
INFO [2022-04-07 20:53:46] smooth_by_chromosome: chr: chr_0
INFO [2022-04-07 20:53:46] smooth_by_chromosome: chr: chr_B
INFO [2022-04-07 20:53:47] smooth_by_chromosome: chr: chr_0pt5
INFO [2022-04-07 20:53:47] smooth_by_chromosome: chr: chr_C
INFO [2022-04-07 20:53:47] smooth_by_chromosome: chr: chr_1pt5
INFO [2022-04-07 20:53:47] smooth_by_chromosome: chr: chr_D
INFO [2022-04-07 20:53:47] smooth_by_chromosome: chr: chr_2pt0
INFO [2022-04-07 20:53:48] smooth_by_chromosome: chr: chr_E
INFO [2022-04-07 20:53:48] smooth_by_chromosome: chr: chr_3pt0
INFO [2022-04-07 20:53:48] smooth_by_chromosome: chr: chr_F
INFO [2022-04-07 20:53:53] 

	STEP 11: re-centering data across chromosome after smoothing

INFO [2022-04-07 20:53:53] ::center_smooth across chromosomes per cell
INFO [2022-04-07 20:53:54] -mirroring for hspike
INFO [2022-04-07 20:53:54] ::center_smooth across chromosomes per cell
INFO [2022-04-07 20:53:58] 

	STEP 12: removing average of reference data (after smoothing)

INFO [2022-04-07 20:53:58] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 20:53:58] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 20:54:01] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 20:54:01] -mirroring for hspike
INFO [2022-04-07 20:54:01] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 20:54:01] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 20:54:04] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 20:54:09] 

	STEP 14: invert log2(FC) to FC

INFO [2022-04-07 20:54:09] invert_log2(), computing 2^x
INFO [2022-04-07 20:54:09] -mirroring for hspike
INFO [2022-04-07 20:54:09] invert_log2(), computing 2^x
INFO [2022-04-07 20:54:16] 

	STEP 15: Clustering samples (not defining tumor subclusters)

INFO [2022-04-07 20:54:16] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 20:54:16] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 20:54:23] cut tree into: 1 groups
INFO [2022-04-07 20:54:23] -processing all_observations,all_observations_s1
INFO [2022-04-07 20:54:23] define_signif_tumor_subclusters(), tumor: Plasma_ref
INFO [2022-04-07 20:54:23] -mirroring for hspike
INFO [2022-04-07 20:54:23] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 20:54:23] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 20:54:23] cut tree into: 1 groups
INFO [2022-04-07 20:54:23] -processing all_observations,all_observations_s1
INFO [2022-04-07 20:54:23] define_signif_tumor_subclusters(), tumor: simnorm_cell_Plasma_ref
INFO [2022-04-07 20:54:24] cut tree into: 1 groups
INFO [2022-04-07 20:54:24] -processing simnorm_cell_Plasma_ref,simnorm_cell_Plasma_ref_s1
INFO [2022-04-07 20:54:36] 

	STEP 17: HMM-based CNV prediction

INFO [2022-04-07 20:54:36] predict_CNV_via_HMM_on_whole_tumor_samples
INFO [2022-04-07 20:54:38] -done predicting CNV based on initial tumor subclusters
INFO [2022-04-07 20:54:38] get_predicted_CNV_regions(consensus)
INFO [2022-04-07 20:54:38] -processing cell_group_name: Plasma_ref, size: 2
INFO [2022-04-07 20:54:47] -processing cell_group_name: Plasma, size: 492
INFO [2022-04-07 20:54:59] -writing cell clusters file: /home/tenggao/paper_data/infercnv_out/47491_Primary_0.5_0/17_HMM_predHMMi6.hmm_mode-samples.cell_groupings
INFO [2022-04-07 20:54:59] -writing cnv regions file: /home/tenggao/paper_data/infercnv_out/47491_Primary_0.5_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_regions.dat
INFO [2022-04-07 20:54:59] -writing per-gene cnv report: /home/tenggao/paper_data/infercnv_out/47491_Primary_0.5_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_genes.dat
INFO [2022-04-07 20:54:59] -writing gene ordering info: /home/tenggao/paper_data/infercnv_out/47491_Primary_0.5_0/17_HMM_predHMMi6.hmm_mode-samples.genes_used.dat
INFO [2022-04-07 20:55:03] ::plot_cnv:Start
INFO [2022-04-07 20:55:03] ::plot_cnv:Current data dimensions (r,c)=11847,494 Total=17696490 Min=1 Max=4.
INFO [2022-04-07 20:55:03] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 20:55:08] plot_cnv_observation:Start
INFO [2022-04-07 20:55:08] Observation data size: Cells= 492 Genes= 11847
INFO [2022-04-07 20:55:08] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 20:55:13] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 20:55:13] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 20:55:13] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 20:55:13] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 20:55:14] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 20:55:14] Quantiles of plotted data range: 1,3,3,3,4
INFO [2022-04-07 20:55:14] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.5_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.observations.txt
INFO [2022-04-07 20:55:20] plot_cnv_references:Start
INFO [2022-04-07 20:55:20] Reference data size: Cells= 2 Genes= 11847
INFO [2022-04-07 20:55:20] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 20:55:20] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 20:55:20] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 20:55:20] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 20:55:20] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.5_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.references.txt
INFO [2022-04-07 20:55:20] 

	STEP 18: Run Bayesian Network Model on HMM predicted CNVs

INFO [2022-04-07 20:55:21] Initializing new MCM InferCNV Object.
INFO [2022-04-07 20:55:21] validating infercnv_obj
INFO [2022-04-07 20:55:21] Total CNV's:  55
INFO [2022-04-07 20:55:21] Loading BUGS Model.
INFO [2022-04-07 20:55:21] Running Sampling Using Parallel with  30 Cores
INFO [2022-04-07 21:03:26] Obtaining probabilities post-sampling
INFO [2022-04-07 21:05:27] Gibbs sampling time:  10.0863729675611  Minutes
INFO [2022-04-07 21:05:34] ::plot_cnv:Start
INFO [2022-04-07 21:05:34] ::plot_cnv:Current data dimensions (r,c)=11847,494 Total=1409715.71752114 Min=0 Max=0.972000940548981.
INFO [2022-04-07 21:05:34] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 21:05:34] plot_cnv_observation:Start
INFO [2022-04-07 21:05:34] Observation data size: Cells= 492 Genes= 11847
INFO [2022-04-07 21:05:34] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 21:05:39] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 21:05:39] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 21:05:39] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 21:05:39] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 21:05:40] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:05:40] Quantiles of plotted data range: 0,0,0,0.675204005374344,0.972000940548981
INFO [2022-04-07 21:05:40] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.5_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.observations.txt
INFO [2022-04-07 21:05:45] plot_cnv_references:Start
INFO [2022-04-07 21:05:45] Reference data size: Cells= 2 Genes= 11847
INFO [2022-04-07 21:05:45] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 21:05:45] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 21:05:45] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:05:45] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 21:05:45] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.5_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.references.txt
INFO [2022-04-07 21:05:53] 

	STEP 19: Filter HMM predicted CNVs based on the Bayesian Network Model results and BayesMaxPNormal

INFO [2022-04-07 21:05:53] Attempting to removing CNV(s) with a probability of being normal above  0.5
INFO [2022-04-07 21:05:53] Removing  1  CNV(s) identified by the HMM.
INFO [2022-04-07 21:05:53] Total CNV's after removing:  54
INFO [2022-04-07 21:05:53] Reassigning CNVs based on state probabilities.
INFO [2022-04-07 21:05:53] Changing the following CNV's states assigned by the HMM to the following based on the CNV's state probabilities.
 chr1-region_24 : 2  (P= 0.283985391782369 ) ->  1 (P= 0.507593625828116 )
chr2-region_36 : 4  (P= 0.420624537435784 ) ->  3 (P= 0.436745958002149 )
chr17-region_105 : 4  (P= 0.320002481498395 ) ->  3 (P= 0.456269368415335 )
chr19-region_121 : 4  (P= 0.258925396324027 ) ->  5 (P= 0.34916786083673 )
INFO [2022-04-07 21:05:53] Creating Plots for CNV and cell Probabilities.
INFO [2022-04-07 21:06:31] ::plot_cnv:Start
INFO [2022-04-07 21:06:31] ::plot_cnv:Current data dimensions (r,c)=11847,494 Total=1401906.75304445 Min=0 Max=0.972000940548981.
INFO [2022-04-07 21:06:31] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 21:06:31] plot_cnv_observation:Start
INFO [2022-04-07 21:06:31] Observation data size: Cells= 492 Genes= 11847
INFO [2022-04-07 21:06:31] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 21:06:36] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 21:06:36] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 21:06:36] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 21:06:36] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 21:06:37] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:06:37] Quantiles of plotted data range: 0,0,0,0.675204005374344,0.972000940548981
INFO [2022-04-07 21:06:37] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.5_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.observations.txt
INFO [2022-04-07 21:06:42] plot_cnv_references:Start
INFO [2022-04-07 21:06:42] Reference data size: Cells= 2 Genes= 11847
INFO [2022-04-07 21:06:42] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 21:06:42] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 21:06:42] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:06:42] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 21:06:42] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.5_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.references.txt
INFO [2022-04-07 21:06:46] ::plot_cnv:Start
INFO [2022-04-07 21:06:46] ::plot_cnv:Current data dimensions (r,c)=11847,494 Total=17579394 Min=1 Max=5.
INFO [2022-04-07 21:06:46] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 21:06:51] plot_cnv_observation:Start
INFO [2022-04-07 21:06:51] Observation data size: Cells= 492 Genes= 11847
INFO [2022-04-07 21:06:51] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 21:06:56] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 21:06:56] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 21:06:56] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 21:06:56] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 21:06:57] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:06:57] Quantiles of plotted data range: 1,3,3,3,5
INFO [2022-04-07 21:06:58] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.5_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.observations.txt
INFO [2022-04-07 21:07:03] plot_cnv_references:Start
INFO [2022-04-07 21:07:03] Reference data size: Cells= 2 Genes= 11847
INFO [2022-04-07 21:07:03] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 21:07:03] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 21:07:03] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:07:03] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 21:07:03] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.5_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.references.txt
INFO [2022-04-07 21:07:03] 

	STEP 20: Converting HMM-based CNV states to repr expr vals

INFO [2022-04-07 21:07:07] ::plot_cnv:Start
INFO [2022-04-07 21:07:07] ::plot_cnv:Current data dimensions (r,c)=11847,494 Total=5863488 Min=0 Max=2.
INFO [2022-04-07 21:07:07] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 21:07:12] plot_cnv_observation:Start
INFO [2022-04-07 21:07:12] Observation data size: Cells= 492 Genes= 11847
INFO [2022-04-07 21:07:12] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 21:07:17] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 21:07:17] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 21:07:17] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 21:07:17] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 21:07:18] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:07:18] Quantiles of plotted data range: 0,1,1,1,2
INFO [2022-04-07 21:07:18] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.5_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.observations.txt
INFO [2022-04-07 21:07:23] plot_cnv_references:Start
INFO [2022-04-07 21:07:23] Reference data size: Cells= 2 Genes= 11847
INFO [2022-04-07 21:07:23] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 21:07:23] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 21:07:23] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:07:23] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 21:07:23] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.5_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.references.txt
INFO [2022-04-07 21:07:24] 

	STEP 22: Denoising

INFO [2022-04-07 21:07:24] ::process_data:Remove noise, noise threshold defined via ref mean sd_amplifier:  1.5
INFO [2022-04-07 21:07:24] denoising using mean(normal) +- sd_amplifier * sd(normal) per gene per cell across all data
INFO [2022-04-07 21:07:24] :: **** clear_noise_via_ref_quantiles **** : removing noise between bounds:  1 - 1
INFO [2022-04-07 21:07:37] 

## Making the final infercnv heatmap ##
INFO [2022-04-07 21:07:37] ::plot_cnv:Start
INFO [2022-04-07 21:07:37] ::plot_cnv:Current data dimensions (r,c)=11847,494 Total=5849857.47469796 Min=0.741888772846745 Max=1.32820662275167.
INFO [2022-04-07 21:07:37] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 21:07:43] plot_cnv(): auto thresholding at: (0.900234 , 1.099766)
INFO [2022-04-07 21:07:43] plot_cnv_observation:Start
INFO [2022-04-07 21:07:43] Observation data size: Cells= 492 Genes= 11847
INFO [2022-04-07 21:07:43] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 21:07:49] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 21:07:49] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 21:07:49] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 21:07:49] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 21:07:50] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:07:50] Quantiles of plotted data range: 0.900234493175627,0.978578360042351,1,1.02152554553014,1.09976550682437
INFO [2022-04-07 21:07:50] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.5_0/infercnv.observations.txt
INFO [2022-04-07 21:07:56] plot_cnv_references:Start
INFO [2022-04-07 21:07:56] Reference data size: Cells= 2 Genes= 11847
INFO [2022-04-07 21:07:56] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 21:07:56] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 21:07:56] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:07:56] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 21:07:56] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.5_0/infercnv.references.txt
INFO [2022-04-07 21:07:57] Parsing gene order file: /home/tenggao/inferCNV/hg38_gene_order.txt
INFO [2022-04-07 21:07:57] Parsing cell annotations file: /home/tenggao/paper_data/infercnv_out/47491_Primary_0.7_0/47491_Primary_annot.tsv
INFO [2022-04-07 21:07:57] ::order_reduce:Start.
INFO [2022-04-07 21:07:57] .order_reduce(): expr and order match.
INFO [2022-04-07 21:07:57] ::process_data:order_reduce:Reduction from positional data, new dimensions (r,c) = 21034,494 Total=181916018 Min=0 Max=6089512.
INFO [2022-04-07 21:07:57] num genes removed taking into account provided gene ordering list: 2169 = 10.3118760102691% removed.
INFO [2022-04-07 21:07:57] -filtering out cells < 100 or > Inf, removing 0 % of cells
INFO [2022-04-07 21:07:57] validating infercnv_obj
INFO [2022-04-07 21:07:57] ::process_data:Start
INFO [2022-04-07 21:07:57] 

	STEP 1: incoming data

INFO [2022-04-07 21:07:58] 

	STEP 02: Removing lowly expressed genes

INFO [2022-04-07 21:07:58] ::above_min_mean_expr_cutoff:Start
INFO [2022-04-07 21:07:58] Removing 5051 genes from matrix as below mean expr threshold: 0.1
INFO [2022-04-07 21:07:58] validating infercnv_obj
INFO [2022-04-07 21:07:58] There are 13814 genes and 494 cells remaining in the expr matrix.
INFO [2022-04-07 21:07:58] Removed 1944 genes having fewer than 3 min cells per gene = 14.0727 % genes removed here
INFO [2022-04-07 21:07:58] validating infercnv_obj
INFO [2022-04-07 21:07:59] 

	STEP 03: normalization by sequencing depth

INFO [2022-04-07 21:07:59] normalizing counts matrix by depth
INFO [2022-04-07 21:07:59] Computed total sum normalization factor as median libsize: 5495.000000
INFO [2022-04-07 21:07:59] Adding h-spike
INFO [2022-04-07 21:07:59] -hspike modeling of Plasma_ref
INFO [2022-04-07 21:09:39] validating infercnv_obj
INFO [2022-04-07 21:09:39] normalizing counts matrix by depth
INFO [2022-04-07 21:09:40] Using specified normalization factor: 5495.000000
INFO [2022-04-07 21:09:41] 

	STEP 04: log transformation of data

INFO [2022-04-07 21:09:41] transforming log2xplus1()
INFO [2022-04-07 21:09:41] -mirroring for hspike
INFO [2022-04-07 21:09:41] transforming log2xplus1()
INFO [2022-04-07 21:09:43] 

	STEP 08: removing average of reference data (before smoothing)

INFO [2022-04-07 21:09:43] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 21:09:43] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 21:09:46] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 21:11:46] -mirroring for hspike
INFO [2022-04-07 21:11:46] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 21:11:46] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 21:11:49] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 21:11:53] 

	STEP 09: apply max centered expression threshold: 3

INFO [2022-04-07 21:11:53] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 21:11:53] -mirroring for hspike
INFO [2022-04-07 21:11:53] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 21:11:57] 

	STEP 10: Smoothing data per cell by chromosome

INFO [2022-04-07 21:11:57] smooth_by_chromosome: chr: chr1
INFO [2022-04-07 21:11:58] smooth_by_chromosome: chr: chr2
INFO [2022-04-07 21:11:58] smooth_by_chromosome: chr: chr3
INFO [2022-04-07 21:11:59] smooth_by_chromosome: chr: chr4
INFO [2022-04-07 21:11:59] smooth_by_chromosome: chr: chr5
INFO [2022-04-07 21:11:59] smooth_by_chromosome: chr: chr6
INFO [2022-04-07 21:12:00] smooth_by_chromosome: chr: chr7
INFO [2022-04-07 21:12:00] smooth_by_chromosome: chr: chr8
INFO [2022-04-07 21:12:01] smooth_by_chromosome: chr: chr9
INFO [2022-04-07 21:12:01] smooth_by_chromosome: chr: chr10
INFO [2022-04-07 21:12:02] smooth_by_chromosome: chr: chr11
INFO [2022-04-07 21:12:02] smooth_by_chromosome: chr: chr12
INFO [2022-04-07 21:12:03] smooth_by_chromosome: chr: chr13
INFO [2022-04-07 21:12:03] smooth_by_chromosome: chr: chr14
INFO [2022-04-07 21:12:03] smooth_by_chromosome: chr: chr15
INFO [2022-04-07 21:12:04] smooth_by_chromosome: chr: chr16
INFO [2022-04-07 21:12:04] smooth_by_chromosome: chr: chr17
INFO [2022-04-07 21:12:05] smooth_by_chromosome: chr: chr18
INFO [2022-04-07 21:12:05] smooth_by_chromosome: chr: chr19
INFO [2022-04-07 21:12:06] smooth_by_chromosome: chr: chr20
INFO [2022-04-07 21:12:06] smooth_by_chromosome: chr: chr21
INFO [2022-04-07 21:12:07] smooth_by_chromosome: chr: chr22
INFO [2022-04-07 21:12:07] -mirroring for hspike
INFO [2022-04-07 21:12:07] smooth_by_chromosome: chr: chrA
INFO [2022-04-07 21:12:07] smooth_by_chromosome: chr: chr_0
INFO [2022-04-07 21:12:07] smooth_by_chromosome: chr: chr_B
INFO [2022-04-07 21:12:07] smooth_by_chromosome: chr: chr_0pt5
INFO [2022-04-07 21:12:08] smooth_by_chromosome: chr: chr_C
INFO [2022-04-07 21:12:08] smooth_by_chromosome: chr: chr_1pt5
INFO [2022-04-07 21:12:08] smooth_by_chromosome: chr: chr_D
INFO [2022-04-07 21:12:08] smooth_by_chromosome: chr: chr_2pt0
INFO [2022-04-07 21:12:08] smooth_by_chromosome: chr: chr_E
INFO [2022-04-07 21:12:08] smooth_by_chromosome: chr: chr_3pt0
INFO [2022-04-07 21:12:09] smooth_by_chromosome: chr: chr_F
INFO [2022-04-07 21:12:14] 

	STEP 11: re-centering data across chromosome after smoothing

INFO [2022-04-07 21:12:14] ::center_smooth across chromosomes per cell
INFO [2022-04-07 21:12:14] -mirroring for hspike
INFO [2022-04-07 21:12:14] ::center_smooth across chromosomes per cell
INFO [2022-04-07 21:12:19] 

	STEP 12: removing average of reference data (after smoothing)

INFO [2022-04-07 21:12:19] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 21:12:19] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 21:12:22] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 21:12:23] -mirroring for hspike
INFO [2022-04-07 21:12:23] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 21:12:23] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 21:12:26] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 21:12:31] 

	STEP 14: invert log2(FC) to FC

INFO [2022-04-07 21:12:31] invert_log2(), computing 2^x
INFO [2022-04-07 21:12:31] -mirroring for hspike
INFO [2022-04-07 21:12:31] invert_log2(), computing 2^x
INFO [2022-04-07 21:12:37] 

	STEP 15: Clustering samples (not defining tumor subclusters)

INFO [2022-04-07 21:12:37] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 21:12:37] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 21:12:45] cut tree into: 1 groups
INFO [2022-04-07 21:12:45] -processing all_observations,all_observations_s1
INFO [2022-04-07 21:12:45] define_signif_tumor_subclusters(), tumor: Plasma_ref
INFO [2022-04-07 21:12:45] -mirroring for hspike
INFO [2022-04-07 21:12:45] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 21:12:45] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 21:12:45] cut tree into: 1 groups
INFO [2022-04-07 21:12:45] -processing all_observations,all_observations_s1
INFO [2022-04-07 21:12:45] define_signif_tumor_subclusters(), tumor: simnorm_cell_Plasma_ref
INFO [2022-04-07 21:12:45] cut tree into: 1 groups
INFO [2022-04-07 21:12:45] -processing simnorm_cell_Plasma_ref,simnorm_cell_Plasma_ref_s1
INFO [2022-04-07 21:12:57] 

	STEP 17: HMM-based CNV prediction

INFO [2022-04-07 21:12:57] predict_CNV_via_HMM_on_whole_tumor_samples
INFO [2022-04-07 21:12:59] -done predicting CNV based on initial tumor subclusters
INFO [2022-04-07 21:12:59] get_predicted_CNV_regions(consensus)
INFO [2022-04-07 21:12:59] -processing cell_group_name: Plasma_ref, size: 2
INFO [2022-04-07 21:13:07] -processing cell_group_name: Plasma, size: 492
INFO [2022-04-07 21:13:20] -writing cell clusters file: /home/tenggao/paper_data/infercnv_out/47491_Primary_0.7_0/17_HMM_predHMMi6.hmm_mode-samples.cell_groupings
INFO [2022-04-07 21:13:20] -writing cnv regions file: /home/tenggao/paper_data/infercnv_out/47491_Primary_0.7_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_regions.dat
INFO [2022-04-07 21:13:20] -writing per-gene cnv report: /home/tenggao/paper_data/infercnv_out/47491_Primary_0.7_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_genes.dat
INFO [2022-04-07 21:13:20] -writing gene ordering info: /home/tenggao/paper_data/infercnv_out/47491_Primary_0.7_0/17_HMM_predHMMi6.hmm_mode-samples.genes_used.dat
INFO [2022-04-07 21:13:23] ::plot_cnv:Start
INFO [2022-04-07 21:13:23] ::plot_cnv:Current data dimensions (r,c)=11870,494 Total=17857020 Min=1 Max=4.
INFO [2022-04-07 21:13:23] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 21:13:29] plot_cnv_observation:Start
INFO [2022-04-07 21:13:29] Observation data size: Cells= 492 Genes= 11870
INFO [2022-04-07 21:13:29] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 21:13:34] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 21:13:34] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 21:13:34] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 21:13:34] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 21:13:34] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:13:34] Quantiles of plotted data range: 1,3,3,3,4
INFO [2022-04-07 21:13:35] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.7_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.observations.txt
INFO [2022-04-07 21:13:40] plot_cnv_references:Start
INFO [2022-04-07 21:13:40] Reference data size: Cells= 2 Genes= 11870
INFO [2022-04-07 21:13:40] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 21:13:40] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 21:13:40] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:13:40] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 21:13:40] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.7_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.references.txt
INFO [2022-04-07 21:13:41] 

	STEP 18: Run Bayesian Network Model on HMM predicted CNVs

INFO [2022-04-07 21:13:42] Initializing new MCM InferCNV Object.
INFO [2022-04-07 21:13:42] validating infercnv_obj
INFO [2022-04-07 21:13:42] Total CNV's:  51
INFO [2022-04-07 21:13:42] Loading BUGS Model.
INFO [2022-04-07 21:13:42] Running Sampling Using Parallel with  30 Cores
INFO [2022-04-07 21:21:49] Obtaining probabilities post-sampling
INFO [2022-04-07 21:23:40] Gibbs sampling time:  9.96457781791687  Minutes
INFO [2022-04-07 21:23:47] ::plot_cnv:Start
INFO [2022-04-07 21:23:47] ::plot_cnv:Current data dimensions (r,c)=11870,494 Total=1371919.05755283 Min=0 Max=0.980917329475719.
INFO [2022-04-07 21:23:47] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 21:23:47] plot_cnv_observation:Start
INFO [2022-04-07 21:23:47] Observation data size: Cells= 492 Genes= 11870
INFO [2022-04-07 21:23:47] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 21:23:52] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 21:23:52] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 21:23:52] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 21:23:52] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 21:23:52] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:23:52] Quantiles of plotted data range: 0,0,0,0.658006718139459,0.980917329475719
INFO [2022-04-07 21:23:53] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.7_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.observations.txt
INFO [2022-04-07 21:23:58] plot_cnv_references:Start
INFO [2022-04-07 21:23:58] Reference data size: Cells= 2 Genes= 11870
INFO [2022-04-07 21:23:58] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 21:23:58] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 21:23:58] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:23:58] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 21:23:58] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.7_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.references.txt
INFO [2022-04-07 21:24:04] 

	STEP 19: Filter HMM predicted CNVs based on the Bayesian Network Model results and BayesMaxPNormal

INFO [2022-04-07 21:24:04] Attempting to removing CNV(s) with a probability of being normal above  0.5
INFO [2022-04-07 21:24:05] Removing  0  CNV(s) identified by the HMM.
INFO [2022-04-07 21:24:05] Reassigning CNVs based on state probabilities.
INFO [2022-04-07 21:24:05] Changing the following CNV's states assigned by the HMM to the following based on the CNV's state probabilities.
 chr1-region_24 : 2  (P= 0.332717511373497 ) ->  1 (P= 0.437548233854555 )
INFO [2022-04-07 21:24:05] Creating Plots for CNV and cell Probabilities.
INFO [2022-04-07 21:24:41] ::plot_cnv:Start
INFO [2022-04-07 21:24:41] ::plot_cnv:Current data dimensions (r,c)=11870,494 Total=1371919.05755283 Min=0 Max=0.980917329475719.
INFO [2022-04-07 21:24:41] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 21:24:41] plot_cnv_observation:Start
INFO [2022-04-07 21:24:41] Observation data size: Cells= 492 Genes= 11870
INFO [2022-04-07 21:24:42] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 21:24:46] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 21:24:46] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 21:24:46] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 21:24:46] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 21:24:47] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:24:47] Quantiles of plotted data range: 0,0,0,0.658006718139459,0.980917329475719
INFO [2022-04-07 21:24:48] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.7_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.observations.txt
INFO [2022-04-07 21:24:52] plot_cnv_references:Start
INFO [2022-04-07 21:24:52] Reference data size: Cells= 2 Genes= 11870
INFO [2022-04-07 21:24:52] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 21:24:52] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 21:24:52] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:24:52] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 21:24:52] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.7_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.references.txt
INFO [2022-04-07 21:24:56] ::plot_cnv:Start
INFO [2022-04-07 21:24:56] ::plot_cnv:Current data dimensions (r,c)=11870,494 Total=17790600 Min=1 Max=4.
INFO [2022-04-07 21:24:56] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 21:25:01] plot_cnv_observation:Start
INFO [2022-04-07 21:25:01] Observation data size: Cells= 492 Genes= 11870
INFO [2022-04-07 21:25:01] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 21:25:06] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 21:25:06] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 21:25:06] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 21:25:06] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 21:25:07] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:25:07] Quantiles of plotted data range: 1,3,3,3,4
INFO [2022-04-07 21:25:08] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.7_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.observations.txt
INFO [2022-04-07 21:25:13] plot_cnv_references:Start
INFO [2022-04-07 21:25:13] Reference data size: Cells= 2 Genes= 11870
INFO [2022-04-07 21:25:13] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 21:25:13] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 21:25:13] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:25:13] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 21:25:13] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.7_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.references.txt
INFO [2022-04-07 21:25:13] 

	STEP 20: Converting HMM-based CNV states to repr expr vals

INFO [2022-04-07 21:25:17] ::plot_cnv:Start
INFO [2022-04-07 21:25:17] ::plot_cnv:Current data dimensions (r,c)=11870,494 Total=5963410 Min=0 Max=1.5.
INFO [2022-04-07 21:25:17] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 21:25:22] plot_cnv_observation:Start
INFO [2022-04-07 21:25:22] Observation data size: Cells= 492 Genes= 11870
INFO [2022-04-07 21:25:22] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 21:25:27] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 21:25:27] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 21:25:27] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 21:25:27] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 21:25:28] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:25:28] Quantiles of plotted data range: 0,1,1,1,1.5
INFO [2022-04-07 21:25:28] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.7_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.observations.txt
INFO [2022-04-07 21:25:33] plot_cnv_references:Start
INFO [2022-04-07 21:25:33] Reference data size: Cells= 2 Genes= 11870
INFO [2022-04-07 21:25:33] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 21:25:33] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 21:25:33] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:25:33] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 21:25:33] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.7_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.references.txt
INFO [2022-04-07 21:25:34] 

	STEP 22: Denoising

INFO [2022-04-07 21:25:34] ::process_data:Remove noise, noise threshold defined via ref mean sd_amplifier:  1.5
INFO [2022-04-07 21:25:34] denoising using mean(normal) +- sd_amplifier * sd(normal) per gene per cell across all data
INFO [2022-04-07 21:25:34] :: **** clear_noise_via_ref_quantiles **** : removing noise between bounds:  1 - 1
INFO [2022-04-07 21:25:46] 

## Making the final infercnv heatmap ##
INFO [2022-04-07 21:25:46] ::plot_cnv:Start
INFO [2022-04-07 21:25:46] ::plot_cnv:Current data dimensions (r,c)=11870,494 Total=5861952.91560101 Min=0.685404408504755 Max=1.44375341275493.
INFO [2022-04-07 21:25:46] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 21:25:52] plot_cnv(): auto thresholding at: (0.870314 , 1.129686)
INFO [2022-04-07 21:25:52] plot_cnv_observation:Start
INFO [2022-04-07 21:25:52] Observation data size: Cells= 492 Genes= 11870
INFO [2022-04-07 21:25:52] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 21:25:58] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 21:25:58] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 21:25:58] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 21:25:58] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 21:25:59] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:25:59] Quantiles of plotted data range: 0.870313830947817,0.971146241945678,1,1.02896644581035,1.12968616905218
INFO [2022-04-07 21:26:00] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.7_0/infercnv.observations.txt
INFO [2022-04-07 21:26:06] plot_cnv_references:Start
INFO [2022-04-07 21:26:06] Reference data size: Cells= 2 Genes= 11870
INFO [2022-04-07 21:26:06] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 21:26:06] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 21:26:06] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:26:06] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 21:26:06] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.7_0/infercnv.references.txt
INFO [2022-04-07 21:26:06] Parsing gene order file: /home/tenggao/inferCNV/hg38_gene_order.txt
INFO [2022-04-07 21:26:06] Parsing cell annotations file: /home/tenggao/paper_data/infercnv_out/47491_Primary_0.9_0/47491_Primary_annot.tsv
INFO [2022-04-07 21:26:06] ::order_reduce:Start.
INFO [2022-04-07 21:26:06] .order_reduce(): expr and order match.
INFO [2022-04-07 21:26:06] ::process_data:order_reduce:Reduction from positional data, new dimensions (r,c) = 21034,494 Total=182479280 Min=0 Max=6089512.
INFO [2022-04-07 21:26:06] num genes removed taking into account provided gene ordering list: 2169 = 10.3118760102691% removed.
INFO [2022-04-07 21:26:06] -filtering out cells < 100 or > Inf, removing 0 % of cells
INFO [2022-04-07 21:26:06] validating infercnv_obj
INFO [2022-04-07 21:26:06] ::process_data:Start
INFO [2022-04-07 21:26:06] 

	STEP 1: incoming data

INFO [2022-04-07 21:26:07] 

	STEP 02: Removing lowly expressed genes

INFO [2022-04-07 21:26:07] ::above_min_mean_expr_cutoff:Start
INFO [2022-04-07 21:26:07] Removing 5045 genes from matrix as below mean expr threshold: 0.1
INFO [2022-04-07 21:26:07] validating infercnv_obj
INFO [2022-04-07 21:26:07] There are 13820 genes and 494 cells remaining in the expr matrix.
INFO [2022-04-07 21:26:08] Removed 2007 genes having fewer than 3 min cells per gene = 14.5224 % genes removed here
INFO [2022-04-07 21:26:08] validating infercnv_obj
INFO [2022-04-07 21:26:09] 

	STEP 03: normalization by sequencing depth

INFO [2022-04-07 21:26:09] normalizing counts matrix by depth
INFO [2022-04-07 21:26:09] Computed total sum normalization factor as median libsize: 7590.000000
INFO [2022-04-07 21:26:09] Adding h-spike
INFO [2022-04-07 21:26:09] -hspike modeling of Plasma_ref
INFO [2022-04-07 21:27:47] validating infercnv_obj
INFO [2022-04-07 21:27:47] normalizing counts matrix by depth
INFO [2022-04-07 21:27:48] Using specified normalization factor: 7590.000000
INFO [2022-04-07 21:27:49] 

	STEP 04: log transformation of data

INFO [2022-04-07 21:27:49] transforming log2xplus1()
INFO [2022-04-07 21:27:49] -mirroring for hspike
INFO [2022-04-07 21:27:49] transforming log2xplus1()
INFO [2022-04-07 21:27:52] 

	STEP 08: removing average of reference data (before smoothing)

INFO [2022-04-07 21:27:52] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 21:27:52] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 21:27:55] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 21:29:48] -mirroring for hspike
INFO [2022-04-07 21:29:48] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 21:29:48] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 21:29:50] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 21:29:55] 

	STEP 09: apply max centered expression threshold: 3

INFO [2022-04-07 21:29:55] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 21:29:55] -mirroring for hspike
INFO [2022-04-07 21:29:55] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 21:29:59] 

	STEP 10: Smoothing data per cell by chromosome

INFO [2022-04-07 21:29:59] smooth_by_chromosome: chr: chr1
INFO [2022-04-07 21:29:59] smooth_by_chromosome: chr: chr2
INFO [2022-04-07 21:30:00] smooth_by_chromosome: chr: chr3
INFO [2022-04-07 21:30:00] smooth_by_chromosome: chr: chr4
INFO [2022-04-07 21:30:01] smooth_by_chromosome: chr: chr5
INFO [2022-04-07 21:30:01] smooth_by_chromosome: chr: chr6
INFO [2022-04-07 21:30:02] smooth_by_chromosome: chr: chr7
INFO [2022-04-07 21:30:02] smooth_by_chromosome: chr: chr8
INFO [2022-04-07 21:30:03] smooth_by_chromosome: chr: chr9
INFO [2022-04-07 21:30:03] smooth_by_chromosome: chr: chr10
INFO [2022-04-07 21:30:04] smooth_by_chromosome: chr: chr11
INFO [2022-04-07 21:30:04] smooth_by_chromosome: chr: chr12
INFO [2022-04-07 21:30:05] smooth_by_chromosome: chr: chr13
INFO [2022-04-07 21:30:05] smooth_by_chromosome: chr: chr14
INFO [2022-04-07 21:30:05] smooth_by_chromosome: chr: chr15
INFO [2022-04-07 21:30:06] smooth_by_chromosome: chr: chr16
INFO [2022-04-07 21:30:06] smooth_by_chromosome: chr: chr17
INFO [2022-04-07 21:30:07] smooth_by_chromosome: chr: chr18
INFO [2022-04-07 21:30:07] smooth_by_chromosome: chr: chr19
INFO [2022-04-07 21:30:08] smooth_by_chromosome: chr: chr20
INFO [2022-04-07 21:30:08] smooth_by_chromosome: chr: chr21
INFO [2022-04-07 21:30:09] smooth_by_chromosome: chr: chr22
INFO [2022-04-07 21:30:09] -mirroring for hspike
INFO [2022-04-07 21:30:09] smooth_by_chromosome: chr: chrA
INFO [2022-04-07 21:30:09] smooth_by_chromosome: chr: chr_0
INFO [2022-04-07 21:30:09] smooth_by_chromosome: chr: chr_B
INFO [2022-04-07 21:30:09] smooth_by_chromosome: chr: chr_0pt5
INFO [2022-04-07 21:30:10] smooth_by_chromosome: chr: chr_C
INFO [2022-04-07 21:30:10] smooth_by_chromosome: chr: chr_1pt5
INFO [2022-04-07 21:30:10] smooth_by_chromosome: chr: chr_D
INFO [2022-04-07 21:30:10] smooth_by_chromosome: chr: chr_2pt0
INFO [2022-04-07 21:30:10] smooth_by_chromosome: chr: chr_E
INFO [2022-04-07 21:30:10] smooth_by_chromosome: chr: chr_3pt0
INFO [2022-04-07 21:30:11] smooth_by_chromosome: chr: chr_F
INFO [2022-04-07 21:30:16] 

	STEP 11: re-centering data across chromosome after smoothing

INFO [2022-04-07 21:30:16] ::center_smooth across chromosomes per cell
INFO [2022-04-07 21:30:16] -mirroring for hspike
INFO [2022-04-07 21:30:16] ::center_smooth across chromosomes per cell
INFO [2022-04-07 21:30:21] 

	STEP 12: removing average of reference data (after smoothing)

INFO [2022-04-07 21:30:21] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 21:30:21] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 21:30:24] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 21:30:25] -mirroring for hspike
INFO [2022-04-07 21:30:25] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 21:30:25] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 21:30:27] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 21:30:32] 

	STEP 14: invert log2(FC) to FC

INFO [2022-04-07 21:30:32] invert_log2(), computing 2^x
INFO [2022-04-07 21:30:33] -mirroring for hspike
INFO [2022-04-07 21:30:33] invert_log2(), computing 2^x
INFO [2022-04-07 21:30:39] 

	STEP 15: Clustering samples (not defining tumor subclusters)

INFO [2022-04-07 21:30:39] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 21:30:39] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 21:30:46] cut tree into: 1 groups
INFO [2022-04-07 21:30:46] -processing all_observations,all_observations_s1
INFO [2022-04-07 21:30:46] define_signif_tumor_subclusters(), tumor: Plasma_ref
INFO [2022-04-07 21:30:46] -mirroring for hspike
INFO [2022-04-07 21:30:46] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 21:30:46] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 21:30:46] cut tree into: 1 groups
INFO [2022-04-07 21:30:46] -processing all_observations,all_observations_s1
INFO [2022-04-07 21:30:46] define_signif_tumor_subclusters(), tumor: simnorm_cell_Plasma_ref
INFO [2022-04-07 21:30:46] cut tree into: 1 groups
INFO [2022-04-07 21:30:46] -processing simnorm_cell_Plasma_ref,simnorm_cell_Plasma_ref_s1
INFO [2022-04-07 21:30:58] 

	STEP 17: HMM-based CNV prediction

INFO [2022-04-07 21:30:58] predict_CNV_via_HMM_on_whole_tumor_samples
INFO [2022-04-07 21:31:00] -done predicting CNV based on initial tumor subclusters
INFO [2022-04-07 21:31:00] get_predicted_CNV_regions(consensus)
INFO [2022-04-07 21:31:00] -processing cell_group_name: Plasma_ref, size: 2
INFO [2022-04-07 21:31:08] -processing cell_group_name: Plasma, size: 492
INFO [2022-04-07 21:31:21] -writing cell clusters file: /home/tenggao/paper_data/infercnv_out/47491_Primary_0.9_0/17_HMM_predHMMi6.hmm_mode-samples.cell_groupings
INFO [2022-04-07 21:31:21] -writing cnv regions file: /home/tenggao/paper_data/infercnv_out/47491_Primary_0.9_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_regions.dat
INFO [2022-04-07 21:31:21] -writing per-gene cnv report: /home/tenggao/paper_data/infercnv_out/47491_Primary_0.9_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_genes.dat
INFO [2022-04-07 21:31:21] -writing gene ordering info: /home/tenggao/paper_data/infercnv_out/47491_Primary_0.9_0/17_HMM_predHMMi6.hmm_mode-samples.genes_used.dat
INFO [2022-04-07 21:31:24] ::plot_cnv:Start
INFO [2022-04-07 21:31:24] ::plot_cnv:Current data dimensions (r,c)=11813,494 Total=17962950 Min=1 Max=5.
INFO [2022-04-07 21:31:24] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 21:31:30] plot_cnv_observation:Start
INFO [2022-04-07 21:31:30] Observation data size: Cells= 492 Genes= 11813
INFO [2022-04-07 21:31:30] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 21:31:35] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 21:31:35] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 21:31:35] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 21:31:35] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 21:31:35] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:31:35] Quantiles of plotted data range: 1,3,3,3,5
INFO [2022-04-07 21:31:36] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.9_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.observations.txt
INFO [2022-04-07 21:31:41] plot_cnv_references:Start
INFO [2022-04-07 21:31:41] Reference data size: Cells= 2 Genes= 11813
INFO [2022-04-07 21:31:41] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 21:31:41] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 21:31:41] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:31:41] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 21:31:41] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.9_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.references.txt
INFO [2022-04-07 21:31:42] 

	STEP 18: Run Bayesian Network Model on HMM predicted CNVs

INFO [2022-04-07 21:31:43] Initializing new MCM InferCNV Object.
INFO [2022-04-07 21:31:43] validating infercnv_obj
INFO [2022-04-07 21:31:43] Total CNV's:  54
INFO [2022-04-07 21:31:43] Loading BUGS Model.
INFO [2022-04-07 21:31:43] Running Sampling Using Parallel with  30 Cores
INFO [2022-04-07 21:39:24] Obtaining probabilities post-sampling
INFO [2022-04-07 21:41:22] Gibbs sampling time:  9.65017571051916  Minutes
INFO [2022-04-07 21:41:29] ::plot_cnv:Start
INFO [2022-04-07 21:41:29] ::plot_cnv:Current data dimensions (r,c)=11813,494 Total=1548321.68334546 Min=0 Max=0.995993588902845.
INFO [2022-04-07 21:41:29] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 21:41:29] plot_cnv_observation:Start
INFO [2022-04-07 21:41:29] Observation data size: Cells= 492 Genes= 11813
INFO [2022-04-07 21:41:29] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 21:41:34] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 21:41:34] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 21:41:34] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 21:41:34] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 21:41:35] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:41:35] Quantiles of plotted data range: 0,0,0,0.721505175651848,0.995993588902845
INFO [2022-04-07 21:41:35] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.9_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.observations.txt
INFO [2022-04-07 21:41:40] plot_cnv_references:Start
INFO [2022-04-07 21:41:40] Reference data size: Cells= 2 Genes= 11813
INFO [2022-04-07 21:41:40] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 21:41:40] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 21:41:40] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:41:40] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 21:41:40] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.9_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.references.txt
INFO [2022-04-07 21:41:47] 

	STEP 19: Filter HMM predicted CNVs based on the Bayesian Network Model results and BayesMaxPNormal

INFO [2022-04-07 21:41:47] Attempting to removing CNV(s) with a probability of being normal above  0.5
INFO [2022-04-07 21:41:47] Removing  0  CNV(s) identified by the HMM.
INFO [2022-04-07 21:41:47] Reassigning CNVs based on state probabilities.
INFO [2022-04-07 21:41:47] Creating Plots for CNV and cell Probabilities.
INFO [2022-04-07 21:42:25] ::plot_cnv:Start
INFO [2022-04-07 21:42:25] ::plot_cnv:Current data dimensions (r,c)=11813,494 Total=1548321.68334546 Min=0 Max=0.995993588902845.
INFO [2022-04-07 21:42:25] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 21:42:25] plot_cnv_observation:Start
INFO [2022-04-07 21:42:25] Observation data size: Cells= 492 Genes= 11813
INFO [2022-04-07 21:42:25] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 21:42:29] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 21:42:29] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 21:42:29] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 21:42:29] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 21:42:30] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:42:30] Quantiles of plotted data range: 0,0,0,0.721505175651848,0.995993588902845
INFO [2022-04-07 21:42:31] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.9_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.observations.txt
INFO [2022-04-07 21:42:35] plot_cnv_references:Start
INFO [2022-04-07 21:42:35] Reference data size: Cells= 2 Genes= 11813
INFO [2022-04-07 21:42:35] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 21:42:35] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 21:42:35] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:42:35] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 21:42:35] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.9_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.references.txt
INFO [2022-04-07 21:42:39] ::plot_cnv:Start
INFO [2022-04-07 21:42:39] ::plot_cnv:Current data dimensions (r,c)=11813,494 Total=17962950 Min=1 Max=5.
INFO [2022-04-07 21:42:39] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 21:42:44] plot_cnv_observation:Start
INFO [2022-04-07 21:42:44] Observation data size: Cells= 492 Genes= 11813
INFO [2022-04-07 21:42:44] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 21:42:49] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 21:42:49] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 21:42:49] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 21:42:49] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 21:42:50] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:42:50] Quantiles of plotted data range: 1,3,3,3,5
INFO [2022-04-07 21:42:51] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.9_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.observations.txt
INFO [2022-04-07 21:42:56] plot_cnv_references:Start
INFO [2022-04-07 21:42:56] Reference data size: Cells= 2 Genes= 11813
INFO [2022-04-07 21:42:56] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 21:42:56] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 21:42:56] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:42:56] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 21:42:56] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.9_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.references.txt
INFO [2022-04-07 21:42:56] 

	STEP 20: Converting HMM-based CNV states to repr expr vals

INFO [2022-04-07 21:42:59] ::plot_cnv:Start
INFO [2022-04-07 21:42:59] ::plot_cnv:Current data dimensions (r,c)=11813,494 Total=6063664 Min=0 Max=2.
INFO [2022-04-07 21:42:59] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 21:43:05] plot_cnv_observation:Start
INFO [2022-04-07 21:43:05] Observation data size: Cells= 492 Genes= 11813
INFO [2022-04-07 21:43:05] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 21:43:10] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 21:43:10] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 21:43:10] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 21:43:10] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 21:43:10] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:43:10] Quantiles of plotted data range: 0,1,1,1,2
INFO [2022-04-07 21:43:11] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.9_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.observations.txt
INFO [2022-04-07 21:43:16] plot_cnv_references:Start
INFO [2022-04-07 21:43:16] Reference data size: Cells= 2 Genes= 11813
INFO [2022-04-07 21:43:16] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 21:43:16] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 21:43:16] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:43:16] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 21:43:16] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.9_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.references.txt
INFO [2022-04-07 21:43:16] 

	STEP 22: Denoising

INFO [2022-04-07 21:43:16] ::process_data:Remove noise, noise threshold defined via ref mean sd_amplifier:  1.5
INFO [2022-04-07 21:43:16] denoising using mean(normal) +- sd_amplifier * sd(normal) per gene per cell across all data
INFO [2022-04-07 21:43:16] :: **** clear_noise_via_ref_quantiles **** : removing noise between bounds:  1 - 1
INFO [2022-04-07 21:43:28] 

## Making the final infercnv heatmap ##
INFO [2022-04-07 21:43:28] ::plot_cnv:Start
INFO [2022-04-07 21:43:28] ::plot_cnv:Current data dimensions (r,c)=11813,494 Total=5834488.59874465 Min=0.650578646340817 Max=1.52688398209873.
INFO [2022-04-07 21:43:28] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 21:43:34] plot_cnv(): auto thresholding at: (0.846032 , 1.153968)
INFO [2022-04-07 21:43:34] plot_cnv_observation:Start
INFO [2022-04-07 21:43:34] Observation data size: Cells= 492 Genes= 11813
INFO [2022-04-07 21:43:34] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 21:43:40] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 21:43:40] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 21:43:40] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 21:43:40] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 21:43:41] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:43:41] Quantiles of plotted data range: 0.846031503919235,0.965167745909797,1,1.03517242480146,1.15396849608077
INFO [2022-04-07 21:43:41] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.9_0/infercnv.observations.txt
INFO [2022-04-07 21:43:47] plot_cnv_references:Start
INFO [2022-04-07 21:43:47] Reference data size: Cells= 2 Genes= 11813
INFO [2022-04-07 21:43:47] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 21:43:47] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 21:43:47] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:43:47] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 21:43:47] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/47491_Primary_0.9_0/infercnv.references.txt
INFO [2022-04-07 21:43:48] Parsing gene order file: /home/tenggao/inferCNV/hg38_gene_order.txt
INFO [2022-04-07 21:43:48] Parsing cell annotations file: /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.1_0/27522_Relapse_2_annot.tsv
INFO [2022-04-07 21:43:48] ::order_reduce:Start.
INFO [2022-04-07 21:43:48] .order_reduce(): expr and order match.
INFO [2022-04-07 21:43:48] ::process_data:order_reduce:Reduction from positional data, new dimensions (r,c) = 21034,225 Total=179609727 Min=0 Max=6089512.
INFO [2022-04-07 21:43:48] num genes removed taking into account provided gene ordering list: 2169 = 10.3118760102691% removed.
INFO [2022-04-07 21:43:48] -filtering out cells < 100 or > Inf, removing 0 % of cells
INFO [2022-04-07 21:43:48] validating infercnv_obj
INFO [2022-04-07 21:43:48] ::process_data:Start
INFO [2022-04-07 21:43:48] 

	STEP 1: incoming data

INFO [2022-04-07 21:43:48] 

	STEP 02: Removing lowly expressed genes

INFO [2022-04-07 21:43:48] ::above_min_mean_expr_cutoff:Start
INFO [2022-04-07 21:43:48] Removing 4383 genes from matrix as below mean expr threshold: 0.1
INFO [2022-04-07 21:43:48] validating infercnv_obj
INFO [2022-04-07 21:43:48] There are 14482 genes and 225 cells remaining in the expr matrix.
INFO [2022-04-07 21:43:49] Removed 2922 genes having fewer than 3 min cells per gene = 20.1768 % genes removed here
INFO [2022-04-07 21:43:49] validating infercnv_obj
INFO [2022-04-07 21:43:49] 

	STEP 03: normalization by sequencing depth

INFO [2022-04-07 21:43:49] normalizing counts matrix by depth
INFO [2022-04-07 21:43:49] Computed total sum normalization factor as median libsize: 4878.000000
INFO [2022-04-07 21:43:49] Adding h-spike
INFO [2022-04-07 21:43:49] -hspike modeling of Plasma_ref
INFO [2022-04-07 21:45:24] validating infercnv_obj
INFO [2022-04-07 21:45:24] normalizing counts matrix by depth
INFO [2022-04-07 21:45:24] Using specified normalization factor: 4878.000000
INFO [2022-04-07 21:45:25] 

	STEP 04: log transformation of data

INFO [2022-04-07 21:45:25] transforming log2xplus1()
INFO [2022-04-07 21:45:25] -mirroring for hspike
INFO [2022-04-07 21:45:25] transforming log2xplus1()
INFO [2022-04-07 21:45:27] 

	STEP 08: removing average of reference data (before smoothing)

INFO [2022-04-07 21:45:27] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 21:45:27] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 21:45:30] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 21:46:17] -mirroring for hspike
INFO [2022-04-07 21:46:17] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 21:46:17] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 21:46:20] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 21:46:23] 

	STEP 09: apply max centered expression threshold: 3

INFO [2022-04-07 21:46:23] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 21:46:23] -mirroring for hspike
INFO [2022-04-07 21:46:23] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 21:46:26] 

	STEP 10: Smoothing data per cell by chromosome

INFO [2022-04-07 21:46:26] smooth_by_chromosome: chr: chr1
INFO [2022-04-07 21:46:26] smooth_by_chromosome: chr: chr2
INFO [2022-04-07 21:46:26] smooth_by_chromosome: chr: chr3
INFO [2022-04-07 21:46:26] smooth_by_chromosome: chr: chr4
INFO [2022-04-07 21:46:26] smooth_by_chromosome: chr: chr5
INFO [2022-04-07 21:46:27] smooth_by_chromosome: chr: chr6
INFO [2022-04-07 21:46:27] smooth_by_chromosome: chr: chr7
INFO [2022-04-07 21:46:27] smooth_by_chromosome: chr: chr8
INFO [2022-04-07 21:46:27] smooth_by_chromosome: chr: chr9
INFO [2022-04-07 21:46:28] smooth_by_chromosome: chr: chr10
INFO [2022-04-07 21:46:28] smooth_by_chromosome: chr: chr11
INFO [2022-04-07 21:46:28] smooth_by_chromosome: chr: chr12
INFO [2022-04-07 21:46:28] smooth_by_chromosome: chr: chr13
INFO [2022-04-07 21:46:28] smooth_by_chromosome: chr: chr14
INFO [2022-04-07 21:46:29] smooth_by_chromosome: chr: chr15
INFO [2022-04-07 21:46:29] smooth_by_chromosome: chr: chr16
INFO [2022-04-07 21:46:29] smooth_by_chromosome: chr: chr17
INFO [2022-04-07 21:46:29] smooth_by_chromosome: chr: chr18
INFO [2022-04-07 21:46:29] smooth_by_chromosome: chr: chr19
INFO [2022-04-07 21:46:30] smooth_by_chromosome: chr: chr20
INFO [2022-04-07 21:46:30] smooth_by_chromosome: chr: chr21
INFO [2022-04-07 21:46:30] smooth_by_chromosome: chr: chr22
INFO [2022-04-07 21:46:30] -mirroring for hspike
INFO [2022-04-07 21:46:30] smooth_by_chromosome: chr: chrA
INFO [2022-04-07 21:46:31] smooth_by_chromosome: chr: chr_0
INFO [2022-04-07 21:46:31] smooth_by_chromosome: chr: chr_B
INFO [2022-04-07 21:46:31] smooth_by_chromosome: chr: chr_0pt5
INFO [2022-04-07 21:46:31] smooth_by_chromosome: chr: chr_C
INFO [2022-04-07 21:46:32] smooth_by_chromosome: chr: chr_1pt5
INFO [2022-04-07 21:46:32] smooth_by_chromosome: chr: chr_D
INFO [2022-04-07 21:46:32] smooth_by_chromosome: chr: chr_2pt0
INFO [2022-04-07 21:46:32] smooth_by_chromosome: chr: chr_E
INFO [2022-04-07 21:46:32] smooth_by_chromosome: chr: chr_3pt0
INFO [2022-04-07 21:46:32] smooth_by_chromosome: chr: chr_F
INFO [2022-04-07 21:46:36] 

	STEP 11: re-centering data across chromosome after smoothing

INFO [2022-04-07 21:46:36] ::center_smooth across chromosomes per cell
INFO [2022-04-07 21:46:36] -mirroring for hspike
INFO [2022-04-07 21:46:36] ::center_smooth across chromosomes per cell
INFO [2022-04-07 21:46:40] 

	STEP 12: removing average of reference data (after smoothing)

INFO [2022-04-07 21:46:40] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 21:46:40] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 21:46:42] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 21:46:43] -mirroring for hspike
INFO [2022-04-07 21:46:43] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 21:46:43] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 21:46:46] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 21:46:49] 

	STEP 14: invert log2(FC) to FC

INFO [2022-04-07 21:46:49] invert_log2(), computing 2^x
INFO [2022-04-07 21:46:49] -mirroring for hspike
INFO [2022-04-07 21:46:49] invert_log2(), computing 2^x
INFO [2022-04-07 21:46:54] 

	STEP 15: Clustering samples (not defining tumor subclusters)

INFO [2022-04-07 21:46:54] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 21:46:54] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 21:46:55] cut tree into: 1 groups
INFO [2022-04-07 21:46:55] -processing all_observations,all_observations_s1
INFO [2022-04-07 21:46:55] define_signif_tumor_subclusters(), tumor: Plasma_ref
INFO [2022-04-07 21:46:55] -mirroring for hspike
INFO [2022-04-07 21:46:55] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 21:46:55] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 21:46:55] cut tree into: 1 groups
INFO [2022-04-07 21:46:55] -processing all_observations,all_observations_s1
INFO [2022-04-07 21:46:55] define_signif_tumor_subclusters(), tumor: simnorm_cell_Plasma_ref
INFO [2022-04-07 21:46:55] cut tree into: 1 groups
INFO [2022-04-07 21:46:55] -processing simnorm_cell_Plasma_ref,simnorm_cell_Plasma_ref_s1
INFO [2022-04-07 21:47:03] 

	STEP 17: HMM-based CNV prediction

INFO [2022-04-07 21:47:03] predict_CNV_via_HMM_on_whole_tumor_samples
INFO [2022-04-07 21:47:05] -done predicting CNV based on initial tumor subclusters
INFO [2022-04-07 21:47:05] get_predicted_CNV_regions(consensus)
INFO [2022-04-07 21:47:05] -processing cell_group_name: Plasma_ref, size: 2
INFO [2022-04-07 21:47:13] -processing cell_group_name: Plasma, size: 223
INFO [2022-04-07 21:47:23] -writing cell clusters file: /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.1_0/17_HMM_predHMMi6.hmm_mode-samples.cell_groupings
INFO [2022-04-07 21:47:23] -writing cnv regions file: /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.1_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_regions.dat
INFO [2022-04-07 21:47:23] -writing per-gene cnv report: /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.1_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_genes.dat
INFO [2022-04-07 21:47:23] -writing gene ordering info: /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.1_0/17_HMM_predHMMi6.hmm_mode-samples.genes_used.dat
INFO [2022-04-07 21:47:26] ::plot_cnv:Start
INFO [2022-04-07 21:47:26] ::plot_cnv:Current data dimensions (r,c)=11560,225 Total=7833328 Min=1 Max=4.
INFO [2022-04-07 21:47:26] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 21:47:29] plot_cnv_observation:Start
INFO [2022-04-07 21:47:29] Observation data size: Cells= 223 Genes= 11560
INFO [2022-04-07 21:47:29] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 21:47:31] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 21:47:31] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 21:47:31] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 21:47:31] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 21:47:31] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:47:31] Quantiles of plotted data range: 1,3,3,3,4
INFO [2022-04-07 21:47:32] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.1_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.observations.txt
INFO [2022-04-07 21:47:34] plot_cnv_references:Start
INFO [2022-04-07 21:47:34] Reference data size: Cells= 2 Genes= 11560
INFO [2022-04-07 21:47:34] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 21:47:34] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 21:47:34] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:47:34] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 21:47:34] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.1_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.references.txt
INFO [2022-04-07 21:47:34] 

	STEP 18: Run Bayesian Network Model on HMM predicted CNVs

INFO [2022-04-07 21:47:36] Initializing new MCM InferCNV Object.
INFO [2022-04-07 21:47:36] validating infercnv_obj
INFO [2022-04-07 21:47:36] Total CNV's:  37
INFO [2022-04-07 21:47:36] Loading BUGS Model.
INFO [2022-04-07 21:47:36] Running Sampling Using Parallel with  30 Cores
INFO [2022-04-07 21:48:54] Obtaining probabilities post-sampling
INFO [2022-04-07 21:49:32] Gibbs sampling time:  1.93620284398397  Minutes
INFO [2022-04-07 21:49:36] ::plot_cnv:Start
INFO [2022-04-07 21:49:36] ::plot_cnv:Current data dimensions (r,c)=11560,225 Total=312408.498898164 Min=0 Max=0.955320228854608.
INFO [2022-04-07 21:49:36] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 21:49:36] plot_cnv_observation:Start
INFO [2022-04-07 21:49:36] Observation data size: Cells= 223 Genes= 11560
INFO [2022-04-07 21:49:36] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 21:49:38] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 21:49:38] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 21:49:38] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 21:49:38] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 21:49:39] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:49:39] Quantiles of plotted data range: 0,0,0,0,0.955320228854608
INFO [2022-04-07 21:49:39] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.1_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.observations.txt
INFO [2022-04-07 21:49:41] plot_cnv_references:Start
INFO [2022-04-07 21:49:41] Reference data size: Cells= 2 Genes= 11560
INFO [2022-04-07 21:49:41] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 21:49:41] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 21:49:41] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:49:41] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 21:49:41] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.1_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.references.txt
INFO [2022-04-07 21:49:45] 

	STEP 19: Filter HMM predicted CNVs based on the Bayesian Network Model results and BayesMaxPNormal

INFO [2022-04-07 21:49:45] Attempting to removing CNV(s) with a probability of being normal above  0.5
INFO [2022-04-07 21:49:45] Removing  0  CNV(s) identified by the HMM.
INFO [2022-04-07 21:49:45] Reassigning CNVs based on state probabilities.
INFO [2022-04-07 21:49:45] Changing the following CNV's states assigned by the HMM to the following based on the CNV's state probabilities.
 chr1-region_26 : 2  (P= 0.235804464139672 ) ->  1 (P= 0.457355475482699 )
chr2-region_29 : 4  (P= 0.451132650180167 ) ->  3 (P= 0.457750788970945 )
chr11-region_65 : 4  (P= 0.305993203434624 ) ->  3 (P= 0.379205792051684 )
chr20-region_103 : 4  (P= 0.355054085752945 ) ->  3 (P= 0.432718216538126 )
INFO [2022-04-07 21:49:45] Creating Plots for CNV and cell Probabilities.
INFO [2022-04-07 21:50:03] ::plot_cnv:Start
INFO [2022-04-07 21:50:03] ::plot_cnv:Current data dimensions (r,c)=11560,225 Total=312408.498898164 Min=0 Max=0.955320228854608.
INFO [2022-04-07 21:50:03] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 21:50:03] plot_cnv_observation:Start
INFO [2022-04-07 21:50:03] Observation data size: Cells= 223 Genes= 11560
INFO [2022-04-07 21:50:03] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 21:50:05] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 21:50:05] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 21:50:05] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 21:50:05] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 21:50:05] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:50:05] Quantiles of plotted data range: 0,0,0,0,0.955320228854608
INFO [2022-04-07 21:50:06] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.1_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.observations.txt
INFO [2022-04-07 21:50:08] plot_cnv_references:Start
INFO [2022-04-07 21:50:08] Reference data size: Cells= 2 Genes= 11560
INFO [2022-04-07 21:50:08] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 21:50:08] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 21:50:08] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:50:08] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 21:50:08] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.1_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.references.txt
INFO [2022-04-07 21:50:11] ::plot_cnv:Start
INFO [2022-04-07 21:50:11] ::plot_cnv:Current data dimensions (r,c)=11560,225 Total=7781369 Min=1 Max=4.
INFO [2022-04-07 21:50:11] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 21:50:13] plot_cnv_observation:Start
INFO [2022-04-07 21:50:13] Observation data size: Cells= 223 Genes= 11560
INFO [2022-04-07 21:50:13] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 21:50:16] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 21:50:16] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 21:50:16] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 21:50:16] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 21:50:16] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:50:16] Quantiles of plotted data range: 1,3,3,3,4
INFO [2022-04-07 21:50:16] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.1_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.observations.txt
INFO [2022-04-07 21:50:18] plot_cnv_references:Start
INFO [2022-04-07 21:50:18] Reference data size: Cells= 2 Genes= 11560
INFO [2022-04-07 21:50:18] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 21:50:18] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 21:50:18] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:50:18] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 21:50:18] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.1_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.references.txt
INFO [2022-04-07 21:50:19] 

	STEP 20: Converting HMM-based CNV states to repr expr vals

INFO [2022-04-07 21:50:22] ::plot_cnv:Start
INFO [2022-04-07 21:50:22] ::plot_cnv:Current data dimensions (r,c)=11560,225 Total=2590184.5 Min=0 Max=1.5.
INFO [2022-04-07 21:50:22] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 21:50:24] plot_cnv_observation:Start
INFO [2022-04-07 21:50:24] Observation data size: Cells= 223 Genes= 11560
INFO [2022-04-07 21:50:24] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 21:50:26] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 21:50:26] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 21:50:26] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 21:50:26] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 21:50:26] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:50:26] Quantiles of plotted data range: 0,1,1,1,1.5
INFO [2022-04-07 21:50:27] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.1_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.observations.txt
INFO [2022-04-07 21:50:29] plot_cnv_references:Start
INFO [2022-04-07 21:50:29] Reference data size: Cells= 2 Genes= 11560
INFO [2022-04-07 21:50:29] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 21:50:29] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 21:50:29] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:50:29] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 21:50:29] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.1_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.references.txt
INFO [2022-04-07 21:50:29] 

	STEP 22: Denoising

INFO [2022-04-07 21:50:29] ::process_data:Remove noise, noise threshold defined via ref mean sd_amplifier:  1.5
INFO [2022-04-07 21:50:29] denoising using mean(normal) +- sd_amplifier * sd(normal) per gene per cell across all data
INFO [2022-04-07 21:50:29] :: **** clear_noise_via_ref_quantiles **** : removing noise between bounds:  1 - 1
INFO [2022-04-07 21:50:37] 

## Making the final infercnv heatmap ##
INFO [2022-04-07 21:50:38] ::plot_cnv:Start
INFO [2022-04-07 21:50:38] ::plot_cnv:Current data dimensions (r,c)=11560,225 Total=2601485.40747733 Min=0.708676009263007 Max=1.28633926270949.
INFO [2022-04-07 21:50:38] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 21:50:40] plot_cnv(): auto thresholding at: (0.884735 , 1.115265)
INFO [2022-04-07 21:50:40] plot_cnv_observation:Start
INFO [2022-04-07 21:50:40] Observation data size: Cells= 223 Genes= 11560
INFO [2022-04-07 21:50:40] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 21:50:43] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 21:50:43] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 21:50:43] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 21:50:43] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 21:50:43] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:50:43] Quantiles of plotted data range: 0.884734904336529,0.972383460847323,1,1.02813437697927,1.11526509566347
INFO [2022-04-07 21:50:44] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.1_0/infercnv.observations.txt
INFO [2022-04-07 21:50:46] plot_cnv_references:Start
INFO [2022-04-07 21:50:46] Reference data size: Cells= 2 Genes= 11560
INFO [2022-04-07 21:50:46] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 21:50:46] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 21:50:46] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:50:46] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 21:50:46] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.1_0/infercnv.references.txt
INFO [2022-04-07 21:50:47] Parsing gene order file: /home/tenggao/inferCNV/hg38_gene_order.txt
INFO [2022-04-07 21:50:47] Parsing cell annotations file: /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.3_0/27522_Relapse_2_annot.tsv
INFO [2022-04-07 21:50:47] ::order_reduce:Start.
INFO [2022-04-07 21:50:47] .order_reduce(): expr and order match.
INFO [2022-04-07 21:50:47] ::process_data:order_reduce:Reduction from positional data, new dimensions (r,c) = 21034,225 Total=179756995 Min=0 Max=6089512.
INFO [2022-04-07 21:50:47] num genes removed taking into account provided gene ordering list: 2169 = 10.3118760102691% removed.
INFO [2022-04-07 21:50:47] -filtering out cells < 100 or > Inf, removing 0 % of cells
INFO [2022-04-07 21:50:47] validating infercnv_obj
INFO [2022-04-07 21:50:47] ::process_data:Start
INFO [2022-04-07 21:50:47] 

	STEP 1: incoming data

INFO [2022-04-07 21:50:47] 

	STEP 02: Removing lowly expressed genes

INFO [2022-04-07 21:50:47] ::above_min_mean_expr_cutoff:Start
INFO [2022-04-07 21:50:47] Removing 4366 genes from matrix as below mean expr threshold: 0.1
INFO [2022-04-07 21:50:47] validating infercnv_obj
INFO [2022-04-07 21:50:47] There are 14499 genes and 225 cells remaining in the expr matrix.
INFO [2022-04-07 21:50:47] Removed 2722 genes having fewer than 3 min cells per gene = 18.7737 % genes removed here
INFO [2022-04-07 21:50:47] validating infercnv_obj
INFO [2022-04-07 21:50:48] 

	STEP 03: normalization by sequencing depth

INFO [2022-04-07 21:50:48] normalizing counts matrix by depth
INFO [2022-04-07 21:50:48] Computed total sum normalization factor as median libsize: 5163.000000
INFO [2022-04-07 21:50:48] Adding h-spike
INFO [2022-04-07 21:50:48] -hspike modeling of Plasma_ref
INFO [2022-04-07 21:52:25] validating infercnv_obj
INFO [2022-04-07 21:52:25] normalizing counts matrix by depth
INFO [2022-04-07 21:52:25] Using specified normalization factor: 5163.000000
INFO [2022-04-07 21:52:26] 

	STEP 04: log transformation of data

INFO [2022-04-07 21:52:26] transforming log2xplus1()
INFO [2022-04-07 21:52:26] -mirroring for hspike
INFO [2022-04-07 21:52:26] transforming log2xplus1()
INFO [2022-04-07 21:52:28] 

	STEP 08: removing average of reference data (before smoothing)

INFO [2022-04-07 21:52:28] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 21:52:28] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 21:52:31] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 21:53:23] -mirroring for hspike
INFO [2022-04-07 21:53:23] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 21:53:23] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 21:53:26] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 21:53:29] 

	STEP 09: apply max centered expression threshold: 3

INFO [2022-04-07 21:53:29] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 21:53:29] -mirroring for hspike
INFO [2022-04-07 21:53:29] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 21:53:32] 

	STEP 10: Smoothing data per cell by chromosome

INFO [2022-04-07 21:53:32] smooth_by_chromosome: chr: chr1
INFO [2022-04-07 21:53:32] smooth_by_chromosome: chr: chr2
INFO [2022-04-07 21:53:32] smooth_by_chromosome: chr: chr3
INFO [2022-04-07 21:53:33] smooth_by_chromosome: chr: chr4
INFO [2022-04-07 21:53:33] smooth_by_chromosome: chr: chr5
INFO [2022-04-07 21:53:33] smooth_by_chromosome: chr: chr6
INFO [2022-04-07 21:53:33] smooth_by_chromosome: chr: chr7
INFO [2022-04-07 21:53:34] smooth_by_chromosome: chr: chr8
INFO [2022-04-07 21:53:34] smooth_by_chromosome: chr: chr9
INFO [2022-04-07 21:53:34] smooth_by_chromosome: chr: chr10
INFO [2022-04-07 21:53:34] smooth_by_chromosome: chr: chr11
INFO [2022-04-07 21:53:34] smooth_by_chromosome: chr: chr12
INFO [2022-04-07 21:53:35] smooth_by_chromosome: chr: chr13
INFO [2022-04-07 21:53:35] smooth_by_chromosome: chr: chr14
INFO [2022-04-07 21:53:35] smooth_by_chromosome: chr: chr15
INFO [2022-04-07 21:53:35] smooth_by_chromosome: chr: chr16
INFO [2022-04-07 21:53:35] smooth_by_chromosome: chr: chr17
INFO [2022-04-07 21:53:36] smooth_by_chromosome: chr: chr18
INFO [2022-04-07 21:53:36] smooth_by_chromosome: chr: chr19
INFO [2022-04-07 21:53:36] smooth_by_chromosome: chr: chr20
INFO [2022-04-07 21:53:36] smooth_by_chromosome: chr: chr21
INFO [2022-04-07 21:53:36] smooth_by_chromosome: chr: chr22
INFO [2022-04-07 21:53:36] -mirroring for hspike
INFO [2022-04-07 21:53:36] smooth_by_chromosome: chr: chrA
INFO [2022-04-07 21:53:37] smooth_by_chromosome: chr: chr_0
INFO [2022-04-07 21:53:37] smooth_by_chromosome: chr: chr_B
INFO [2022-04-07 21:53:37] smooth_by_chromosome: chr: chr_0pt5
INFO [2022-04-07 21:53:37] smooth_by_chromosome: chr: chr_C
INFO [2022-04-07 21:53:37] smooth_by_chromosome: chr: chr_1pt5
INFO [2022-04-07 21:53:38] smooth_by_chromosome: chr: chr_D
INFO [2022-04-07 21:53:38] smooth_by_chromosome: chr: chr_2pt0
INFO [2022-04-07 21:53:38] smooth_by_chromosome: chr: chr_E
INFO [2022-04-07 21:53:38] smooth_by_chromosome: chr: chr_3pt0
INFO [2022-04-07 21:53:38] smooth_by_chromosome: chr: chr_F
INFO [2022-04-07 21:53:42] 

	STEP 11: re-centering data across chromosome after smoothing

INFO [2022-04-07 21:53:42] ::center_smooth across chromosomes per cell
INFO [2022-04-07 21:53:42] -mirroring for hspike
INFO [2022-04-07 21:53:42] ::center_smooth across chromosomes per cell
INFO [2022-04-07 21:53:46] 

	STEP 12: removing average of reference data (after smoothing)

INFO [2022-04-07 21:53:46] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 21:53:46] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 21:53:48] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 21:53:49] -mirroring for hspike
INFO [2022-04-07 21:53:49] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 21:53:49] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 21:53:52] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 21:53:55] 

	STEP 14: invert log2(FC) to FC

INFO [2022-04-07 21:53:55] invert_log2(), computing 2^x
INFO [2022-04-07 21:53:55] -mirroring for hspike
INFO [2022-04-07 21:53:55] invert_log2(), computing 2^x
INFO [2022-04-07 21:54:00] 

	STEP 15: Clustering samples (not defining tumor subclusters)

INFO [2022-04-07 21:54:00] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 21:54:00] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 21:54:01] cut tree into: 1 groups
INFO [2022-04-07 21:54:01] -processing all_observations,all_observations_s1
INFO [2022-04-07 21:54:01] define_signif_tumor_subclusters(), tumor: Plasma_ref
INFO [2022-04-07 21:54:01] -mirroring for hspike
INFO [2022-04-07 21:54:01] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 21:54:01] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 21:54:01] cut tree into: 1 groups
INFO [2022-04-07 21:54:01] -processing all_observations,all_observations_s1
INFO [2022-04-07 21:54:01] define_signif_tumor_subclusters(), tumor: simnorm_cell_Plasma_ref
INFO [2022-04-07 21:54:01] cut tree into: 1 groups
INFO [2022-04-07 21:54:01] -processing simnorm_cell_Plasma_ref,simnorm_cell_Plasma_ref_s1
INFO [2022-04-07 21:54:09] 

	STEP 17: HMM-based CNV prediction

INFO [2022-04-07 21:54:09] predict_CNV_via_HMM_on_whole_tumor_samples
INFO [2022-04-07 21:54:11] -done predicting CNV based on initial tumor subclusters
INFO [2022-04-07 21:54:11] get_predicted_CNV_regions(consensus)
INFO [2022-04-07 21:54:11] -processing cell_group_name: Plasma_ref, size: 2
INFO [2022-04-07 21:54:20] -processing cell_group_name: Plasma, size: 223
INFO [2022-04-07 21:54:30] -writing cell clusters file: /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.3_0/17_HMM_predHMMi6.hmm_mode-samples.cell_groupings
INFO [2022-04-07 21:54:30] -writing cnv regions file: /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.3_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_regions.dat
INFO [2022-04-07 21:54:30] -writing per-gene cnv report: /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.3_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_genes.dat
INFO [2022-04-07 21:54:30] -writing gene ordering info: /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.3_0/17_HMM_predHMMi6.hmm_mode-samples.genes_used.dat
INFO [2022-04-07 21:54:33] ::plot_cnv:Start
INFO [2022-04-07 21:54:33] ::plot_cnv:Current data dimensions (r,c)=11777,225 Total=7956388 Min=1 Max=4.
INFO [2022-04-07 21:54:33] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 21:54:36] plot_cnv_observation:Start
INFO [2022-04-07 21:54:36] Observation data size: Cells= 223 Genes= 11777
INFO [2022-04-07 21:54:36] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 21:54:38] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 21:54:38] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 21:54:38] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 21:54:38] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 21:54:38] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:54:38] Quantiles of plotted data range: 1,3,3,3,4
INFO [2022-04-07 21:54:39] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.3_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.observations.txt
INFO [2022-04-07 21:54:41] plot_cnv_references:Start
INFO [2022-04-07 21:54:41] Reference data size: Cells= 2 Genes= 11777
INFO [2022-04-07 21:54:41] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 21:54:41] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 21:54:41] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:54:41] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 21:54:41] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.3_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.references.txt
INFO [2022-04-07 21:54:41] 

	STEP 18: Run Bayesian Network Model on HMM predicted CNVs

INFO [2022-04-07 21:54:43] Initializing new MCM InferCNV Object.
INFO [2022-04-07 21:54:43] validating infercnv_obj
INFO [2022-04-07 21:54:43] Total CNV's:  29
INFO [2022-04-07 21:54:43] Loading BUGS Model.
INFO [2022-04-07 21:54:43] Running Sampling Using Parallel with  30 Cores
INFO [2022-04-07 21:55:52] Obtaining probabilities post-sampling
INFO [2022-04-07 21:56:21] Gibbs sampling time:  1.64546808004379  Minutes
INFO [2022-04-07 21:56:26] ::plot_cnv:Start
INFO [2022-04-07 21:56:26] ::plot_cnv:Current data dimensions (r,c)=11777,225 Total=231804.65316825 Min=0 Max=0.964971516919488.
INFO [2022-04-07 21:56:26] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 21:56:26] plot_cnv_observation:Start
INFO [2022-04-07 21:56:26] Observation data size: Cells= 223 Genes= 11777
INFO [2022-04-07 21:56:26] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 21:56:28] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 21:56:28] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 21:56:28] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 21:56:28] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 21:56:28] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:56:28] Quantiles of plotted data range: 0,0,0,0,0.964971516919488
INFO [2022-04-07 21:56:28] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.3_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.observations.txt
INFO [2022-04-07 21:56:30] plot_cnv_references:Start
INFO [2022-04-07 21:56:30] Reference data size: Cells= 2 Genes= 11777
INFO [2022-04-07 21:56:30] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 21:56:30] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 21:56:30] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:56:30] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 21:56:30] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.3_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.references.txt
INFO [2022-04-07 21:56:35] 

	STEP 19: Filter HMM predicted CNVs based on the Bayesian Network Model results and BayesMaxPNormal

INFO [2022-04-07 21:56:35] Attempting to removing CNV(s) with a probability of being normal above  0.5
INFO [2022-04-07 21:56:35] Removing  0  CNV(s) identified by the HMM.
INFO [2022-04-07 21:56:35] Reassigning CNVs based on state probabilities.
INFO [2022-04-07 21:56:35] Changing the following CNV's states assigned by the HMM to the following based on the CNV's state probabilities.
 chr1-region_26 : 2  (P= 0.362048787041798 ) ->  1 (P= 0.39714876752801 )
chr2-region_31 : 4  (P= 0.464284776734073 ) ->  3 (P= 0.483284425455765 )
chr6-region_47 : 4  (P= 0.368782259175238 ) ->  3 (P= 0.436593782854959 )
INFO [2022-04-07 21:56:35] Creating Plots for CNV and cell Probabilities.
INFO [2022-04-07 21:56:49] ::plot_cnv:Start
INFO [2022-04-07 21:56:49] ::plot_cnv:Current data dimensions (r,c)=11777,225 Total=231804.65316825 Min=0 Max=0.964971516919488.
INFO [2022-04-07 21:56:49] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 21:56:49] plot_cnv_observation:Start
INFO [2022-04-07 21:56:49] Observation data size: Cells= 223 Genes= 11777
INFO [2022-04-07 21:56:49] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 21:56:51] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 21:56:51] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 21:56:51] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 21:56:51] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 21:56:51] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:56:51] Quantiles of plotted data range: 0,0,0,0,0.964971516919488
INFO [2022-04-07 21:56:51] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.3_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.observations.txt
INFO [2022-04-07 21:56:53] plot_cnv_references:Start
INFO [2022-04-07 21:56:53] Reference data size: Cells= 2 Genes= 11777
INFO [2022-04-07 21:56:53] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 21:56:53] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 21:56:53] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:56:53] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 21:56:53] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.3_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.references.txt
INFO [2022-04-07 21:56:57] ::plot_cnv:Start
INFO [2022-04-07 21:56:57] ::plot_cnv:Current data dimensions (r,c)=11777,225 Total=7917140 Min=1 Max=4.
INFO [2022-04-07 21:56:57] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 21:56:59] plot_cnv_observation:Start
INFO [2022-04-07 21:56:59] Observation data size: Cells= 223 Genes= 11777
INFO [2022-04-07 21:56:59] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 21:57:01] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 21:57:01] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 21:57:01] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 21:57:01] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 21:57:02] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:57:02] Quantiles of plotted data range: 1,3,3,3,4
INFO [2022-04-07 21:57:02] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.3_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.observations.txt
INFO [2022-04-07 21:57:04] plot_cnv_references:Start
INFO [2022-04-07 21:57:04] Reference data size: Cells= 2 Genes= 11777
INFO [2022-04-07 21:57:04] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 21:57:04] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 21:57:04] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:57:04] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 21:57:04] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.3_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.references.txt
INFO [2022-04-07 21:57:05] 

	STEP 20: Converting HMM-based CNV states to repr expr vals

INFO [2022-04-07 21:57:08] ::plot_cnv:Start
INFO [2022-04-07 21:57:08] ::plot_cnv:Current data dimensions (r,c)=11777,225 Total=2633657.5 Min=0 Max=1.5.
INFO [2022-04-07 21:57:08] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 21:57:10] plot_cnv_observation:Start
INFO [2022-04-07 21:57:10] Observation data size: Cells= 223 Genes= 11777
INFO [2022-04-07 21:57:10] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 21:57:12] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 21:57:12] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 21:57:12] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 21:57:12] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 21:57:13] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:57:13] Quantiles of plotted data range: 0,1,1,1,1.5
INFO [2022-04-07 21:57:13] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.3_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.observations.txt
INFO [2022-04-07 21:57:15] plot_cnv_references:Start
INFO [2022-04-07 21:57:15] Reference data size: Cells= 2 Genes= 11777
INFO [2022-04-07 21:57:15] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 21:57:15] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 21:57:15] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:57:15] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 21:57:15] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.3_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.references.txt
INFO [2022-04-07 21:57:15] 

	STEP 22: Denoising

INFO [2022-04-07 21:57:15] ::process_data:Remove noise, noise threshold defined via ref mean sd_amplifier:  1.5
INFO [2022-04-07 21:57:15] denoising using mean(normal) +- sd_amplifier * sd(normal) per gene per cell across all data
INFO [2022-04-07 21:57:15] :: **** clear_noise_via_ref_quantiles **** : removing noise between bounds:  1 - 1
INFO [2022-04-07 21:57:23] 

## Making the final infercnv heatmap ##
INFO [2022-04-07 21:57:24] ::plot_cnv:Start
INFO [2022-04-07 21:57:24] ::plot_cnv:Current data dimensions (r,c)=11777,225 Total=2649821.1043553 Min=0.703549141211353 Max=1.29687749129367.
INFO [2022-04-07 21:57:24] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 21:57:26] plot_cnv(): auto thresholding at: (0.874798 , 1.125202)
INFO [2022-04-07 21:57:27] plot_cnv_observation:Start
INFO [2022-04-07 21:57:27] Observation data size: Cells= 223 Genes= 11777
INFO [2022-04-07 21:57:27] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 21:57:29] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 21:57:29] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 21:57:29] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 21:57:29] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 21:57:30] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:57:30] Quantiles of plotted data range: 0.874797651284655,0.970782922798143,1,1.02973336131728,1.12520234871535
INFO [2022-04-07 21:57:30] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.3_0/infercnv.observations.txt
INFO [2022-04-07 21:57:32] plot_cnv_references:Start
INFO [2022-04-07 21:57:32] Reference data size: Cells= 2 Genes= 11777
INFO [2022-04-07 21:57:32] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 21:57:32] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 21:57:32] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 21:57:32] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 21:57:32] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.3_0/infercnv.references.txt
INFO [2022-04-07 21:57:33] Parsing gene order file: /home/tenggao/inferCNV/hg38_gene_order.txt
INFO [2022-04-07 21:57:33] Parsing cell annotations file: /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.5_0/27522_Relapse_2_annot.tsv
INFO [2022-04-07 21:57:33] ::order_reduce:Start.
INFO [2022-04-07 21:57:33] .order_reduce(): expr and order match.
INFO [2022-04-07 21:57:33] ::process_data:order_reduce:Reduction from positional data, new dimensions (r,c) = 21034,226 Total=179896199 Min=0 Max=6089512.
INFO [2022-04-07 21:57:33] num genes removed taking into account provided gene ordering list: 2169 = 10.3118760102691% removed.
INFO [2022-04-07 21:57:33] -filtering out cells < 100 or > Inf, removing 0 % of cells
INFO [2022-04-07 21:57:33] validating infercnv_obj
INFO [2022-04-07 21:57:33] ::process_data:Start
INFO [2022-04-07 21:57:33] 

	STEP 1: incoming data

INFO [2022-04-07 21:57:34] 

	STEP 02: Removing lowly expressed genes

INFO [2022-04-07 21:57:34] ::above_min_mean_expr_cutoff:Start
INFO [2022-04-07 21:57:34] Removing 4358 genes from matrix as below mean expr threshold: 0.1
INFO [2022-04-07 21:57:34] validating infercnv_obj
INFO [2022-04-07 21:57:34] There are 14507 genes and 226 cells remaining in the expr matrix.
INFO [2022-04-07 21:57:34] Removed 2452 genes having fewer than 3 min cells per gene = 16.9022 % genes removed here
INFO [2022-04-07 21:57:34] validating infercnv_obj
INFO [2022-04-07 21:57:34] 

	STEP 03: normalization by sequencing depth

INFO [2022-04-07 21:57:34] normalizing counts matrix by depth
INFO [2022-04-07 21:57:34] Computed total sum normalization factor as median libsize: 5394.000000
INFO [2022-04-07 21:57:34] Adding h-spike
INFO [2022-04-07 21:57:35] -hspike modeling of Plasma_ref
INFO [2022-04-07 21:59:15] validating infercnv_obj
INFO [2022-04-07 21:59:15] normalizing counts matrix by depth
INFO [2022-04-07 21:59:15] Using specified normalization factor: 5394.000000
INFO [2022-04-07 21:59:16] 

	STEP 04: log transformation of data

INFO [2022-04-07 21:59:16] transforming log2xplus1()
INFO [2022-04-07 21:59:17] -mirroring for hspike
INFO [2022-04-07 21:59:17] transforming log2xplus1()
INFO [2022-04-07 21:59:18] 

	STEP 08: removing average of reference data (before smoothing)

INFO [2022-04-07 21:59:18] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 21:59:18] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 21:59:21] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 22:00:16] -mirroring for hspike
INFO [2022-04-07 22:00:16] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 22:00:16] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 22:00:19] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 22:00:22] 

	STEP 09: apply max centered expression threshold: 3

INFO [2022-04-07 22:00:22] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 22:00:22] -mirroring for hspike
INFO [2022-04-07 22:00:22] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 22:00:25] 

	STEP 10: Smoothing data per cell by chromosome

INFO [2022-04-07 22:00:25] smooth_by_chromosome: chr: chr1
INFO [2022-04-07 22:00:25] smooth_by_chromosome: chr: chr2
INFO [2022-04-07 22:00:26] smooth_by_chromosome: chr: chr3
INFO [2022-04-07 22:00:26] smooth_by_chromosome: chr: chr4
INFO [2022-04-07 22:00:26] smooth_by_chromosome: chr: chr5
INFO [2022-04-07 22:00:26] smooth_by_chromosome: chr: chr6
INFO [2022-04-07 22:00:27] smooth_by_chromosome: chr: chr7
INFO [2022-04-07 22:00:27] smooth_by_chromosome: chr: chr8
INFO [2022-04-07 22:00:27] smooth_by_chromosome: chr: chr9
INFO [2022-04-07 22:00:27] smooth_by_chromosome: chr: chr10
INFO [2022-04-07 22:00:27] smooth_by_chromosome: chr: chr11
INFO [2022-04-07 22:00:27] smooth_by_chromosome: chr: chr12
INFO [2022-04-07 22:00:28] smooth_by_chromosome: chr: chr13
INFO [2022-04-07 22:00:28] smooth_by_chromosome: chr: chr14
INFO [2022-04-07 22:00:28] smooth_by_chromosome: chr: chr15
INFO [2022-04-07 22:00:28] smooth_by_chromosome: chr: chr16
INFO [2022-04-07 22:00:29] smooth_by_chromosome: chr: chr17
INFO [2022-04-07 22:00:29] smooth_by_chromosome: chr: chr18
INFO [2022-04-07 22:00:29] smooth_by_chromosome: chr: chr19
INFO [2022-04-07 22:00:29] smooth_by_chromosome: chr: chr20
INFO [2022-04-07 22:00:29] smooth_by_chromosome: chr: chr21
INFO [2022-04-07 22:00:30] smooth_by_chromosome: chr: chr22
INFO [2022-04-07 22:00:30] -mirroring for hspike
INFO [2022-04-07 22:00:30] smooth_by_chromosome: chr: chrA
INFO [2022-04-07 22:00:30] smooth_by_chromosome: chr: chr_0
INFO [2022-04-07 22:00:30] smooth_by_chromosome: chr: chr_B
INFO [2022-04-07 22:00:30] smooth_by_chromosome: chr: chr_0pt5
INFO [2022-04-07 22:00:30] smooth_by_chromosome: chr: chr_C
INFO [2022-04-07 22:00:31] smooth_by_chromosome: chr: chr_1pt5
INFO [2022-04-07 22:00:31] smooth_by_chromosome: chr: chr_D
INFO [2022-04-07 22:00:31] smooth_by_chromosome: chr: chr_2pt0
INFO [2022-04-07 22:00:31] smooth_by_chromosome: chr: chr_E
INFO [2022-04-07 22:00:31] smooth_by_chromosome: chr: chr_3pt0
INFO [2022-04-07 22:00:31] smooth_by_chromosome: chr: chr_F
INFO [2022-04-07 22:00:35] 

	STEP 11: re-centering data across chromosome after smoothing

INFO [2022-04-07 22:00:35] ::center_smooth across chromosomes per cell
INFO [2022-04-07 22:00:36] -mirroring for hspike
INFO [2022-04-07 22:00:36] ::center_smooth across chromosomes per cell
INFO [2022-04-07 22:00:39] 

	STEP 12: removing average of reference data (after smoothing)

INFO [2022-04-07 22:00:39] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 22:00:39] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 22:00:42] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 22:00:42] -mirroring for hspike
INFO [2022-04-07 22:00:42] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 22:00:42] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 22:00:45] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 22:00:49] 

	STEP 14: invert log2(FC) to FC

INFO [2022-04-07 22:00:49] invert_log2(), computing 2^x
INFO [2022-04-07 22:00:49] -mirroring for hspike
INFO [2022-04-07 22:00:49] invert_log2(), computing 2^x
INFO [2022-04-07 22:00:53] 

	STEP 15: Clustering samples (not defining tumor subclusters)

INFO [2022-04-07 22:00:53] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 22:00:53] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 22:00:54] cut tree into: 1 groups
INFO [2022-04-07 22:00:54] -processing all_observations,all_observations_s1
INFO [2022-04-07 22:00:54] define_signif_tumor_subclusters(), tumor: Plasma_ref
INFO [2022-04-07 22:00:54] -mirroring for hspike
INFO [2022-04-07 22:00:54] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 22:00:54] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 22:00:54] cut tree into: 1 groups
INFO [2022-04-07 22:00:54] -processing all_observations,all_observations_s1
INFO [2022-04-07 22:00:54] define_signif_tumor_subclusters(), tumor: simnorm_cell_Plasma_ref
INFO [2022-04-07 22:00:55] cut tree into: 1 groups
INFO [2022-04-07 22:00:55] -processing simnorm_cell_Plasma_ref,simnorm_cell_Plasma_ref_s1
INFO [2022-04-07 22:01:03] 

	STEP 17: HMM-based CNV prediction

INFO [2022-04-07 22:01:03] predict_CNV_via_HMM_on_whole_tumor_samples
INFO [2022-04-07 22:01:04] -done predicting CNV based on initial tumor subclusters
INFO [2022-04-07 22:01:04] get_predicted_CNV_regions(consensus)
INFO [2022-04-07 22:01:04] -processing cell_group_name: Plasma_ref, size: 2
INFO [2022-04-07 22:01:13] -processing cell_group_name: Plasma, size: 224
INFO [2022-04-07 22:01:25] -writing cell clusters file: /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.5_0/17_HMM_predHMMi6.hmm_mode-samples.cell_groupings
INFO [2022-04-07 22:01:25] -writing cnv regions file: /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.5_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_regions.dat
INFO [2022-04-07 22:01:25] -writing per-gene cnv report: /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.5_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_genes.dat
INFO [2022-04-07 22:01:25] -writing gene ordering info: /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.5_0/17_HMM_predHMMi6.hmm_mode-samples.genes_used.dat
INFO [2022-04-07 22:01:28] ::plot_cnv:Start
INFO [2022-04-07 22:01:28] ::plot_cnv:Current data dimensions (r,c)=12055,226 Total=8175754 Min=1 Max=4.
INFO [2022-04-07 22:01:28] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:01:30] plot_cnv_observation:Start
INFO [2022-04-07 22:01:30] Observation data size: Cells= 224 Genes= 12055
INFO [2022-04-07 22:01:30] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:01:33] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:01:33] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:01:33] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:01:33] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:01:33] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:01:33] Quantiles of plotted data range: 1,3,3,3,4
INFO [2022-04-07 22:01:33] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.5_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.observations.txt
INFO [2022-04-07 22:01:36] plot_cnv_references:Start
INFO [2022-04-07 22:01:36] Reference data size: Cells= 2 Genes= 12055
INFO [2022-04-07 22:01:36] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:01:36] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:01:36] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:01:36] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 22:01:36] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.5_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.references.txt
INFO [2022-04-07 22:01:36] 

	STEP 18: Run Bayesian Network Model on HMM predicted CNVs

INFO [2022-04-07 22:01:37] Initializing new MCM InferCNV Object.
INFO [2022-04-07 22:01:37] validating infercnv_obj
INFO [2022-04-07 22:01:37] Total CNV's:  37
INFO [2022-04-07 22:01:37] Loading BUGS Model.
INFO [2022-04-07 22:01:37] Running Sampling Using Parallel with  30 Cores
INFO [2022-04-07 22:03:26] Obtaining probabilities post-sampling
INFO [2022-04-07 22:04:03] Gibbs sampling time:  2.4318533817927  Minutes
INFO [2022-04-07 22:04:08] ::plot_cnv:Start
INFO [2022-04-07 22:04:08] ::plot_cnv:Current data dimensions (r,c)=12055,226 Total=361463.34837281 Min=0 Max=0.965310668341004.
INFO [2022-04-07 22:04:08] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:04:08] plot_cnv_observation:Start
INFO [2022-04-07 22:04:08] Observation data size: Cells= 224 Genes= 12055
INFO [2022-04-07 22:04:08] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:04:10] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:04:10] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:04:10] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:04:10] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:04:10] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:04:10] Quantiles of plotted data range: 0,0,0,0,0.965310668341004
INFO [2022-04-07 22:04:11] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.5_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.observations.txt
INFO [2022-04-07 22:04:13] plot_cnv_references:Start
INFO [2022-04-07 22:04:13] Reference data size: Cells= 2 Genes= 12055
INFO [2022-04-07 22:04:13] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:04:13] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:04:13] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:04:13] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 22:04:13] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.5_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.references.txt
INFO [2022-04-07 22:04:17] 

	STEP 19: Filter HMM predicted CNVs based on the Bayesian Network Model results and BayesMaxPNormal

INFO [2022-04-07 22:04:17] Attempting to removing CNV(s) with a probability of being normal above  0.5
INFO [2022-04-07 22:04:17] Removing  0  CNV(s) identified by the HMM.
INFO [2022-04-07 22:04:17] Reassigning CNVs based on state probabilities.
INFO [2022-04-07 22:04:17] Changing the following CNV's states assigned by the HMM to the following based on the CNV's state probabilities.
 chr15-region_79 : 4  (P= 0.426105648866228 ) ->  3 (P= 0.436451844395289 )
chr22-region_102 : 2  (P= 0.355807760315333 ) ->  3 (P= 0.39565140284103 )
INFO [2022-04-07 22:04:17] Creating Plots for CNV and cell Probabilities.
INFO [2022-04-07 22:04:35] ::plot_cnv:Start
INFO [2022-04-07 22:04:35] ::plot_cnv:Current data dimensions (r,c)=12055,226 Total=361463.34837281 Min=0 Max=0.965310668341004.
INFO [2022-04-07 22:04:35] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:04:35] plot_cnv_observation:Start
INFO [2022-04-07 22:04:35] Observation data size: Cells= 224 Genes= 12055
INFO [2022-04-07 22:04:35] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:04:37] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:04:37] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:04:37] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:04:37] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:04:37] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:04:37] Quantiles of plotted data range: 0,0,0,0,0.965310668341004
INFO [2022-04-07 22:04:38] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.5_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.observations.txt
INFO [2022-04-07 22:04:40] plot_cnv_references:Start
INFO [2022-04-07 22:04:40] Reference data size: Cells= 2 Genes= 12055
INFO [2022-04-07 22:04:40] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:04:40] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:04:40] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:04:40] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 22:04:40] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.5_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.references.txt
INFO [2022-04-07 22:04:43] ::plot_cnv:Start
INFO [2022-04-07 22:04:43] ::plot_cnv:Current data dimensions (r,c)=12055,226 Total=8201514 Min=1 Max=4.
INFO [2022-04-07 22:04:43] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:04:46] plot_cnv_observation:Start
INFO [2022-04-07 22:04:46] Observation data size: Cells= 224 Genes= 12055
INFO [2022-04-07 22:04:46] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:04:48] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:04:48] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:04:48] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:04:48] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:04:48] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:04:48] Quantiles of plotted data range: 1,3,3,3,4
INFO [2022-04-07 22:04:49] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.5_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.observations.txt
INFO [2022-04-07 22:04:51] plot_cnv_references:Start
INFO [2022-04-07 22:04:51] Reference data size: Cells= 2 Genes= 12055
INFO [2022-04-07 22:04:51] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:04:51] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:04:51] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:04:51] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 22:04:51] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.5_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.references.txt
INFO [2022-04-07 22:04:51] 

	STEP 20: Converting HMM-based CNV states to repr expr vals

INFO [2022-04-07 22:04:54] ::plot_cnv:Start
INFO [2022-04-07 22:04:54] ::plot_cnv:Current data dimensions (r,c)=12055,226 Total=2738542 Min=0 Max=1.5.
INFO [2022-04-07 22:04:54] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:04:57] plot_cnv_observation:Start
INFO [2022-04-07 22:04:57] Observation data size: Cells= 224 Genes= 12055
INFO [2022-04-07 22:04:57] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:04:59] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:04:59] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:04:59] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:04:59] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:04:59] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:04:59] Quantiles of plotted data range: 0,1,1,1,1.5
INFO [2022-04-07 22:05:00] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.5_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.observations.txt
INFO [2022-04-07 22:05:02] plot_cnv_references:Start
INFO [2022-04-07 22:05:02] Reference data size: Cells= 2 Genes= 12055
INFO [2022-04-07 22:05:02] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:05:02] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:05:02] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:05:02] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 22:05:02] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.5_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.references.txt
INFO [2022-04-07 22:05:02] 

	STEP 22: Denoising

INFO [2022-04-07 22:05:02] ::process_data:Remove noise, noise threshold defined via ref mean sd_amplifier:  1.5
INFO [2022-04-07 22:05:02] denoising using mean(normal) +- sd_amplifier * sd(normal) per gene per cell across all data
INFO [2022-04-07 22:05:02] :: **** clear_noise_via_ref_quantiles **** : removing noise between bounds:  1 - 1
INFO [2022-04-07 22:05:10] 

## Making the final infercnv heatmap ##
INFO [2022-04-07 22:05:11] ::plot_cnv:Start
INFO [2022-04-07 22:05:11] ::plot_cnv:Current data dimensions (r,c)=12055,226 Total=2723413.01405349 Min=0.701708168985376 Max=1.29969521781179.
INFO [2022-04-07 22:05:11] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:05:14] plot_cnv(): auto thresholding at: (0.866493 , 1.133507)
INFO [2022-04-07 22:05:14] plot_cnv_observation:Start
INFO [2022-04-07 22:05:14] Observation data size: Cells= 224 Genes= 12055
INFO [2022-04-07 22:05:14] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:05:17] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:05:17] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:05:17] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:05:17] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:05:17] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:05:17] Quantiles of plotted data range: 0.866493010299468,0.969441346503594,1,1.03093571166063,1.13350698970053
INFO [2022-04-07 22:05:17] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.5_0/infercnv.observations.txt
INFO [2022-04-07 22:05:20] plot_cnv_references:Start
INFO [2022-04-07 22:05:20] Reference data size: Cells= 2 Genes= 12055
INFO [2022-04-07 22:05:20] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:05:20] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:05:20] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:05:20] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 22:05:20] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.5_0/infercnv.references.txt
INFO [2022-04-07 22:05:20] Parsing gene order file: /home/tenggao/inferCNV/hg38_gene_order.txt
INFO [2022-04-07 22:05:20] Parsing cell annotations file: /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.7_0/27522_Relapse_2_annot.tsv
INFO [2022-04-07 22:05:20] ::order_reduce:Start.
INFO [2022-04-07 22:05:20] .order_reduce(): expr and order match.
INFO [2022-04-07 22:05:20] ::process_data:order_reduce:Reduction from positional data, new dimensions (r,c) = 21034,225 Total=180132036 Min=0 Max=6089512.
INFO [2022-04-07 22:05:20] num genes removed taking into account provided gene ordering list: 2169 = 10.3118760102691% removed.
INFO [2022-04-07 22:05:20] -filtering out cells < 100 or > Inf, removing 0 % of cells
INFO [2022-04-07 22:05:20] validating infercnv_obj
INFO [2022-04-07 22:05:20] ::process_data:Start
INFO [2022-04-07 22:05:20] 

	STEP 1: incoming data

INFO [2022-04-07 22:05:21] 

	STEP 02: Removing lowly expressed genes

INFO [2022-04-07 22:05:21] ::above_min_mean_expr_cutoff:Start
INFO [2022-04-07 22:05:21] Removing 4351 genes from matrix as below mean expr threshold: 0.1
INFO [2022-04-07 22:05:21] validating infercnv_obj
INFO [2022-04-07 22:05:21] There are 14514 genes and 225 cells remaining in the expr matrix.
INFO [2022-04-07 22:05:21] Removed 2402 genes having fewer than 3 min cells per gene = 16.5495 % genes removed here
INFO [2022-04-07 22:05:21] validating infercnv_obj
INFO [2022-04-07 22:05:22] 

	STEP 03: normalization by sequencing depth

INFO [2022-04-07 22:05:22] normalizing counts matrix by depth
INFO [2022-04-07 22:05:22] Computed total sum normalization factor as median libsize: 6636.000000
INFO [2022-04-07 22:05:22] Adding h-spike
INFO [2022-04-07 22:05:22] -hspike modeling of Plasma_ref
INFO [2022-04-07 22:07:02] validating infercnv_obj
INFO [2022-04-07 22:07:02] normalizing counts matrix by depth
INFO [2022-04-07 22:07:03] Using specified normalization factor: 6636.000000
INFO [2022-04-07 22:07:04] 

	STEP 04: log transformation of data

INFO [2022-04-07 22:07:04] transforming log2xplus1()
INFO [2022-04-07 22:07:04] -mirroring for hspike
INFO [2022-04-07 22:07:04] transforming log2xplus1()
INFO [2022-04-07 22:07:06] 

	STEP 08: removing average of reference data (before smoothing)

INFO [2022-04-07 22:07:06] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 22:07:06] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 22:07:09] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 22:08:02] -mirroring for hspike
INFO [2022-04-07 22:08:02] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 22:08:02] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 22:08:05] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 22:08:08] 

	STEP 09: apply max centered expression threshold: 3

INFO [2022-04-07 22:08:08] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 22:08:08] -mirroring for hspike
INFO [2022-04-07 22:08:08] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 22:08:11] 

	STEP 10: Smoothing data per cell by chromosome

INFO [2022-04-07 22:08:11] smooth_by_chromosome: chr: chr1
INFO [2022-04-07 22:08:12] smooth_by_chromosome: chr: chr2
INFO [2022-04-07 22:08:12] smooth_by_chromosome: chr: chr3
INFO [2022-04-07 22:08:12] smooth_by_chromosome: chr: chr4
INFO [2022-04-07 22:08:12] smooth_by_chromosome: chr: chr5
INFO [2022-04-07 22:08:12] smooth_by_chromosome: chr: chr6
INFO [2022-04-07 22:08:13] smooth_by_chromosome: chr: chr7
INFO [2022-04-07 22:08:13] smooth_by_chromosome: chr: chr8
INFO [2022-04-07 22:08:13] smooth_by_chromosome: chr: chr9
INFO [2022-04-07 22:08:13] smooth_by_chromosome: chr: chr10
INFO [2022-04-07 22:08:13] smooth_by_chromosome: chr: chr11
INFO [2022-04-07 22:08:14] smooth_by_chromosome: chr: chr12
INFO [2022-04-07 22:08:14] smooth_by_chromosome: chr: chr13
INFO [2022-04-07 22:08:14] smooth_by_chromosome: chr: chr14
INFO [2022-04-07 22:08:14] smooth_by_chromosome: chr: chr15
INFO [2022-04-07 22:08:15] smooth_by_chromosome: chr: chr16
INFO [2022-04-07 22:08:15] smooth_by_chromosome: chr: chr17
INFO [2022-04-07 22:08:15] smooth_by_chromosome: chr: chr18
INFO [2022-04-07 22:08:15] smooth_by_chromosome: chr: chr19
INFO [2022-04-07 22:08:15] smooth_by_chromosome: chr: chr20
INFO [2022-04-07 22:08:16] smooth_by_chromosome: chr: chr21
INFO [2022-04-07 22:08:16] smooth_by_chromosome: chr: chr22
INFO [2022-04-07 22:08:16] -mirroring for hspike
INFO [2022-04-07 22:08:16] smooth_by_chromosome: chr: chrA
INFO [2022-04-07 22:08:16] smooth_by_chromosome: chr: chr_0
INFO [2022-04-07 22:08:16] smooth_by_chromosome: chr: chr_B
INFO [2022-04-07 22:08:16] smooth_by_chromosome: chr: chr_0pt5
INFO [2022-04-07 22:08:17] smooth_by_chromosome: chr: chr_C
INFO [2022-04-07 22:08:17] smooth_by_chromosome: chr: chr_1pt5
INFO [2022-04-07 22:08:17] smooth_by_chromosome: chr: chr_D
INFO [2022-04-07 22:08:17] smooth_by_chromosome: chr: chr_2pt0
INFO [2022-04-07 22:08:17] smooth_by_chromosome: chr: chr_E
INFO [2022-04-07 22:08:17] smooth_by_chromosome: chr: chr_3pt0
INFO [2022-04-07 22:08:18] smooth_by_chromosome: chr: chr_F
INFO [2022-04-07 22:08:22] 

	STEP 11: re-centering data across chromosome after smoothing

INFO [2022-04-07 22:08:22] ::center_smooth across chromosomes per cell
INFO [2022-04-07 22:08:22] -mirroring for hspike
INFO [2022-04-07 22:08:22] ::center_smooth across chromosomes per cell
INFO [2022-04-07 22:08:25] 

	STEP 12: removing average of reference data (after smoothing)

INFO [2022-04-07 22:08:25] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 22:08:25] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 22:08:28] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 22:08:29] -mirroring for hspike
INFO [2022-04-07 22:08:29] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 22:08:29] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 22:08:31] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 22:08:35] 

	STEP 14: invert log2(FC) to FC

INFO [2022-04-07 22:08:35] invert_log2(), computing 2^x
INFO [2022-04-07 22:08:35] -mirroring for hspike
INFO [2022-04-07 22:08:35] invert_log2(), computing 2^x
INFO [2022-04-07 22:08:40] 

	STEP 15: Clustering samples (not defining tumor subclusters)

INFO [2022-04-07 22:08:40] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 22:08:40] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 22:08:41] cut tree into: 1 groups
INFO [2022-04-07 22:08:41] -processing all_observations,all_observations_s1
INFO [2022-04-07 22:08:41] define_signif_tumor_subclusters(), tumor: Plasma_ref
INFO [2022-04-07 22:08:41] -mirroring for hspike
INFO [2022-04-07 22:08:41] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 22:08:41] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 22:08:41] cut tree into: 1 groups
INFO [2022-04-07 22:08:41] -processing all_observations,all_observations_s1
INFO [2022-04-07 22:08:41] define_signif_tumor_subclusters(), tumor: simnorm_cell_Plasma_ref
INFO [2022-04-07 22:08:41] cut tree into: 1 groups
INFO [2022-04-07 22:08:41] -processing simnorm_cell_Plasma_ref,simnorm_cell_Plasma_ref_s1
INFO [2022-04-07 22:08:49] 

	STEP 17: HMM-based CNV prediction

INFO [2022-04-07 22:08:49] predict_CNV_via_HMM_on_whole_tumor_samples
INFO [2022-04-07 22:08:51] -done predicting CNV based on initial tumor subclusters
INFO [2022-04-07 22:08:51] get_predicted_CNV_regions(consensus)
INFO [2022-04-07 22:08:51] -processing cell_group_name: Plasma_ref, size: 2
INFO [2022-04-07 22:09:00] -processing cell_group_name: Plasma, size: 223
INFO [2022-04-07 22:09:11] -writing cell clusters file: /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.7_0/17_HMM_predHMMi6.hmm_mode-samples.cell_groupings
INFO [2022-04-07 22:09:11] -writing cnv regions file: /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.7_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_regions.dat
INFO [2022-04-07 22:09:11] -writing per-gene cnv report: /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.7_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_genes.dat
INFO [2022-04-07 22:09:11] -writing gene ordering info: /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.7_0/17_HMM_predHMMi6.hmm_mode-samples.genes_used.dat
INFO [2022-04-07 22:09:14] ::plot_cnv:Start
INFO [2022-04-07 22:09:14] ::plot_cnv:Current data dimensions (r,c)=12112,225 Total=8247629 Min=1 Max=4.
INFO [2022-04-07 22:09:14] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:09:17] plot_cnv_observation:Start
INFO [2022-04-07 22:09:17] Observation data size: Cells= 223 Genes= 12112
INFO [2022-04-07 22:09:17] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:09:19] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:09:19] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:09:19] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:09:19] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:09:20] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:09:20] Quantiles of plotted data range: 1,3,3,3,4
INFO [2022-04-07 22:09:20] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.7_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.observations.txt
INFO [2022-04-07 22:09:22] plot_cnv_references:Start
INFO [2022-04-07 22:09:22] Reference data size: Cells= 2 Genes= 12112
INFO [2022-04-07 22:09:22] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:09:22] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:09:22] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:09:22] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 22:09:22] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.7_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.references.txt
INFO [2022-04-07 22:09:23] 

	STEP 18: Run Bayesian Network Model on HMM predicted CNVs

INFO [2022-04-07 22:09:24] Initializing new MCM InferCNV Object.
INFO [2022-04-07 22:09:24] validating infercnv_obj
INFO [2022-04-07 22:09:24] Total CNV's:  35
INFO [2022-04-07 22:09:24] Loading BUGS Model.
INFO [2022-04-07 22:09:24] Running Sampling Using Parallel with  30 Cores
INFO [2022-04-07 22:11:23] Obtaining probabilities post-sampling
INFO [2022-04-07 22:11:58] Gibbs sampling time:  2.56969168980916  Minutes
INFO [2022-04-07 22:12:02] ::plot_cnv:Start
INFO [2022-04-07 22:12:02] ::plot_cnv:Current data dimensions (r,c)=12112,225 Total=409462.646736672 Min=0 Max=0.965252282366357.
INFO [2022-04-07 22:12:02] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:12:03] plot_cnv_observation:Start
INFO [2022-04-07 22:12:03] Observation data size: Cells= 223 Genes= 12112
INFO [2022-04-07 22:12:03] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:12:05] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:12:05] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:12:05] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:12:05] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:12:05] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:12:05] Quantiles of plotted data range: 0,0,0,0,0.965252282366357
INFO [2022-04-07 22:12:05] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.7_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.observations.txt
INFO [2022-04-07 22:12:07] plot_cnv_references:Start
INFO [2022-04-07 22:12:07] Reference data size: Cells= 2 Genes= 12112
INFO [2022-04-07 22:12:07] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:12:07] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:12:07] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:12:07] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 22:12:07] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.7_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.references.txt
INFO [2022-04-07 22:12:12] 

	STEP 19: Filter HMM predicted CNVs based on the Bayesian Network Model results and BayesMaxPNormal

INFO [2022-04-07 22:12:12] Attempting to removing CNV(s) with a probability of being normal above  0.5
INFO [2022-04-07 22:12:12] Removing  0  CNV(s) identified by the HMM.
INFO [2022-04-07 22:12:12] Reassigning CNVs based on state probabilities.
INFO [2022-04-07 22:12:12] Creating Plots for CNV and cell Probabilities.
INFO [2022-04-07 22:12:29] ::plot_cnv:Start
INFO [2022-04-07 22:12:29] ::plot_cnv:Current data dimensions (r,c)=12112,225 Total=409462.646736672 Min=0 Max=0.965252282366357.
INFO [2022-04-07 22:12:29] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:12:29] plot_cnv_observation:Start
INFO [2022-04-07 22:12:29] Observation data size: Cells= 223 Genes= 12112
INFO [2022-04-07 22:12:29] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:12:31] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:12:31] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:12:31] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:12:31] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:12:31] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:12:31] Quantiles of plotted data range: 0,0,0,0,0.965252282366357
INFO [2022-04-07 22:12:32] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.7_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.observations.txt
INFO [2022-04-07 22:12:34] plot_cnv_references:Start
INFO [2022-04-07 22:12:34] Reference data size: Cells= 2 Genes= 12112
INFO [2022-04-07 22:12:34] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:12:34] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:12:34] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:12:34] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 22:12:34] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.7_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.references.txt
INFO [2022-04-07 22:12:37] ::plot_cnv:Start
INFO [2022-04-07 22:12:37] ::plot_cnv:Current data dimensions (r,c)=12112,225 Total=8247629 Min=1 Max=4.
INFO [2022-04-07 22:12:37] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:12:40] plot_cnv_observation:Start
INFO [2022-04-07 22:12:40] Observation data size: Cells= 223 Genes= 12112
INFO [2022-04-07 22:12:40] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:12:42] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:12:42] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:12:42] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:12:42] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:12:42] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:12:42] Quantiles of plotted data range: 1,3,3,3,4
INFO [2022-04-07 22:12:43] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.7_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.observations.txt
INFO [2022-04-07 22:12:45] plot_cnv_references:Start
INFO [2022-04-07 22:12:45] Reference data size: Cells= 2 Genes= 12112
INFO [2022-04-07 22:12:45] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:12:45] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:12:45] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:12:45] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 22:12:45] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.7_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.references.txt
INFO [2022-04-07 22:12:45] 

	STEP 20: Converting HMM-based CNV states to repr expr vals

INFO [2022-04-07 22:12:48] ::plot_cnv:Start
INFO [2022-04-07 22:12:48] ::plot_cnv:Current data dimensions (r,c)=12112,225 Total=2761214.5 Min=0 Max=1.5.
INFO [2022-04-07 22:12:48] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:12:51] plot_cnv_observation:Start
INFO [2022-04-07 22:12:51] Observation data size: Cells= 223 Genes= 12112
INFO [2022-04-07 22:12:51] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:12:53] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:12:53] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:12:53] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:12:53] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:12:53] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:12:53] Quantiles of plotted data range: 0,1,1,1,1.5
INFO [2022-04-07 22:12:54] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.7_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.observations.txt
INFO [2022-04-07 22:12:56] plot_cnv_references:Start
INFO [2022-04-07 22:12:56] Reference data size: Cells= 2 Genes= 12112
INFO [2022-04-07 22:12:56] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:12:56] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:12:56] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:12:56] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 22:12:56] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.7_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.references.txt
INFO [2022-04-07 22:12:56] 

	STEP 22: Denoising

INFO [2022-04-07 22:12:56] ::process_data:Remove noise, noise threshold defined via ref mean sd_amplifier:  1.5
INFO [2022-04-07 22:12:56] denoising using mean(normal) +- sd_amplifier * sd(normal) per gene per cell across all data
INFO [2022-04-07 22:12:56] :: **** clear_noise_via_ref_quantiles **** : removing noise between bounds:  1 - 1
INFO [2022-04-07 22:13:04] 

## Making the final infercnv heatmap ##
INFO [2022-04-07 22:13:05] ::plot_cnv:Start
INFO [2022-04-07 22:13:05] ::plot_cnv:Current data dimensions (r,c)=12112,225 Total=2723538.82023832 Min=0.68476457347315 Max=1.31038550375104.
INFO [2022-04-07 22:13:05] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:13:08] plot_cnv(): auto thresholding at: (0.848099 , 1.151901)
INFO [2022-04-07 22:13:08] plot_cnv_observation:Start
INFO [2022-04-07 22:13:08] Observation data size: Cells= 223 Genes= 12112
INFO [2022-04-07 22:13:08] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:13:10] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:13:10] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:13:10] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:13:10] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:13:11] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:13:11] Quantiles of plotted data range: 0.848098634217404,0.964850941495435,1,1.03545214898126,1.1519013657826
INFO [2022-04-07 22:13:11] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.7_0/infercnv.observations.txt
INFO [2022-04-07 22:13:14] plot_cnv_references:Start
INFO [2022-04-07 22:13:14] Reference data size: Cells= 2 Genes= 12112
INFO [2022-04-07 22:13:14] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:13:14] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:13:14] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:13:14] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 22:13:14] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.7_0/infercnv.references.txt
INFO [2022-04-07 22:13:14] Parsing gene order file: /home/tenggao/inferCNV/hg38_gene_order.txt
INFO [2022-04-07 22:13:14] Parsing cell annotations file: /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.9_0/27522_Relapse_2_annot.tsv
INFO [2022-04-07 22:13:14] ::order_reduce:Start.
INFO [2022-04-07 22:13:14] .order_reduce(): expr and order match.
INFO [2022-04-07 22:13:14] ::process_data:order_reduce:Reduction from positional data, new dimensions (r,c) = 21034,225 Total=180243957 Min=0 Max=6089512.
INFO [2022-04-07 22:13:14] num genes removed taking into account provided gene ordering list: 2169 = 10.3118760102691% removed.
INFO [2022-04-07 22:13:14] -filtering out cells < 100 or > Inf, removing 0 % of cells
INFO [2022-04-07 22:13:14] validating infercnv_obj
INFO [2022-04-07 22:13:14] ::process_data:Start
INFO [2022-04-07 22:13:14] 

	STEP 1: incoming data

INFO [2022-04-07 22:13:15] 

	STEP 02: Removing lowly expressed genes

INFO [2022-04-07 22:13:15] ::above_min_mean_expr_cutoff:Start
INFO [2022-04-07 22:13:15] Removing 4342 genes from matrix as below mean expr threshold: 0.1
INFO [2022-04-07 22:13:15] validating infercnv_obj
INFO [2022-04-07 22:13:15] There are 14523 genes and 225 cells remaining in the expr matrix.
INFO [2022-04-07 22:13:15] Removed 2519 genes having fewer than 3 min cells per gene = 17.3449 % genes removed here
INFO [2022-04-07 22:13:15] validating infercnv_obj
INFO [2022-04-07 22:13:16] 

	STEP 03: normalization by sequencing depth

INFO [2022-04-07 22:13:16] normalizing counts matrix by depth
INFO [2022-04-07 22:13:16] Computed total sum normalization factor as median libsize: 7389.000000
INFO [2022-04-07 22:13:16] Adding h-spike
INFO [2022-04-07 22:13:16] -hspike modeling of Plasma_ref
INFO [2022-04-07 22:14:56] validating infercnv_obj
INFO [2022-04-07 22:14:56] normalizing counts matrix by depth
INFO [2022-04-07 22:14:56] Using specified normalization factor: 7389.000000
INFO [2022-04-07 22:14:58] 

	STEP 04: log transformation of data

INFO [2022-04-07 22:14:58] transforming log2xplus1()
INFO [2022-04-07 22:14:58] -mirroring for hspike
INFO [2022-04-07 22:14:58] transforming log2xplus1()
INFO [2022-04-07 22:15:00] 

	STEP 08: removing average of reference data (before smoothing)

INFO [2022-04-07 22:15:00] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 22:15:00] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 22:15:03] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 22:15:55] -mirroring for hspike
INFO [2022-04-07 22:15:55] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 22:15:55] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 22:15:58] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 22:16:01] 

	STEP 09: apply max centered expression threshold: 3

INFO [2022-04-07 22:16:01] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 22:16:01] -mirroring for hspike
INFO [2022-04-07 22:16:01] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 22:16:04] 

	STEP 10: Smoothing data per cell by chromosome

INFO [2022-04-07 22:16:04] smooth_by_chromosome: chr: chr1
INFO [2022-04-07 22:16:04] smooth_by_chromosome: chr: chr2
INFO [2022-04-07 22:16:05] smooth_by_chromosome: chr: chr3
INFO [2022-04-07 22:16:05] smooth_by_chromosome: chr: chr4
INFO [2022-04-07 22:16:05] smooth_by_chromosome: chr: chr5
INFO [2022-04-07 22:16:05] smooth_by_chromosome: chr: chr6
INFO [2022-04-07 22:16:06] smooth_by_chromosome: chr: chr7
INFO [2022-04-07 22:16:06] smooth_by_chromosome: chr: chr8
INFO [2022-04-07 22:16:06] smooth_by_chromosome: chr: chr9
INFO [2022-04-07 22:16:06] smooth_by_chromosome: chr: chr10
INFO [2022-04-07 22:16:06] smooth_by_chromosome: chr: chr11
INFO [2022-04-07 22:16:07] smooth_by_chromosome: chr: chr12
INFO [2022-04-07 22:16:07] smooth_by_chromosome: chr: chr13
INFO [2022-04-07 22:16:07] smooth_by_chromosome: chr: chr14
INFO [2022-04-07 22:16:07] smooth_by_chromosome: chr: chr15
INFO [2022-04-07 22:16:07] smooth_by_chromosome: chr: chr16
INFO [2022-04-07 22:16:08] smooth_by_chromosome: chr: chr17
INFO [2022-04-07 22:16:08] smooth_by_chromosome: chr: chr18
INFO [2022-04-07 22:16:08] smooth_by_chromosome: chr: chr19
INFO [2022-04-07 22:16:08] smooth_by_chromosome: chr: chr20
INFO [2022-04-07 22:16:08] smooth_by_chromosome: chr: chr21
INFO [2022-04-07 22:16:09] smooth_by_chromosome: chr: chr22
INFO [2022-04-07 22:16:09] -mirroring for hspike
INFO [2022-04-07 22:16:09] smooth_by_chromosome: chr: chrA
INFO [2022-04-07 22:16:09] smooth_by_chromosome: chr: chr_0
INFO [2022-04-07 22:16:09] smooth_by_chromosome: chr: chr_B
INFO [2022-04-07 22:16:09] smooth_by_chromosome: chr: chr_0pt5
INFO [2022-04-07 22:16:09] smooth_by_chromosome: chr: chr_C
INFO [2022-04-07 22:16:10] smooth_by_chromosome: chr: chr_1pt5
INFO [2022-04-07 22:16:10] smooth_by_chromosome: chr: chr_D
INFO [2022-04-07 22:16:10] smooth_by_chromosome: chr: chr_2pt0
INFO [2022-04-07 22:16:10] smooth_by_chromosome: chr: chr_E
INFO [2022-04-07 22:16:10] smooth_by_chromosome: chr: chr_3pt0
INFO [2022-04-07 22:16:11] smooth_by_chromosome: chr: chr_F
INFO [2022-04-07 22:16:14] 

	STEP 11: re-centering data across chromosome after smoothing

INFO [2022-04-07 22:16:15] ::center_smooth across chromosomes per cell
INFO [2022-04-07 22:16:15] -mirroring for hspike
INFO [2022-04-07 22:16:15] ::center_smooth across chromosomes per cell
INFO [2022-04-07 22:16:18] 

	STEP 12: removing average of reference data (after smoothing)

INFO [2022-04-07 22:16:18] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 22:16:18] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 22:16:21] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 22:16:21] -mirroring for hspike
INFO [2022-04-07 22:16:21] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 22:16:21] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 22:16:24] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 22:16:28] 

	STEP 14: invert log2(FC) to FC

INFO [2022-04-07 22:16:28] invert_log2(), computing 2^x
INFO [2022-04-07 22:16:28] -mirroring for hspike
INFO [2022-04-07 22:16:28] invert_log2(), computing 2^x
INFO [2022-04-07 22:16:33] 

	STEP 15: Clustering samples (not defining tumor subclusters)

INFO [2022-04-07 22:16:33] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 22:16:33] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 22:16:34] cut tree into: 1 groups
INFO [2022-04-07 22:16:34] -processing all_observations,all_observations_s1
INFO [2022-04-07 22:16:34] define_signif_tumor_subclusters(), tumor: Plasma_ref
INFO [2022-04-07 22:16:34] -mirroring for hspike
INFO [2022-04-07 22:16:34] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 22:16:34] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 22:16:34] cut tree into: 1 groups
INFO [2022-04-07 22:16:34] -processing all_observations,all_observations_s1
INFO [2022-04-07 22:16:34] define_signif_tumor_subclusters(), tumor: simnorm_cell_Plasma_ref
INFO [2022-04-07 22:16:34] cut tree into: 1 groups
INFO [2022-04-07 22:16:34] -processing simnorm_cell_Plasma_ref,simnorm_cell_Plasma_ref_s1
INFO [2022-04-07 22:16:42] 

	STEP 17: HMM-based CNV prediction

INFO [2022-04-07 22:16:42] predict_CNV_via_HMM_on_whole_tumor_samples
INFO [2022-04-07 22:16:44] -done predicting CNV based on initial tumor subclusters
INFO [2022-04-07 22:16:44] get_predicted_CNV_regions(consensus)
INFO [2022-04-07 22:16:44] -processing cell_group_name: Plasma_ref, size: 2
INFO [2022-04-07 22:16:53] -processing cell_group_name: Plasma, size: 223
INFO [2022-04-07 22:17:03] -writing cell clusters file: /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.9_0/17_HMM_predHMMi6.hmm_mode-samples.cell_groupings
INFO [2022-04-07 22:17:03] -writing cnv regions file: /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.9_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_regions.dat
INFO [2022-04-07 22:17:03] -writing per-gene cnv report: /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.9_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_genes.dat
INFO [2022-04-07 22:17:03] -writing gene ordering info: /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.9_0/17_HMM_predHMMi6.hmm_mode-samples.genes_used.dat
INFO [2022-04-07 22:17:06] ::plot_cnv:Start
INFO [2022-04-07 22:17:06] ::plot_cnv:Current data dimensions (r,c)=12004,225 Total=8291804 Min=1 Max=5.
INFO [2022-04-07 22:17:06] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:17:09] plot_cnv_observation:Start
INFO [2022-04-07 22:17:09] Observation data size: Cells= 223 Genes= 12004
INFO [2022-04-07 22:17:09] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:17:11] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:17:11] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:17:11] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:17:11] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:17:12] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:17:12] Quantiles of plotted data range: 1,3,3,3,5
INFO [2022-04-07 22:17:12] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.9_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.observations.txt
INFO [2022-04-07 22:17:14] plot_cnv_references:Start
INFO [2022-04-07 22:17:14] Reference data size: Cells= 2 Genes= 12004
INFO [2022-04-07 22:17:14] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:17:14] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:17:14] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:17:14] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 22:17:14] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.9_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.references.txt
INFO [2022-04-07 22:17:15] 

	STEP 18: Run Bayesian Network Model on HMM predicted CNVs

INFO [2022-04-07 22:17:16] Initializing new MCM InferCNV Object.
INFO [2022-04-07 22:17:16] validating infercnv_obj
INFO [2022-04-07 22:17:16] Total CNV's:  55
INFO [2022-04-07 22:17:16] Loading BUGS Model.
INFO [2022-04-07 22:17:16] Running Sampling Using Parallel with  30 Cores
INFO [2022-04-07 22:20:29] Obtaining probabilities post-sampling
INFO [2022-04-07 22:21:23] Gibbs sampling time:  4.12181585232417  Minutes
INFO [2022-04-07 22:21:28] ::plot_cnv:Start
INFO [2022-04-07 22:21:28] ::plot_cnv:Current data dimensions (r,c)=12004,225 Total=707234.618083953 Min=0 Max=0.991239771489241.
INFO [2022-04-07 22:21:28] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:21:28] plot_cnv_observation:Start
INFO [2022-04-07 22:21:28] Observation data size: Cells= 223 Genes= 12004
INFO [2022-04-07 22:21:28] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:21:30] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:21:30] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:21:30] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:21:30] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:21:31] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:21:31] Quantiles of plotted data range: 0,0,0,0.710201772038757,0.991239771489241
INFO [2022-04-07 22:21:31] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.9_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.observations.txt
INFO [2022-04-07 22:21:33] plot_cnv_references:Start
INFO [2022-04-07 22:21:33] Reference data size: Cells= 2 Genes= 12004
INFO [2022-04-07 22:21:33] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:21:33] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:21:33] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:21:33] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 22:21:33] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.9_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.references.txt
INFO [2022-04-07 22:21:38] 

	STEP 19: Filter HMM predicted CNVs based on the Bayesian Network Model results and BayesMaxPNormal

INFO [2022-04-07 22:21:38] Attempting to removing CNV(s) with a probability of being normal above  0.5
INFO [2022-04-07 22:21:38] Removing  0  CNV(s) identified by the HMM.
INFO [2022-04-07 22:21:38] Reassigning CNVs based on state probabilities.
INFO [2022-04-07 22:21:38] Creating Plots for CNV and cell Probabilities.
INFO [2022-04-07 22:22:05] ::plot_cnv:Start
INFO [2022-04-07 22:22:05] ::plot_cnv:Current data dimensions (r,c)=12004,225 Total=707234.618083953 Min=0 Max=0.991239771489241.
INFO [2022-04-07 22:22:05] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:22:05] plot_cnv_observation:Start
INFO [2022-04-07 22:22:05] Observation data size: Cells= 223 Genes= 12004
INFO [2022-04-07 22:22:05] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:22:07] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:22:07] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:22:07] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:22:07] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:22:07] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:22:07] Quantiles of plotted data range: 0,0,0,0.710201772038757,0.991239771489241
INFO [2022-04-07 22:22:08] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.9_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.observations.txt
INFO [2022-04-07 22:22:10] plot_cnv_references:Start
INFO [2022-04-07 22:22:10] Reference data size: Cells= 2 Genes= 12004
INFO [2022-04-07 22:22:10] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:22:10] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:22:10] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:22:10] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 22:22:10] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.9_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.references.txt
INFO [2022-04-07 22:22:13] ::plot_cnv:Start
INFO [2022-04-07 22:22:13] ::plot_cnv:Current data dimensions (r,c)=12004,225 Total=8291804 Min=1 Max=5.
INFO [2022-04-07 22:22:13] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:22:16] plot_cnv_observation:Start
INFO [2022-04-07 22:22:16] Observation data size: Cells= 223 Genes= 12004
INFO [2022-04-07 22:22:16] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:22:18] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:22:18] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:22:18] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:22:18] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:22:18] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:22:18] Quantiles of plotted data range: 1,3,3,3,5
INFO [2022-04-07 22:22:19] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.9_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.observations.txt
INFO [2022-04-07 22:22:21] plot_cnv_references:Start
INFO [2022-04-07 22:22:21] Reference data size: Cells= 2 Genes= 12004
INFO [2022-04-07 22:22:21] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:22:21] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:22:21] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:22:21] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 22:22:21] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.9_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.references.txt
INFO [2022-04-07 22:22:21] 

	STEP 20: Converting HMM-based CNV states to repr expr vals

INFO [2022-04-07 22:22:24] ::plot_cnv:Start
INFO [2022-04-07 22:22:24] ::plot_cnv:Current data dimensions (r,c)=12004,225 Total=2795452 Min=0 Max=2.
INFO [2022-04-07 22:22:24] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:22:27] plot_cnv_observation:Start
INFO [2022-04-07 22:22:27] Observation data size: Cells= 223 Genes= 12004
INFO [2022-04-07 22:22:27] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:22:29] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:22:29] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:22:29] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:22:29] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:22:29] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:22:29] Quantiles of plotted data range: 0,1,1,1,2
INFO [2022-04-07 22:22:30] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.9_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.observations.txt
INFO [2022-04-07 22:22:32] plot_cnv_references:Start
INFO [2022-04-07 22:22:32] Reference data size: Cells= 2 Genes= 12004
INFO [2022-04-07 22:22:32] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:22:32] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:22:32] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:22:32] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 22:22:32] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.9_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.references.txt
INFO [2022-04-07 22:22:32] 

	STEP 22: Denoising

INFO [2022-04-07 22:22:32] ::process_data:Remove noise, noise threshold defined via ref mean sd_amplifier:  1.5
INFO [2022-04-07 22:22:32] denoising using mean(normal) +- sd_amplifier * sd(normal) per gene per cell across all data
INFO [2022-04-07 22:22:32] :: **** clear_noise_via_ref_quantiles **** : removing noise between bounds:  1 - 1
INFO [2022-04-07 22:22:40] 

## Making the final infercnv heatmap ##
INFO [2022-04-07 22:22:41] ::plot_cnv:Start
INFO [2022-04-07 22:22:41] ::plot_cnv:Current data dimensions (r,c)=12004,225 Total=2699206.58848265 Min=0.676176729367852 Max=1.33200754802326.
INFO [2022-04-07 22:22:41] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:22:44] plot_cnv(): auto thresholding at: (0.836428 , 1.163572)
INFO [2022-04-07 22:22:44] plot_cnv_observation:Start
INFO [2022-04-07 22:22:44] Observation data size: Cells= 223 Genes= 12004
INFO [2022-04-07 22:22:44] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:22:47] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:22:47] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:22:47] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:22:47] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:22:47] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:22:47] Quantiles of plotted data range: 0.836428392547558,0.961275845538686,1,1.0392353172923,1.16357160745244
INFO [2022-04-07 22:22:47] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.9_0/infercnv.observations.txt
INFO [2022-04-07 22:22:50] plot_cnv_references:Start
INFO [2022-04-07 22:22:50] Reference data size: Cells= 2 Genes= 12004
INFO [2022-04-07 22:22:50] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:22:50] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:22:50] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:22:50] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 22:22:50] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/27522_Relapse_2_0.9_0/infercnv.references.txt
INFO [2022-04-07 22:22:50] Parsing gene order file: /home/tenggao/inferCNV/hg38_gene_order.txt
INFO [2022-04-07 22:22:50] Parsing cell annotations file: /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.1_0/59114_Relapse_1_annot.tsv
INFO [2022-04-07 22:22:50] ::order_reduce:Start.
INFO [2022-04-07 22:22:50] .order_reduce(): expr and order match.
INFO [2022-04-07 22:22:50] ::process_data:order_reduce:Reduction from positional data, new dimensions (r,c) = 21034,303 Total=179615871 Min=0 Max=6089512.
INFO [2022-04-07 22:22:50] num genes removed taking into account provided gene ordering list: 2169 = 10.3118760102691% removed.
INFO [2022-04-07 22:22:50] -filtering out cells < 100 or > Inf, removing 0 % of cells
INFO [2022-04-07 22:22:50] validating infercnv_obj
INFO [2022-04-07 22:22:50] ::process_data:Start
INFO [2022-04-07 22:22:50] 

	STEP 1: incoming data

INFO [2022-04-07 22:22:51] 

	STEP 02: Removing lowly expressed genes

INFO [2022-04-07 22:22:51] ::above_min_mean_expr_cutoff:Start
INFO [2022-04-07 22:22:51] Removing 4607 genes from matrix as below mean expr threshold: 0.1
INFO [2022-04-07 22:22:51] validating infercnv_obj
INFO [2022-04-07 22:22:51] There are 14258 genes and 303 cells remaining in the expr matrix.
INFO [2022-04-07 22:22:51] Removed 2758 genes having fewer than 3 min cells per gene = 19.3435 % genes removed here
INFO [2022-04-07 22:22:51] validating infercnv_obj
INFO [2022-04-07 22:22:52] 

	STEP 03: normalization by sequencing depth

INFO [2022-04-07 22:22:52] normalizing counts matrix by depth
INFO [2022-04-07 22:22:52] Computed total sum normalization factor as median libsize: 2962.000000
INFO [2022-04-07 22:22:52] Adding h-spike
INFO [2022-04-07 22:22:52] -hspike modeling of Plasma_ref
INFO [2022-04-07 22:24:27] validating infercnv_obj
INFO [2022-04-07 22:24:27] normalizing counts matrix by depth
INFO [2022-04-07 22:24:27] Using specified normalization factor: 2962.000000
INFO [2022-04-07 22:24:28] 

	STEP 04: log transformation of data

INFO [2022-04-07 22:24:28] transforming log2xplus1()
INFO [2022-04-07 22:24:28] -mirroring for hspike
INFO [2022-04-07 22:24:28] transforming log2xplus1()
INFO [2022-04-07 22:24:30] 

	STEP 08: removing average of reference data (before smoothing)

INFO [2022-04-07 22:24:30] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 22:24:30] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 22:24:33] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 22:25:43] -mirroring for hspike
INFO [2022-04-07 22:25:43] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 22:25:43] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 22:25:46] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 22:25:49] 

	STEP 09: apply max centered expression threshold: 3

INFO [2022-04-07 22:25:49] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 22:25:49] -mirroring for hspike
INFO [2022-04-07 22:25:49] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 22:25:52] 

	STEP 10: Smoothing data per cell by chromosome

INFO [2022-04-07 22:25:52] smooth_by_chromosome: chr: chr1
INFO [2022-04-07 22:25:52] smooth_by_chromosome: chr: chr2
INFO [2022-04-07 22:25:52] smooth_by_chromosome: chr: chr3
INFO [2022-04-07 22:25:53] smooth_by_chromosome: chr: chr4
INFO [2022-04-07 22:25:53] smooth_by_chromosome: chr: chr5
INFO [2022-04-07 22:25:53] smooth_by_chromosome: chr: chr6
INFO [2022-04-07 22:25:53] smooth_by_chromosome: chr: chr7
INFO [2022-04-07 22:25:54] smooth_by_chromosome: chr: chr8
INFO [2022-04-07 22:25:54] smooth_by_chromosome: chr: chr9
INFO [2022-04-07 22:25:54] smooth_by_chromosome: chr: chr10
INFO [2022-04-07 22:25:55] smooth_by_chromosome: chr: chr11
INFO [2022-04-07 22:25:55] smooth_by_chromosome: chr: chr12
INFO [2022-04-07 22:25:55] smooth_by_chromosome: chr: chr13
INFO [2022-04-07 22:25:55] smooth_by_chromosome: chr: chr14
INFO [2022-04-07 22:25:56] smooth_by_chromosome: chr: chr15
INFO [2022-04-07 22:25:56] smooth_by_chromosome: chr: chr16
INFO [2022-04-07 22:25:56] smooth_by_chromosome: chr: chr17
INFO [2022-04-07 22:25:57] smooth_by_chromosome: chr: chr18
INFO [2022-04-07 22:25:57] smooth_by_chromosome: chr: chr19
INFO [2022-04-07 22:25:57] smooth_by_chromosome: chr: chr20
INFO [2022-04-07 22:25:57] smooth_by_chromosome: chr: chr21
INFO [2022-04-07 22:25:58] smooth_by_chromosome: chr: chr22
INFO [2022-04-07 22:25:58] -mirroring for hspike
INFO [2022-04-07 22:25:58] smooth_by_chromosome: chr: chrA
INFO [2022-04-07 22:25:58] smooth_by_chromosome: chr: chr_0
INFO [2022-04-07 22:25:58] smooth_by_chromosome: chr: chr_B
INFO [2022-04-07 22:25:58] smooth_by_chromosome: chr: chr_0pt5
INFO [2022-04-07 22:25:58] smooth_by_chromosome: chr: chr_C
INFO [2022-04-07 22:25:59] smooth_by_chromosome: chr: chr_1pt5
INFO [2022-04-07 22:25:59] smooth_by_chromosome: chr: chr_D
INFO [2022-04-07 22:25:59] smooth_by_chromosome: chr: chr_2pt0
INFO [2022-04-07 22:25:59] smooth_by_chromosome: chr: chr_E
INFO [2022-04-07 22:25:59] smooth_by_chromosome: chr: chr_3pt0
INFO [2022-04-07 22:25:59] smooth_by_chromosome: chr: chr_F
INFO [2022-04-07 22:26:03] 

	STEP 11: re-centering data across chromosome after smoothing

INFO [2022-04-07 22:26:03] ::center_smooth across chromosomes per cell
INFO [2022-04-07 22:26:04] -mirroring for hspike
INFO [2022-04-07 22:26:04] ::center_smooth across chromosomes per cell
INFO [2022-04-07 22:26:07] 

	STEP 12: removing average of reference data (after smoothing)

INFO [2022-04-07 22:26:07] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 22:26:07] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 22:26:10] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 22:26:10] -mirroring for hspike
INFO [2022-04-07 22:26:10] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 22:26:10] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 22:26:13] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 22:26:17] 

	STEP 14: invert log2(FC) to FC

INFO [2022-04-07 22:26:17] invert_log2(), computing 2^x
INFO [2022-04-07 22:26:17] -mirroring for hspike
INFO [2022-04-07 22:26:17] invert_log2(), computing 2^x
INFO [2022-04-07 22:26:22] 

	STEP 15: Clustering samples (not defining tumor subclusters)

INFO [2022-04-07 22:26:22] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 22:26:22] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 22:26:25] cut tree into: 1 groups
INFO [2022-04-07 22:26:25] -processing all_observations,all_observations_s1
INFO [2022-04-07 22:26:25] define_signif_tumor_subclusters(), tumor: Plasma_ref
INFO [2022-04-07 22:26:25] -mirroring for hspike
INFO [2022-04-07 22:26:25] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 22:26:25] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 22:26:25] cut tree into: 1 groups
INFO [2022-04-07 22:26:25] -processing all_observations,all_observations_s1
INFO [2022-04-07 22:26:25] define_signif_tumor_subclusters(), tumor: simnorm_cell_Plasma_ref
INFO [2022-04-07 22:26:25] cut tree into: 1 groups
INFO [2022-04-07 22:26:25] -processing simnorm_cell_Plasma_ref,simnorm_cell_Plasma_ref_s1
INFO [2022-04-07 22:26:34] 

	STEP 17: HMM-based CNV prediction

INFO [2022-04-07 22:26:34] predict_CNV_via_HMM_on_whole_tumor_samples
INFO [2022-04-07 22:26:36] -done predicting CNV based on initial tumor subclusters
INFO [2022-04-07 22:26:36] get_predicted_CNV_regions(consensus)
INFO [2022-04-07 22:26:36] -processing cell_group_name: Plasma_ref, size: 2
INFO [2022-04-07 22:26:45] -processing cell_group_name: Plasma, size: 301
INFO [2022-04-07 22:26:56] -writing cell clusters file: /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.1_0/17_HMM_predHMMi6.hmm_mode-samples.cell_groupings
INFO [2022-04-07 22:26:56] -writing cnv regions file: /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.1_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_regions.dat
INFO [2022-04-07 22:26:56] -writing per-gene cnv report: /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.1_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_genes.dat
INFO [2022-04-07 22:26:56] -writing gene ordering info: /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.1_0/17_HMM_predHMMi6.hmm_mode-samples.genes_used.dat
INFO [2022-04-07 22:26:59] ::plot_cnv:Start
INFO [2022-04-07 22:26:59] ::plot_cnv:Current data dimensions (r,c)=11500,303 Total=10519720 Min=1 Max=4.
INFO [2022-04-07 22:26:59] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:27:02] plot_cnv_observation:Start
INFO [2022-04-07 22:27:02] Observation data size: Cells= 301 Genes= 11500
INFO [2022-04-07 22:27:02] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:27:05] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:27:05] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:27:05] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:27:05] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:27:06] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:27:06] Quantiles of plotted data range: 1,3,3,3,4
INFO [2022-04-07 22:27:06] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.1_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.observations.txt
INFO [2022-04-07 22:27:09] plot_cnv_references:Start
INFO [2022-04-07 22:27:09] Reference data size: Cells= 2 Genes= 11500
INFO [2022-04-07 22:27:09] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:27:09] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:27:09] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:27:09] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 22:27:09] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.1_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.references.txt
INFO [2022-04-07 22:27:10] 

	STEP 18: Run Bayesian Network Model on HMM predicted CNVs

INFO [2022-04-07 22:27:11] Initializing new MCM InferCNV Object.
INFO [2022-04-07 22:27:11] validating infercnv_obj
INFO [2022-04-07 22:27:11] Total CNV's:  25
INFO [2022-04-07 22:27:11] Loading BUGS Model.
INFO [2022-04-07 22:27:11] Running Sampling Using Parallel with  30 Cores
INFO [2022-04-07 22:28:48] Obtaining probabilities post-sampling
INFO [2022-04-07 22:29:22] Gibbs sampling time:  2.18329354524612  Minutes
INFO [2022-04-07 22:29:27] ::plot_cnv:Start
INFO [2022-04-07 22:29:27] ::plot_cnv:Current data dimensions (r,c)=11500,303 Total=350038.258725831 Min=0 Max=0.912208742146234.
INFO [2022-04-07 22:29:27] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:29:27] plot_cnv_observation:Start
INFO [2022-04-07 22:29:27] Observation data size: Cells= 301 Genes= 11500
INFO [2022-04-07 22:29:27] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:29:29] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:29:29] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:29:29] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:29:29] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:29:30] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:29:30] Quantiles of plotted data range: 0,0,0,0,0.912208742146234
INFO [2022-04-07 22:29:30] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.1_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.observations.txt
INFO [2022-04-07 22:29:33] plot_cnv_references:Start
INFO [2022-04-07 22:29:33] Reference data size: Cells= 2 Genes= 11500
INFO [2022-04-07 22:29:33] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:29:33] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:29:33] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:29:33] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 22:29:33] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.1_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.references.txt
INFO [2022-04-07 22:29:38] 

	STEP 19: Filter HMM predicted CNVs based on the Bayesian Network Model results and BayesMaxPNormal

INFO [2022-04-07 22:29:38] Attempting to removing CNV(s) with a probability of being normal above  0.5
INFO [2022-04-07 22:29:38] Removing  0  CNV(s) identified by the HMM.
INFO [2022-04-07 22:29:38] Reassigning CNVs based on state probabilities.
INFO [2022-04-07 22:29:38] Changing the following CNV's states assigned by the HMM to the following based on the CNV's state probabilities.
 chr1-region_26 : 2  (P= 0.134180194765864 ) ->  1 (P= 0.51391910057158 )
chr6-region_42 : 2  (P= 0.325663967552456 ) ->  3 (P= 0.338603711444865 )
chr20-region_86 : 4  (P= 0.404133359291699 ) ->  3 (P= 0.435444361141971 )
INFO [2022-04-07 22:29:38] Creating Plots for CNV and cell Probabilities.
INFO [2022-04-07 22:29:51] ::plot_cnv:Start
INFO [2022-04-07 22:29:51] ::plot_cnv:Current data dimensions (r,c)=11500,303 Total=350038.258725831 Min=0 Max=0.912208742146234.
INFO [2022-04-07 22:29:51] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:29:52] plot_cnv_observation:Start
INFO [2022-04-07 22:29:52] Observation data size: Cells= 301 Genes= 11500
INFO [2022-04-07 22:29:52] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:29:54] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:29:54] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:29:54] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:29:54] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:29:55] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:29:55] Quantiles of plotted data range: 0,0,0,0,0.912208742146234
INFO [2022-04-07 22:29:55] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.1_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.observations.txt
INFO [2022-04-07 22:29:57] plot_cnv_references:Start
INFO [2022-04-07 22:29:57] Reference data size: Cells= 2 Genes= 11500
INFO [2022-04-07 22:29:57] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:29:57] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:29:57] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:29:57] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 22:29:57] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.1_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.references.txt
INFO [2022-04-07 22:30:01] ::plot_cnv:Start
INFO [2022-04-07 22:30:01] ::plot_cnv:Current data dimensions (r,c)=11500,303 Total=10502864 Min=1 Max=4.
INFO [2022-04-07 22:30:01] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:30:04] plot_cnv_observation:Start
INFO [2022-04-07 22:30:04] Observation data size: Cells= 301 Genes= 11500
INFO [2022-04-07 22:30:04] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:30:07] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:30:07] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:30:07] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:30:07] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:30:07] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:30:07] Quantiles of plotted data range: 1,3,3,3,4
INFO [2022-04-07 22:30:08] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.1_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.observations.txt
INFO [2022-04-07 22:30:11] plot_cnv_references:Start
INFO [2022-04-07 22:30:11] Reference data size: Cells= 2 Genes= 11500
INFO [2022-04-07 22:30:11] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:30:11] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:30:11] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:30:11] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 22:30:11] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.1_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.references.txt
INFO [2022-04-07 22:30:11] 

	STEP 20: Converting HMM-based CNV states to repr expr vals

INFO [2022-04-07 22:30:14] ::plot_cnv:Start
INFO [2022-04-07 22:30:14] ::plot_cnv:Current data dimensions (r,c)=11500,303 Total=3509182 Min=0 Max=1.5.
INFO [2022-04-07 22:30:14] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:30:17] plot_cnv_observation:Start
INFO [2022-04-07 22:30:17] Observation data size: Cells= 301 Genes= 11500
INFO [2022-04-07 22:30:17] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:30:20] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:30:20] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:30:20] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:30:20] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:30:21] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:30:21] Quantiles of plotted data range: 0,1,1,1,1.5
INFO [2022-04-07 22:30:21] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.1_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.observations.txt
INFO [2022-04-07 22:30:24] plot_cnv_references:Start
INFO [2022-04-07 22:30:24] Reference data size: Cells= 2 Genes= 11500
INFO [2022-04-07 22:30:24] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:30:24] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:30:24] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:30:24] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 22:30:24] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.1_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.references.txt
INFO [2022-04-07 22:30:24] 

	STEP 22: Denoising

INFO [2022-04-07 22:30:24] ::process_data:Remove noise, noise threshold defined via ref mean sd_amplifier:  1.5
INFO [2022-04-07 22:30:24] denoising using mean(normal) +- sd_amplifier * sd(normal) per gene per cell across all data
INFO [2022-04-07 22:30:24] :: **** clear_noise_via_ref_quantiles **** : removing noise between bounds:  1 - 1
INFO [2022-04-07 22:30:33] 

## Making the final infercnv heatmap ##
INFO [2022-04-07 22:30:34] ::plot_cnv:Start
INFO [2022-04-07 22:30:34] ::plot_cnv:Current data dimensions (r,c)=11500,303 Total=3485750.1331994 Min=0.765686057586267 Max=1.23003635660467.
INFO [2022-04-07 22:30:34] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:30:38] plot_cnv(): auto thresholding at: (0.918021 , 1.081979)
INFO [2022-04-07 22:30:38] plot_cnv_observation:Start
INFO [2022-04-07 22:30:38] Observation data size: Cells= 301 Genes= 11500
INFO [2022-04-07 22:30:38] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:30:41] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:30:41] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:30:41] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:30:41] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:30:42] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:30:42] Quantiles of plotted data range: 0.918020883378144,0.980376439281023,1,1.02027532273149,1.08197911662186
INFO [2022-04-07 22:30:42] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.1_0/infercnv.observations.txt
INFO [2022-04-07 22:30:45] plot_cnv_references:Start
INFO [2022-04-07 22:30:45] Reference data size: Cells= 2 Genes= 11500
INFO [2022-04-07 22:30:45] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:30:45] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:30:45] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:30:45] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 22:30:45] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.1_0/infercnv.references.txt
INFO [2022-04-07 22:30:46] Parsing gene order file: /home/tenggao/inferCNV/hg38_gene_order.txt
INFO [2022-04-07 22:30:46] Parsing cell annotations file: /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.3_0/59114_Relapse_1_annot.tsv
INFO [2022-04-07 22:30:46] ::order_reduce:Start.
INFO [2022-04-07 22:30:46] .order_reduce(): expr and order match.
INFO [2022-04-07 22:30:46] ::process_data:order_reduce:Reduction from positional data, new dimensions (r,c) = 21034,303 Total=179823163 Min=0 Max=6089512.
INFO [2022-04-07 22:30:46] num genes removed taking into account provided gene ordering list: 2169 = 10.3118760102691% removed.
INFO [2022-04-07 22:30:46] -filtering out cells < 100 or > Inf, removing 0 % of cells
INFO [2022-04-07 22:30:46] validating infercnv_obj
INFO [2022-04-07 22:30:46] ::process_data:Start
INFO [2022-04-07 22:30:46] 

	STEP 1: incoming data

INFO [2022-04-07 22:30:47] 

	STEP 02: Removing lowly expressed genes

INFO [2022-04-07 22:30:47] ::above_min_mean_expr_cutoff:Start
INFO [2022-04-07 22:30:47] Removing 4584 genes from matrix as below mean expr threshold: 0.1
INFO [2022-04-07 22:30:47] validating infercnv_obj
INFO [2022-04-07 22:30:47] There are 14281 genes and 303 cells remaining in the expr matrix.
INFO [2022-04-07 22:30:47] Removed 2542 genes having fewer than 3 min cells per gene = 17.7999 % genes removed here
INFO [2022-04-07 22:30:47] validating infercnv_obj
INFO [2022-04-07 22:30:47] 

	STEP 03: normalization by sequencing depth

INFO [2022-04-07 22:30:47] normalizing counts matrix by depth
INFO [2022-04-07 22:30:47] Computed total sum normalization factor as median libsize: 3201.000000
INFO [2022-04-07 22:30:47] Adding h-spike
INFO [2022-04-07 22:30:47] -hspike modeling of Plasma_ref
INFO [2022-04-07 22:32:25] validating infercnv_obj
INFO [2022-04-07 22:32:25] normalizing counts matrix by depth
INFO [2022-04-07 22:32:25] Using specified normalization factor: 3201.000000
INFO [2022-04-07 22:32:26] 

	STEP 04: log transformation of data

INFO [2022-04-07 22:32:26] transforming log2xplus1()
INFO [2022-04-07 22:32:26] -mirroring for hspike
INFO [2022-04-07 22:32:26] transforming log2xplus1()
INFO [2022-04-07 22:32:28] 

	STEP 08: removing average of reference data (before smoothing)

INFO [2022-04-07 22:32:28] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 22:32:28] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 22:32:31] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 22:33:43] -mirroring for hspike
INFO [2022-04-07 22:33:43] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 22:33:43] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 22:33:46] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 22:33:49] 

	STEP 09: apply max centered expression threshold: 3

INFO [2022-04-07 22:33:49] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 22:33:49] -mirroring for hspike
INFO [2022-04-07 22:33:49] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 22:33:52] 

	STEP 10: Smoothing data per cell by chromosome

INFO [2022-04-07 22:33:52] smooth_by_chromosome: chr: chr1
INFO [2022-04-07 22:33:52] smooth_by_chromosome: chr: chr2
INFO [2022-04-07 22:33:52] smooth_by_chromosome: chr: chr3
INFO [2022-04-07 22:33:53] smooth_by_chromosome: chr: chr4
INFO [2022-04-07 22:33:53] smooth_by_chromosome: chr: chr5
INFO [2022-04-07 22:33:53] smooth_by_chromosome: chr: chr6
INFO [2022-04-07 22:33:54] smooth_by_chromosome: chr: chr7
INFO [2022-04-07 22:33:54] smooth_by_chromosome: chr: chr8
INFO [2022-04-07 22:33:54] smooth_by_chromosome: chr: chr9
INFO [2022-04-07 22:33:54] smooth_by_chromosome: chr: chr10
INFO [2022-04-07 22:33:55] smooth_by_chromosome: chr: chr11
INFO [2022-04-07 22:33:55] smooth_by_chromosome: chr: chr12
INFO [2022-04-07 22:33:55] smooth_by_chromosome: chr: chr13
INFO [2022-04-07 22:33:56] smooth_by_chromosome: chr: chr14
INFO [2022-04-07 22:33:56] smooth_by_chromosome: chr: chr15
INFO [2022-04-07 22:33:56] smooth_by_chromosome: chr: chr16
INFO [2022-04-07 22:33:56] smooth_by_chromosome: chr: chr17
INFO [2022-04-07 22:33:57] smooth_by_chromosome: chr: chr18
INFO [2022-04-07 22:33:57] smooth_by_chromosome: chr: chr19
INFO [2022-04-07 22:33:57] smooth_by_chromosome: chr: chr20
INFO [2022-04-07 22:33:57] smooth_by_chromosome: chr: chr21
INFO [2022-04-07 22:33:58] smooth_by_chromosome: chr: chr22
INFO [2022-04-07 22:33:58] -mirroring for hspike
INFO [2022-04-07 22:33:58] smooth_by_chromosome: chr: chrA
INFO [2022-04-07 22:33:58] smooth_by_chromosome: chr: chr_0
INFO [2022-04-07 22:33:58] smooth_by_chromosome: chr: chr_B
INFO [2022-04-07 22:33:58] smooth_by_chromosome: chr: chr_0pt5
INFO [2022-04-07 22:33:59] smooth_by_chromosome: chr: chr_C
INFO [2022-04-07 22:33:59] smooth_by_chromosome: chr: chr_1pt5
INFO [2022-04-07 22:33:59] smooth_by_chromosome: chr: chr_D
INFO [2022-04-07 22:33:59] smooth_by_chromosome: chr: chr_2pt0
INFO [2022-04-07 22:33:59] smooth_by_chromosome: chr: chr_E
INFO [2022-04-07 22:33:59] smooth_by_chromosome: chr: chr_3pt0
INFO [2022-04-07 22:34:00] smooth_by_chromosome: chr: chr_F
INFO [2022-04-07 22:34:04] 

	STEP 11: re-centering data across chromosome after smoothing

INFO [2022-04-07 22:34:04] ::center_smooth across chromosomes per cell
INFO [2022-04-07 22:34:04] -mirroring for hspike
INFO [2022-04-07 22:34:04] ::center_smooth across chromosomes per cell
INFO [2022-04-07 22:34:08] 

	STEP 12: removing average of reference data (after smoothing)

INFO [2022-04-07 22:34:08] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 22:34:08] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 22:34:10] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 22:34:11] -mirroring for hspike
INFO [2022-04-07 22:34:11] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 22:34:11] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 22:34:14] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 22:34:18] 

	STEP 14: invert log2(FC) to FC

INFO [2022-04-07 22:34:18] invert_log2(), computing 2^x
INFO [2022-04-07 22:34:18] -mirroring for hspike
INFO [2022-04-07 22:34:18] invert_log2(), computing 2^x
INFO [2022-04-07 22:34:23] 

	STEP 15: Clustering samples (not defining tumor subclusters)

INFO [2022-04-07 22:34:23] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 22:34:23] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 22:34:26] cut tree into: 1 groups
INFO [2022-04-07 22:34:26] -processing all_observations,all_observations_s1
INFO [2022-04-07 22:34:26] define_signif_tumor_subclusters(), tumor: Plasma_ref
INFO [2022-04-07 22:34:26] -mirroring for hspike
INFO [2022-04-07 22:34:26] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 22:34:26] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 22:34:26] cut tree into: 1 groups
INFO [2022-04-07 22:34:26] -processing all_observations,all_observations_s1
INFO [2022-04-07 22:34:26] define_signif_tumor_subclusters(), tumor: simnorm_cell_Plasma_ref
INFO [2022-04-07 22:34:26] cut tree into: 1 groups
INFO [2022-04-07 22:34:26] -processing simnorm_cell_Plasma_ref,simnorm_cell_Plasma_ref_s1
INFO [2022-04-07 22:34:35] 

	STEP 17: HMM-based CNV prediction

INFO [2022-04-07 22:34:35] predict_CNV_via_HMM_on_whole_tumor_samples
INFO [2022-04-07 22:34:37] -done predicting CNV based on initial tumor subclusters
INFO [2022-04-07 22:34:37] get_predicted_CNV_regions(consensus)
INFO [2022-04-07 22:34:37] -processing cell_group_name: Plasma_ref, size: 2
INFO [2022-04-07 22:34:46] -processing cell_group_name: Plasma, size: 301
INFO [2022-04-07 22:34:58] -writing cell clusters file: /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.3_0/17_HMM_predHMMi6.hmm_mode-samples.cell_groupings
INFO [2022-04-07 22:34:58] -writing cnv regions file: /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.3_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_regions.dat
INFO [2022-04-07 22:34:58] -writing per-gene cnv report: /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.3_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_genes.dat
INFO [2022-04-07 22:34:58] -writing gene ordering info: /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.3_0/17_HMM_predHMMi6.hmm_mode-samples.genes_used.dat
INFO [2022-04-07 22:35:01] ::plot_cnv:Start
INFO [2022-04-07 22:35:01] ::plot_cnv:Current data dimensions (r,c)=11739,303 Total=10504298 Min=1 Max=4.
INFO [2022-04-07 22:35:01] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:35:04] plot_cnv_observation:Start
INFO [2022-04-07 22:35:04] Observation data size: Cells= 301 Genes= 11739
INFO [2022-04-07 22:35:04] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:35:07] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:35:07] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:35:07] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:35:07] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:35:07] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:35:07] Quantiles of plotted data range: 1,3,3,3,4
INFO [2022-04-07 22:35:08] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.3_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.observations.txt
INFO [2022-04-07 22:35:11] plot_cnv_references:Start
INFO [2022-04-07 22:35:11] Reference data size: Cells= 2 Genes= 11739
INFO [2022-04-07 22:35:11] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:35:11] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:35:11] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:35:11] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 22:35:11] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.3_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.references.txt
INFO [2022-04-07 22:35:11] 

	STEP 18: Run Bayesian Network Model on HMM predicted CNVs

INFO [2022-04-07 22:35:13] Initializing new MCM InferCNV Object.
INFO [2022-04-07 22:35:13] validating infercnv_obj
INFO [2022-04-07 22:35:13] Total CNV's:  21
INFO [2022-04-07 22:35:13] Loading BUGS Model.
INFO [2022-04-07 22:35:13] Running Sampling Using Parallel with  30 Cores
INFO [2022-04-07 22:36:43] Obtaining probabilities post-sampling
INFO [2022-04-07 22:37:11] Gibbs sampling time:  1.97761718034744  Minutes
INFO [2022-04-07 22:37:16] ::plot_cnv:Start
INFO [2022-04-07 22:37:16] ::plot_cnv:Current data dimensions (r,c)=11739,303 Total=295164.836247429 Min=0 Max=0.914941974287826.
INFO [2022-04-07 22:37:16] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:37:16] plot_cnv_observation:Start
INFO [2022-04-07 22:37:16] Observation data size: Cells= 301 Genes= 11739
INFO [2022-04-07 22:37:16] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:37:19] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:37:19] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:37:19] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:37:19] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:37:19] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:37:19] Quantiles of plotted data range: 0,0,0,0,0.914941974287826
INFO [2022-04-07 22:37:20] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.3_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.observations.txt
INFO [2022-04-07 22:37:22] plot_cnv_references:Start
INFO [2022-04-07 22:37:22] Reference data size: Cells= 2 Genes= 11739
INFO [2022-04-07 22:37:22] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:37:22] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:37:22] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:37:22] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 22:37:22] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.3_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.references.txt
INFO [2022-04-07 22:37:27] 

	STEP 19: Filter HMM predicted CNVs based on the Bayesian Network Model results and BayesMaxPNormal

INFO [2022-04-07 22:37:27] Attempting to removing CNV(s) with a probability of being normal above  0.5
INFO [2022-04-07 22:37:27] Removing  0  CNV(s) identified by the HMM.
INFO [2022-04-07 22:37:27] Reassigning CNVs based on state probabilities.
INFO [2022-04-07 22:37:27] Changing the following CNV's states assigned by the HMM to the following based on the CNV's state probabilities.
 chr1-region_26 : 2  (P= 0.106946929400149 ) ->  1 (P= 0.603108708030233 )
chr11-region_53 : 2  (P= 0.302890057885459 ) ->  1 (P= 0.320986408481986 )
INFO [2022-04-07 22:37:27] Creating Plots for CNV and cell Probabilities.
INFO [2022-04-07 22:37:38] ::plot_cnv:Start
INFO [2022-04-07 22:37:38] ::plot_cnv:Current data dimensions (r,c)=11739,303 Total=295164.836247429 Min=0 Max=0.914941974287826.
INFO [2022-04-07 22:37:39] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:37:39] plot_cnv_observation:Start
INFO [2022-04-07 22:37:39] Observation data size: Cells= 301 Genes= 11739
INFO [2022-04-07 22:37:39] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:37:41] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:37:41] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:37:41] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:37:41] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:37:42] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:37:42] Quantiles of plotted data range: 0,0,0,0,0.914941974287826
INFO [2022-04-07 22:37:42] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.3_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.observations.txt
INFO [2022-04-07 22:37:45] plot_cnv_references:Start
INFO [2022-04-07 22:37:45] Reference data size: Cells= 2 Genes= 11739
INFO [2022-04-07 22:37:45] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:37:45] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:37:45] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:37:45] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 22:37:45] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.3_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.references.txt
INFO [2022-04-07 22:37:48] ::plot_cnv:Start
INFO [2022-04-07 22:37:48] ::plot_cnv:Current data dimensions (r,c)=11739,303 Total=10475101 Min=1 Max=4.
INFO [2022-04-07 22:37:48] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:37:51] plot_cnv_observation:Start
INFO [2022-04-07 22:37:51] Observation data size: Cells= 301 Genes= 11739
INFO [2022-04-07 22:37:51] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:37:54] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:37:54] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:37:54] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:37:54] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:37:55] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:37:55] Quantiles of plotted data range: 1,3,3,3,4
INFO [2022-04-07 22:37:55] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.3_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.observations.txt
INFO [2022-04-07 22:37:58] plot_cnv_references:Start
INFO [2022-04-07 22:37:58] Reference data size: Cells= 2 Genes= 11739
INFO [2022-04-07 22:37:58] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:37:58] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:37:58] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:37:58] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 22:37:58] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.3_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.references.txt
INFO [2022-04-07 22:37:58] 

	STEP 20: Converting HMM-based CNV states to repr expr vals

INFO [2022-04-07 22:38:01] ::plot_cnv:Start
INFO [2022-04-07 22:38:01] ::plot_cnv:Current data dimensions (r,c)=11739,303 Total=3459092 Min=0 Max=1.5.
INFO [2022-04-07 22:38:01] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:38:05] plot_cnv_observation:Start
INFO [2022-04-07 22:38:05] Observation data size: Cells= 301 Genes= 11739
INFO [2022-04-07 22:38:05] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:38:08] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:38:08] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:38:08] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:38:08] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:38:08] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:38:08] Quantiles of plotted data range: 0,1,1,1,1.5
INFO [2022-04-07 22:38:08] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.3_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.observations.txt
INFO [2022-04-07 22:38:11] plot_cnv_references:Start
INFO [2022-04-07 22:38:11] Reference data size: Cells= 2 Genes= 11739
INFO [2022-04-07 22:38:11] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:38:11] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:38:11] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:38:11] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 22:38:11] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.3_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.references.txt
INFO [2022-04-07 22:38:12] 

	STEP 22: Denoising

INFO [2022-04-07 22:38:12] ::process_data:Remove noise, noise threshold defined via ref mean sd_amplifier:  1.5
INFO [2022-04-07 22:38:12] denoising using mean(normal) +- sd_amplifier * sd(normal) per gene per cell across all data
INFO [2022-04-07 22:38:12] :: **** clear_noise_via_ref_quantiles **** : removing noise between bounds:  1 - 1
INFO [2022-04-07 22:38:21] 

## Making the final infercnv heatmap ##
INFO [2022-04-07 22:38:22] ::plot_cnv:Start
INFO [2022-04-07 22:38:22] ::plot_cnv:Current data dimensions (r,c)=11739,303 Total=3558387.83790639 Min=0.758152003973857 Max=1.23841647008598.
INFO [2022-04-07 22:38:22] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:38:25] plot_cnv(): auto thresholding at: (0.908593 , 1.091407)
INFO [2022-04-07 22:38:25] plot_cnv_observation:Start
INFO [2022-04-07 22:38:25] Observation data size: Cells= 301 Genes= 11739
INFO [2022-04-07 22:38:25] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:38:29] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:38:29] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:38:29] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:38:29] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:38:29] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:38:29] Quantiles of plotted data range: 0.908592931852752,0.978869707855517,1,1.02186567952419,1.09140706814725
INFO [2022-04-07 22:38:30] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.3_0/infercnv.observations.txt
INFO [2022-04-07 22:38:33] plot_cnv_references:Start
INFO [2022-04-07 22:38:33] Reference data size: Cells= 2 Genes= 11739
INFO [2022-04-07 22:38:33] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:38:33] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:38:33] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:38:33] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 22:38:33] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.3_0/infercnv.references.txt
INFO [2022-04-07 22:38:34] Parsing gene order file: /home/tenggao/inferCNV/hg38_gene_order.txt
INFO [2022-04-07 22:38:34] Parsing cell annotations file: /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.5_0/59114_Relapse_1_annot.tsv
INFO [2022-04-07 22:38:34] ::order_reduce:Start.
INFO [2022-04-07 22:38:34] .order_reduce(): expr and order match.
INFO [2022-04-07 22:38:34] ::process_data:order_reduce:Reduction from positional data, new dimensions (r,c) = 21034,304 Total=180079867 Min=0 Max=6089512.
INFO [2022-04-07 22:38:34] num genes removed taking into account provided gene ordering list: 2169 = 10.3118760102691% removed.
INFO [2022-04-07 22:38:34] -filtering out cells < 100 or > Inf, removing 0 % of cells
INFO [2022-04-07 22:38:34] validating infercnv_obj
INFO [2022-04-07 22:38:34] ::process_data:Start
INFO [2022-04-07 22:38:34] 

	STEP 1: incoming data

INFO [2022-04-07 22:38:34] 

	STEP 02: Removing lowly expressed genes

INFO [2022-04-07 22:38:34] ::above_min_mean_expr_cutoff:Start
INFO [2022-04-07 22:38:34] Removing 4567 genes from matrix as below mean expr threshold: 0.1
INFO [2022-04-07 22:38:34] validating infercnv_obj
INFO [2022-04-07 22:38:34] There are 14298 genes and 304 cells remaining in the expr matrix.
INFO [2022-04-07 22:38:35] Removed 2449 genes having fewer than 3 min cells per gene = 17.1283 % genes removed here
INFO [2022-04-07 22:38:35] validating infercnv_obj
INFO [2022-04-07 22:38:35] 

	STEP 03: normalization by sequencing depth

INFO [2022-04-07 22:38:35] normalizing counts matrix by depth
INFO [2022-04-07 22:38:35] Computed total sum normalization factor as median libsize: 3468.500000
INFO [2022-04-07 22:38:35] Adding h-spike
INFO [2022-04-07 22:38:35] -hspike modeling of Plasma_ref
INFO [2022-04-07 22:40:14] validating infercnv_obj
INFO [2022-04-07 22:40:14] normalizing counts matrix by depth
INFO [2022-04-07 22:40:14] Using specified normalization factor: 3468.500000
INFO [2022-04-07 22:40:15] 

	STEP 04: log transformation of data

INFO [2022-04-07 22:40:15] transforming log2xplus1()
INFO [2022-04-07 22:40:15] -mirroring for hspike
INFO [2022-04-07 22:40:15] transforming log2xplus1()
INFO [2022-04-07 22:40:17] 

	STEP 08: removing average of reference data (before smoothing)

INFO [2022-04-07 22:40:17] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 22:40:17] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 22:40:20] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 22:41:33] -mirroring for hspike
INFO [2022-04-07 22:41:33] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 22:41:33] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 22:41:36] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 22:41:40] 

	STEP 09: apply max centered expression threshold: 3

INFO [2022-04-07 22:41:40] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 22:41:40] -mirroring for hspike
INFO [2022-04-07 22:41:40] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 22:41:43] 

	STEP 10: Smoothing data per cell by chromosome

INFO [2022-04-07 22:41:43] smooth_by_chromosome: chr: chr1
INFO [2022-04-07 22:41:43] smooth_by_chromosome: chr: chr2
INFO [2022-04-07 22:41:43] smooth_by_chromosome: chr: chr3
INFO [2022-04-07 22:41:44] smooth_by_chromosome: chr: chr4
INFO [2022-04-07 22:41:44] smooth_by_chromosome: chr: chr5
INFO [2022-04-07 22:41:44] smooth_by_chromosome: chr: chr6
INFO [2022-04-07 22:41:44] smooth_by_chromosome: chr: chr7
INFO [2022-04-07 22:41:45] smooth_by_chromosome: chr: chr8
INFO [2022-04-07 22:41:45] smooth_by_chromosome: chr: chr9
INFO [2022-04-07 22:41:45] smooth_by_chromosome: chr: chr10
INFO [2022-04-07 22:41:46] smooth_by_chromosome: chr: chr11
INFO [2022-04-07 22:41:46] smooth_by_chromosome: chr: chr12
INFO [2022-04-07 22:41:46] smooth_by_chromosome: chr: chr13
INFO [2022-04-07 22:41:46] smooth_by_chromosome: chr: chr14
INFO [2022-04-07 22:41:47] smooth_by_chromosome: chr: chr15
INFO [2022-04-07 22:41:47] smooth_by_chromosome: chr: chr16
INFO [2022-04-07 22:41:47] smooth_by_chromosome: chr: chr17
INFO [2022-04-07 22:41:48] smooth_by_chromosome: chr: chr18
INFO [2022-04-07 22:41:48] smooth_by_chromosome: chr: chr19
INFO [2022-04-07 22:41:48] smooth_by_chromosome: chr: chr20
INFO [2022-04-07 22:41:48] smooth_by_chromosome: chr: chr21
INFO [2022-04-07 22:41:49] smooth_by_chromosome: chr: chr22
INFO [2022-04-07 22:41:49] -mirroring for hspike
INFO [2022-04-07 22:41:49] smooth_by_chromosome: chr: chrA
INFO [2022-04-07 22:41:49] smooth_by_chromosome: chr: chr_0
INFO [2022-04-07 22:41:49] smooth_by_chromosome: chr: chr_B
INFO [2022-04-07 22:41:49] smooth_by_chromosome: chr: chr_0pt5
INFO [2022-04-07 22:41:49] smooth_by_chromosome: chr: chr_C
INFO [2022-04-07 22:41:50] smooth_by_chromosome: chr: chr_1pt5
INFO [2022-04-07 22:41:50] smooth_by_chromosome: chr: chr_D
INFO [2022-04-07 22:41:50] smooth_by_chromosome: chr: chr_2pt0
INFO [2022-04-07 22:41:50] smooth_by_chromosome: chr: chr_E
INFO [2022-04-07 22:41:50] smooth_by_chromosome: chr: chr_3pt0
INFO [2022-04-07 22:41:50] smooth_by_chromosome: chr: chr_F
INFO [2022-04-07 22:41:55] 

	STEP 11: re-centering data across chromosome after smoothing

INFO [2022-04-07 22:41:55] ::center_smooth across chromosomes per cell
INFO [2022-04-07 22:41:55] -mirroring for hspike
INFO [2022-04-07 22:41:55] ::center_smooth across chromosomes per cell
INFO [2022-04-07 22:41:59] 

	STEP 12: removing average of reference data (after smoothing)

INFO [2022-04-07 22:41:59] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 22:41:59] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 22:42:01] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 22:42:02] -mirroring for hspike
INFO [2022-04-07 22:42:02] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 22:42:02] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 22:42:05] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 22:42:09] 

	STEP 14: invert log2(FC) to FC

INFO [2022-04-07 22:42:09] invert_log2(), computing 2^x
INFO [2022-04-07 22:42:09] -mirroring for hspike
INFO [2022-04-07 22:42:09] invert_log2(), computing 2^x
INFO [2022-04-07 22:42:14] 

	STEP 15: Clustering samples (not defining tumor subclusters)

INFO [2022-04-07 22:42:14] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 22:42:14] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 22:42:16] cut tree into: 1 groups
INFO [2022-04-07 22:42:16] -processing all_observations,all_observations_s1
INFO [2022-04-07 22:42:16] define_signif_tumor_subclusters(), tumor: Plasma_ref
INFO [2022-04-07 22:42:16] -mirroring for hspike
INFO [2022-04-07 22:42:16] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 22:42:16] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 22:42:16] cut tree into: 1 groups
INFO [2022-04-07 22:42:16] -processing all_observations,all_observations_s1
INFO [2022-04-07 22:42:16] define_signif_tumor_subclusters(), tumor: simnorm_cell_Plasma_ref
INFO [2022-04-07 22:42:17] cut tree into: 1 groups
INFO [2022-04-07 22:42:17] -processing simnorm_cell_Plasma_ref,simnorm_cell_Plasma_ref_s1
INFO [2022-04-07 22:42:26] 

	STEP 17: HMM-based CNV prediction

INFO [2022-04-07 22:42:26] predict_CNV_via_HMM_on_whole_tumor_samples
INFO [2022-04-07 22:42:28] -done predicting CNV based on initial tumor subclusters
INFO [2022-04-07 22:42:28] get_predicted_CNV_regions(consensus)
INFO [2022-04-07 22:42:28] -processing cell_group_name: Plasma_ref, size: 2
INFO [2022-04-07 22:42:36] -processing cell_group_name: Plasma, size: 302
INFO [2022-04-07 22:42:48] -writing cell clusters file: /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.5_0/17_HMM_predHMMi6.hmm_mode-samples.cell_groupings
INFO [2022-04-07 22:42:48] -writing cnv regions file: /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.5_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_regions.dat
INFO [2022-04-07 22:42:48] -writing per-gene cnv report: /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.5_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_genes.dat
INFO [2022-04-07 22:42:48] -writing gene ordering info: /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.5_0/17_HMM_predHMMi6.hmm_mode-samples.genes_used.dat
INFO [2022-04-07 22:42:51] ::plot_cnv:Start
INFO [2022-04-07 22:42:51] ::plot_cnv:Current data dimensions (r,c)=11849,304 Total=10982958 Min=1 Max=4.
INFO [2022-04-07 22:42:51] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:42:55] plot_cnv_observation:Start
INFO [2022-04-07 22:42:55] Observation data size: Cells= 302 Genes= 11849
INFO [2022-04-07 22:42:55] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:42:58] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:42:58] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:42:58] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:42:58] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:42:58] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:42:58] Quantiles of plotted data range: 1,3,3,3,4
INFO [2022-04-07 22:42:59] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.5_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.observations.txt
INFO [2022-04-07 22:43:02] plot_cnv_references:Start
INFO [2022-04-07 22:43:02] Reference data size: Cells= 2 Genes= 11849
INFO [2022-04-07 22:43:02] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:43:02] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:43:02] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:43:02] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 22:43:02] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.5_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.references.txt
INFO [2022-04-07 22:43:02] 

	STEP 18: Run Bayesian Network Model on HMM predicted CNVs

INFO [2022-04-07 22:43:04] Initializing new MCM InferCNV Object.
INFO [2022-04-07 22:43:04] validating infercnv_obj
INFO [2022-04-07 22:43:04] Total CNV's:  37
INFO [2022-04-07 22:43:04] Loading BUGS Model.
INFO [2022-04-07 22:43:04] Running Sampling Using Parallel with  30 Cores
INFO [2022-04-07 22:45:03] Obtaining probabilities post-sampling
INFO [2022-04-07 22:45:53] Gibbs sampling time:  2.83053430318832  Minutes
INFO [2022-04-07 22:45:59] ::plot_cnv:Start
INFO [2022-04-07 22:45:59] ::plot_cnv:Current data dimensions (r,c)=11849,304 Total=504073.326198595 Min=0 Max=0.941331240740551.
INFO [2022-04-07 22:45:59] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:45:59] plot_cnv_observation:Start
INFO [2022-04-07 22:45:59] Observation data size: Cells= 302 Genes= 11849
INFO [2022-04-07 22:45:59] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:46:02] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:46:02] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:46:02] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:46:02] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:46:02] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:46:02] Quantiles of plotted data range: 0,0,0,0,0.941331240740551
INFO [2022-04-07 22:46:02] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.5_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.observations.txt
INFO [2022-04-07 22:46:05] plot_cnv_references:Start
INFO [2022-04-07 22:46:05] Reference data size: Cells= 2 Genes= 11849
INFO [2022-04-07 22:46:05] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:46:05] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:46:05] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:46:05] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 22:46:05] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.5_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.references.txt
INFO [2022-04-07 22:46:11] 

	STEP 19: Filter HMM predicted CNVs based on the Bayesian Network Model results and BayesMaxPNormal

INFO [2022-04-07 22:46:11] Attempting to removing CNV(s) with a probability of being normal above  0.5
INFO [2022-04-07 22:46:11] Removing  0  CNV(s) identified by the HMM.
INFO [2022-04-07 22:46:11] Reassigning CNVs based on state probabilities.
INFO [2022-04-07 22:46:11] Changing the following CNV's states assigned by the HMM to the following based on the CNV's state probabilities.
 chr1-region_26 : 2  (P= 0.275468117687751 ) ->  1 (P= 0.461427201953971 )
chr3-region_35 : 4  (P= 0.439418581821206 ) ->  3 (P= 0.459885771994313 )
chr6-region_44 : 2  (P= 0.367038387497266 ) ->  1 (P= 0.389168157249926 )
chr9-region_52 : 4  (P= 0.434032029133699 ) ->  3 (P= 0.447524371824149 )
chr9-region_54 : 4  (P= 0.331480122759725 ) ->  3 (P= 0.397160084695091 )
chr11-region_61 : 2  (P= 0.292543863482356 ) ->  1 (P= 0.304560584800853 )
chr15-region_74 : 4  (P= 0.376374262859651 ) ->  3 (P= 0.386497360962566 )
chr21-region_100 : 4  (P= 0.39176275224009 ) ->  3 (P= 0.418447582937191 )
INFO [2022-04-07 22:46:11] Creating Plots for CNV and cell Probabilities.
INFO [2022-04-07 22:46:31] ::plot_cnv:Start
INFO [2022-04-07 22:46:31] ::plot_cnv:Current data dimensions (r,c)=11849,304 Total=504073.326198595 Min=0 Max=0.941331240740551.
INFO [2022-04-07 22:46:31] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:46:31] plot_cnv_observation:Start
INFO [2022-04-07 22:46:31] Observation data size: Cells= 302 Genes= 11849
INFO [2022-04-07 22:46:31] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:46:34] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:46:34] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:46:34] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:46:34] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:46:34] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:46:34] Quantiles of plotted data range: 0,0,0,0,0.941331240740551
INFO [2022-04-07 22:46:34] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.5_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.observations.txt
INFO [2022-04-07 22:46:37] plot_cnv_references:Start
INFO [2022-04-07 22:46:37] Reference data size: Cells= 2 Genes= 11849
INFO [2022-04-07 22:46:37] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:46:37] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:46:37] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:46:37] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 22:46:37] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.5_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.references.txt
INFO [2022-04-07 22:46:41] ::plot_cnv:Start
INFO [2022-04-07 22:46:41] ::plot_cnv:Current data dimensions (r,c)=11849,304 Total=10863668 Min=1 Max=4.
INFO [2022-04-07 22:46:41] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:46:44] plot_cnv_observation:Start
INFO [2022-04-07 22:46:44] Observation data size: Cells= 302 Genes= 11849
INFO [2022-04-07 22:46:44] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:46:47] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:46:47] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:46:47] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:46:47] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:46:47] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:46:47] Quantiles of plotted data range: 1,3,3,3,4
INFO [2022-04-07 22:46:48] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.5_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.observations.txt
INFO [2022-04-07 22:46:51] plot_cnv_references:Start
INFO [2022-04-07 22:46:51] Reference data size: Cells= 2 Genes= 11849
INFO [2022-04-07 22:46:51] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:46:51] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:46:51] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:46:51] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 22:46:51] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.5_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.references.txt
INFO [2022-04-07 22:46:51] 

	STEP 20: Converting HMM-based CNV states to repr expr vals

INFO [2022-04-07 22:46:54] ::plot_cnv:Start
INFO [2022-04-07 22:46:54] ::plot_cnv:Current data dimensions (r,c)=11849,304 Total=3630786 Min=0 Max=1.5.
INFO [2022-04-07 22:46:54] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:46:57] plot_cnv_observation:Start
INFO [2022-04-07 22:46:57] Observation data size: Cells= 302 Genes= 11849
INFO [2022-04-07 22:46:57] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:47:00] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:47:00] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:47:00] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:47:00] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:47:01] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:47:01] Quantiles of plotted data range: 0,1,1,1,1.5
INFO [2022-04-07 22:47:01] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.5_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.observations.txt
INFO [2022-04-07 22:47:04] plot_cnv_references:Start
INFO [2022-04-07 22:47:04] Reference data size: Cells= 2 Genes= 11849
INFO [2022-04-07 22:47:04] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:47:04] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:47:04] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:47:04] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 22:47:04] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.5_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.references.txt
INFO [2022-04-07 22:47:04] 

	STEP 22: Denoising

INFO [2022-04-07 22:47:04] ::process_data:Remove noise, noise threshold defined via ref mean sd_amplifier:  1.5
INFO [2022-04-07 22:47:04] denoising using mean(normal) +- sd_amplifier * sd(normal) per gene per cell across all data
INFO [2022-04-07 22:47:05] :: **** clear_noise_via_ref_quantiles **** : removing noise between bounds:  1 - 1
INFO [2022-04-07 22:47:14] 

## Making the final infercnv heatmap ##
INFO [2022-04-07 22:47:15] ::plot_cnv:Start
INFO [2022-04-07 22:47:15] ::plot_cnv:Current data dimensions (r,c)=11849,304 Total=3603430.61370118 Min=0.744469731529301 Max=1.28955775962212.
INFO [2022-04-07 22:47:15] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:47:18] plot_cnv(): auto thresholding at: (0.896480 , 1.103520)
INFO [2022-04-07 22:47:18] plot_cnv_observation:Start
INFO [2022-04-07 22:47:18] Observation data size: Cells= 302 Genes= 11849
INFO [2022-04-07 22:47:18] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:47:22] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:47:22] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:47:22] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:47:22] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:47:22] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:47:22] Quantiles of plotted data range: 0.896480012008436,0.977217394195155,1,1.02377585226438,1.10351998799156
INFO [2022-04-07 22:47:23] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.5_0/infercnv.observations.txt
INFO [2022-04-07 22:47:26] plot_cnv_references:Start
INFO [2022-04-07 22:47:26] Reference data size: Cells= 2 Genes= 11849
INFO [2022-04-07 22:47:26] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:47:26] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:47:26] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:47:26] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 22:47:26] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.5_0/infercnv.references.txt
INFO [2022-04-07 22:47:27] Parsing gene order file: /home/tenggao/inferCNV/hg38_gene_order.txt
INFO [2022-04-07 22:47:27] Parsing cell annotations file: /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.7_0/59114_Relapse_1_annot.tsv
INFO [2022-04-07 22:47:27] ::order_reduce:Start.
INFO [2022-04-07 22:47:27] .order_reduce(): expr and order match.
INFO [2022-04-07 22:47:27] ::process_data:order_reduce:Reduction from positional data, new dimensions (r,c) = 21034,303 Total=180494355 Min=0 Max=6089512.
INFO [2022-04-07 22:47:27] num genes removed taking into account provided gene ordering list: 2169 = 10.3118760102691% removed.
INFO [2022-04-07 22:47:27] -filtering out cells < 100 or > Inf, removing 0 % of cells
INFO [2022-04-07 22:47:27] validating infercnv_obj
INFO [2022-04-07 22:47:27] ::process_data:Start
INFO [2022-04-07 22:47:27] 

	STEP 1: incoming data

INFO [2022-04-07 22:47:27] 

	STEP 02: Removing lowly expressed genes

INFO [2022-04-07 22:47:27] ::above_min_mean_expr_cutoff:Start
INFO [2022-04-07 22:47:28] Removing 4545 genes from matrix as below mean expr threshold: 0.1
INFO [2022-04-07 22:47:28] validating infercnv_obj
INFO [2022-04-07 22:47:28] There are 14320 genes and 303 cells remaining in the expr matrix.
INFO [2022-04-07 22:47:28] Removed 2276 genes having fewer than 3 min cells per gene = 15.8939 % genes removed here
INFO [2022-04-07 22:47:28] validating infercnv_obj
INFO [2022-04-07 22:47:28] 

	STEP 03: normalization by sequencing depth

INFO [2022-04-07 22:47:28] normalizing counts matrix by depth
INFO [2022-04-07 22:47:29] Computed total sum normalization factor as median libsize: 4440.000000
INFO [2022-04-07 22:47:29] Adding h-spike
INFO [2022-04-07 22:47:29] -hspike modeling of Plasma_ref
INFO [2022-04-07 22:49:09] validating infercnv_obj
INFO [2022-04-07 22:49:09] normalizing counts matrix by depth
INFO [2022-04-07 22:49:09] Using specified normalization factor: 4440.000000
INFO [2022-04-07 22:49:10] 

	STEP 04: log transformation of data

INFO [2022-04-07 22:49:10] transforming log2xplus1()
INFO [2022-04-07 22:49:11] -mirroring for hspike
INFO [2022-04-07 22:49:11] transforming log2xplus1()
INFO [2022-04-07 22:49:13] 

	STEP 08: removing average of reference data (before smoothing)

INFO [2022-04-07 22:49:13] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 22:49:13] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 22:49:15] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 22:50:34] -mirroring for hspike
INFO [2022-04-07 22:50:34] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 22:50:34] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 22:50:37] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 22:50:41] 

	STEP 09: apply max centered expression threshold: 3

INFO [2022-04-07 22:50:41] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 22:50:41] -mirroring for hspike
INFO [2022-04-07 22:50:41] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 22:50:44] 

	STEP 10: Smoothing data per cell by chromosome

INFO [2022-04-07 22:50:44] smooth_by_chromosome: chr: chr1
INFO [2022-04-07 22:50:44] smooth_by_chromosome: chr: chr2
INFO [2022-04-07 22:50:44] smooth_by_chromosome: chr: chr3
INFO [2022-04-07 22:50:44] smooth_by_chromosome: chr: chr4
INFO [2022-04-07 22:50:45] smooth_by_chromosome: chr: chr5
INFO [2022-04-07 22:50:45] smooth_by_chromosome: chr: chr6
INFO [2022-04-07 22:50:45] smooth_by_chromosome: chr: chr7
INFO [2022-04-07 22:50:46] smooth_by_chromosome: chr: chr8
INFO [2022-04-07 22:50:46] smooth_by_chromosome: chr: chr9
INFO [2022-04-07 22:50:46] smooth_by_chromosome: chr: chr10
INFO [2022-04-07 22:50:46] smooth_by_chromosome: chr: chr11
INFO [2022-04-07 22:50:47] smooth_by_chromosome: chr: chr12
INFO [2022-04-07 22:50:47] smooth_by_chromosome: chr: chr13
INFO [2022-04-07 22:50:47] smooth_by_chromosome: chr: chr14
INFO [2022-04-07 22:50:48] smooth_by_chromosome: chr: chr15
INFO [2022-04-07 22:50:48] smooth_by_chromosome: chr: chr16
INFO [2022-04-07 22:50:48] smooth_by_chromosome: chr: chr17
INFO [2022-04-07 22:50:49] smooth_by_chromosome: chr: chr18
INFO [2022-04-07 22:50:49] smooth_by_chromosome: chr: chr19
INFO [2022-04-07 22:50:49] smooth_by_chromosome: chr: chr20
INFO [2022-04-07 22:50:49] smooth_by_chromosome: chr: chr21
INFO [2022-04-07 22:50:50] smooth_by_chromosome: chr: chr22
INFO [2022-04-07 22:50:50] -mirroring for hspike
INFO [2022-04-07 22:50:50] smooth_by_chromosome: chr: chrA
INFO [2022-04-07 22:50:50] smooth_by_chromosome: chr: chr_0
INFO [2022-04-07 22:50:50] smooth_by_chromosome: chr: chr_B
INFO [2022-04-07 22:50:50] smooth_by_chromosome: chr: chr_0pt5
INFO [2022-04-07 22:50:50] smooth_by_chromosome: chr: chr_C
INFO [2022-04-07 22:50:51] smooth_by_chromosome: chr: chr_1pt5
INFO [2022-04-07 22:50:51] smooth_by_chromosome: chr: chr_D
INFO [2022-04-07 22:50:51] smooth_by_chromosome: chr: chr_2pt0
INFO [2022-04-07 22:50:51] smooth_by_chromosome: chr: chr_E
INFO [2022-04-07 22:50:51] smooth_by_chromosome: chr: chr_3pt0
INFO [2022-04-07 22:50:51] smooth_by_chromosome: chr: chr_F
INFO [2022-04-07 22:50:56] 

	STEP 11: re-centering data across chromosome after smoothing

INFO [2022-04-07 22:50:56] ::center_smooth across chromosomes per cell
INFO [2022-04-07 22:50:56] -mirroring for hspike
INFO [2022-04-07 22:50:56] ::center_smooth across chromosomes per cell
INFO [2022-04-07 22:51:00] 

	STEP 12: removing average of reference data (after smoothing)

INFO [2022-04-07 22:51:00] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 22:51:00] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 22:51:03] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 22:51:03] -mirroring for hspike
INFO [2022-04-07 22:51:03] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 22:51:03] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 22:51:06] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 22:51:10] 

	STEP 14: invert log2(FC) to FC

INFO [2022-04-07 22:51:10] invert_log2(), computing 2^x
INFO [2022-04-07 22:51:10] -mirroring for hspike
INFO [2022-04-07 22:51:10] invert_log2(), computing 2^x
INFO [2022-04-07 22:51:15] 

	STEP 15: Clustering samples (not defining tumor subclusters)

INFO [2022-04-07 22:51:15] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 22:51:15] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 22:51:18] cut tree into: 1 groups
INFO [2022-04-07 22:51:18] -processing all_observations,all_observations_s1
INFO [2022-04-07 22:51:18] define_signif_tumor_subclusters(), tumor: Plasma_ref
INFO [2022-04-07 22:51:18] -mirroring for hspike
INFO [2022-04-07 22:51:18] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 22:51:18] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 22:51:18] cut tree into: 1 groups
INFO [2022-04-07 22:51:18] -processing all_observations,all_observations_s1
INFO [2022-04-07 22:51:18] define_signif_tumor_subclusters(), tumor: simnorm_cell_Plasma_ref
INFO [2022-04-07 22:51:18] cut tree into: 1 groups
INFO [2022-04-07 22:51:18] -processing simnorm_cell_Plasma_ref,simnorm_cell_Plasma_ref_s1
INFO [2022-04-07 22:51:28] 

	STEP 17: HMM-based CNV prediction

INFO [2022-04-07 22:51:28] predict_CNV_via_HMM_on_whole_tumor_samples
INFO [2022-04-07 22:51:29] -done predicting CNV based on initial tumor subclusters
INFO [2022-04-07 22:51:29] get_predicted_CNV_regions(consensus)
INFO [2022-04-07 22:51:29] -processing cell_group_name: Plasma_ref, size: 2
INFO [2022-04-07 22:51:39] -processing cell_group_name: Plasma, size: 301
INFO [2022-04-07 22:51:50] -writing cell clusters file: /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.7_0/17_HMM_predHMMi6.hmm_mode-samples.cell_groupings
INFO [2022-04-07 22:51:50] -writing cnv regions file: /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.7_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_regions.dat
INFO [2022-04-07 22:51:50] -writing per-gene cnv report: /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.7_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_genes.dat
INFO [2022-04-07 22:51:50] -writing gene ordering info: /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.7_0/17_HMM_predHMMi6.hmm_mode-samples.genes_used.dat
INFO [2022-04-07 22:51:54] ::plot_cnv:Start
INFO [2022-04-07 22:51:54] ::plot_cnv:Current data dimensions (r,c)=12044,303 Total=11235150 Min=1 Max=4.
INFO [2022-04-07 22:51:54] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:51:57] plot_cnv_observation:Start
INFO [2022-04-07 22:51:57] Observation data size: Cells= 301 Genes= 12044
INFO [2022-04-07 22:51:57] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:52:00] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:52:00] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:52:00] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:52:00] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:52:01] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:52:01] Quantiles of plotted data range: 1,3,3,3,4
INFO [2022-04-07 22:52:01] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.7_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.observations.txt
INFO [2022-04-07 22:52:04] plot_cnv_references:Start
INFO [2022-04-07 22:52:04] Reference data size: Cells= 2 Genes= 12044
INFO [2022-04-07 22:52:04] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:52:04] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:52:04] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:52:04] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 22:52:04] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.7_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.references.txt
INFO [2022-04-07 22:52:04] 

	STEP 18: Run Bayesian Network Model on HMM predicted CNVs

INFO [2022-04-07 22:52:06] Initializing new MCM InferCNV Object.
INFO [2022-04-07 22:52:06] validating infercnv_obj
INFO [2022-04-07 22:52:06] Total CNV's:  36
INFO [2022-04-07 22:52:06] Loading BUGS Model.
INFO [2022-04-07 22:52:06] Running Sampling Using Parallel with  30 Cores
INFO [2022-04-07 22:55:12] Obtaining probabilities post-sampling
INFO [2022-04-07 22:56:01] Gibbs sampling time:  3.92260388533274  Minutes
INFO [2022-04-07 22:56:06] ::plot_cnv:Start
INFO [2022-04-07 22:56:06] ::plot_cnv:Current data dimensions (r,c)=12044,303 Total=620162.958610734 Min=0 Max=0.955429522642105.
INFO [2022-04-07 22:56:06] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:56:06] plot_cnv_observation:Start
INFO [2022-04-07 22:56:06] Observation data size: Cells= 301 Genes= 12044
INFO [2022-04-07 22:56:07] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:56:09] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:56:09] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:56:09] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:56:09] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:56:10] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:56:10] Quantiles of plotted data range: 0,0,0,0,0.955429522642105
INFO [2022-04-07 22:56:10] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.7_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.observations.txt
INFO [2022-04-07 22:56:13] plot_cnv_references:Start
INFO [2022-04-07 22:56:13] Reference data size: Cells= 2 Genes= 12044
INFO [2022-04-07 22:56:13] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:56:13] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:56:13] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:56:13] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 22:56:13] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.7_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.references.txt
INFO [2022-04-07 22:56:18] 

	STEP 19: Filter HMM predicted CNVs based on the Bayesian Network Model results and BayesMaxPNormal

INFO [2022-04-07 22:56:18] Attempting to removing CNV(s) with a probability of being normal above  0.5
INFO [2022-04-07 22:56:18] Removing  0  CNV(s) identified by the HMM.
INFO [2022-04-07 22:56:18] Reassigning CNVs based on state probabilities.
INFO [2022-04-07 22:56:18] Changing the following CNV's states assigned by the HMM to the following based on the CNV's state probabilities.
 chr17-region_85 : 4  (P= 0.41841878709019 ) ->  3 (P= 0.430463615957881 )
INFO [2022-04-07 22:56:18] Creating Plots for CNV and cell Probabilities.
INFO [2022-04-07 22:56:38] ::plot_cnv:Start
INFO [2022-04-07 22:56:38] ::plot_cnv:Current data dimensions (r,c)=12044,303 Total=620162.958610734 Min=0 Max=0.955429522642105.
INFO [2022-04-07 22:56:38] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:56:38] plot_cnv_observation:Start
INFO [2022-04-07 22:56:38] Observation data size: Cells= 301 Genes= 12044
INFO [2022-04-07 22:56:39] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:56:41] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:56:41] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:56:41] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:56:41] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:56:42] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:56:42] Quantiles of plotted data range: 0,0,0,0,0.955429522642105
INFO [2022-04-07 22:56:42] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.7_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.observations.txt
INFO [2022-04-07 22:56:45] plot_cnv_references:Start
INFO [2022-04-07 22:56:45] Reference data size: Cells= 2 Genes= 12044
INFO [2022-04-07 22:56:45] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:56:45] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:56:45] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:56:45] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 22:56:45] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.7_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.references.txt
INFO [2022-04-07 22:56:48] ::plot_cnv:Start
INFO [2022-04-07 22:56:48] ::plot_cnv:Current data dimensions (r,c)=12044,303 Total=11220702 Min=1 Max=4.
INFO [2022-04-07 22:56:48] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:56:52] plot_cnv_observation:Start
INFO [2022-04-07 22:56:52] Observation data size: Cells= 301 Genes= 12044
INFO [2022-04-07 22:56:52] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:56:55] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:56:55] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:56:55] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:56:55] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:56:56] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:56:56] Quantiles of plotted data range: 1,3,3,3,4
INFO [2022-04-07 22:56:56] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.7_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.observations.txt
INFO [2022-04-07 22:56:59] plot_cnv_references:Start
INFO [2022-04-07 22:56:59] Reference data size: Cells= 2 Genes= 12044
INFO [2022-04-07 22:56:59] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:56:59] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:56:59] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:56:59] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 22:56:59] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.7_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.references.txt
INFO [2022-04-07 22:57:00] 

	STEP 20: Converting HMM-based CNV states to repr expr vals

INFO [2022-04-07 22:57:03] ::plot_cnv:Start
INFO [2022-04-07 22:57:03] ::plot_cnv:Current data dimensions (r,c)=12044,303 Total=3785685 Min=0 Max=1.5.
INFO [2022-04-07 22:57:03] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:57:06] plot_cnv_observation:Start
INFO [2022-04-07 22:57:06] Observation data size: Cells= 301 Genes= 12044
INFO [2022-04-07 22:57:06] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:57:09] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:57:09] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:57:09] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:57:09] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:57:10] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:57:10] Quantiles of plotted data range: 0,1,1,1,1.5
INFO [2022-04-07 22:57:10] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.7_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.observations.txt
INFO [2022-04-07 22:57:13] plot_cnv_references:Start
INFO [2022-04-07 22:57:13] Reference data size: Cells= 2 Genes= 12044
INFO [2022-04-07 22:57:13] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:57:13] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:57:13] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:57:13] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 22:57:13] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.7_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.references.txt
INFO [2022-04-07 22:57:13] 

	STEP 22: Denoising

INFO [2022-04-07 22:57:13] ::process_data:Remove noise, noise threshold defined via ref mean sd_amplifier:  1.5
INFO [2022-04-07 22:57:13] denoising using mean(normal) +- sd_amplifier * sd(normal) per gene per cell across all data
INFO [2022-04-07 22:57:13] :: **** clear_noise_via_ref_quantiles **** : removing noise between bounds:  1 - 1
INFO [2022-04-07 22:57:23] 

## Making the final infercnv heatmap ##
INFO [2022-04-07 22:57:23] ::plot_cnv:Start
INFO [2022-04-07 22:57:23] ::plot_cnv:Current data dimensions (r,c)=12044,303 Total=3651646.5345713 Min=0.720255615460512 Max=1.31791216025826.
INFO [2022-04-07 22:57:23] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 22:57:27] plot_cnv(): auto thresholding at: (0.879935 , 1.120065)
INFO [2022-04-07 22:57:27] plot_cnv_observation:Start
INFO [2022-04-07 22:57:27] Observation data size: Cells= 301 Genes= 12044
INFO [2022-04-07 22:57:27] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 22:57:31] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 22:57:31] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 22:57:31] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 22:57:31] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 22:57:31] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:57:31] Quantiles of plotted data range: 0.87993458499601,0.973249019009539,1,1.0282665666715,1.12006541500399
INFO [2022-04-07 22:57:31] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.7_0/infercnv.observations.txt
INFO [2022-04-07 22:57:35] plot_cnv_references:Start
INFO [2022-04-07 22:57:35] Reference data size: Cells= 2 Genes= 12044
INFO [2022-04-07 22:57:35] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 22:57:35] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 22:57:35] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 22:57:35] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 22:57:35] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.7_0/infercnv.references.txt
INFO [2022-04-07 22:57:35] Parsing gene order file: /home/tenggao/inferCNV/hg38_gene_order.txt
INFO [2022-04-07 22:57:36] Parsing cell annotations file: /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.9_0/59114_Relapse_1_annot.tsv
INFO [2022-04-07 22:57:36] ::order_reduce:Start.
INFO [2022-04-07 22:57:36] .order_reduce(): expr and order match.
INFO [2022-04-07 22:57:36] ::process_data:order_reduce:Reduction from positional data, new dimensions (r,c) = 21034,303 Total=180809911 Min=0 Max=6089512.
INFO [2022-04-07 22:57:36] num genes removed taking into account provided gene ordering list: 2169 = 10.3118760102691% removed.
INFO [2022-04-07 22:57:36] -filtering out cells < 100 or > Inf, removing 0 % of cells
INFO [2022-04-07 22:57:36] validating infercnv_obj
INFO [2022-04-07 22:57:36] ::process_data:Start
INFO [2022-04-07 22:57:36] 

	STEP 1: incoming data

INFO [2022-04-07 22:57:36] 

	STEP 02: Removing lowly expressed genes

INFO [2022-04-07 22:57:36] ::above_min_mean_expr_cutoff:Start
INFO [2022-04-07 22:57:36] Removing 4525 genes from matrix as below mean expr threshold: 0.1
INFO [2022-04-07 22:57:36] validating infercnv_obj
INFO [2022-04-07 22:57:36] There are 14340 genes and 303 cells remaining in the expr matrix.
INFO [2022-04-07 22:57:37] Removed 2276 genes having fewer than 3 min cells per gene = 15.8717 % genes removed here
INFO [2022-04-07 22:57:37] validating infercnv_obj
INFO [2022-04-07 22:57:37] 

	STEP 03: normalization by sequencing depth

INFO [2022-04-07 22:57:37] normalizing counts matrix by depth
INFO [2022-04-07 22:57:37] Computed total sum normalization factor as median libsize: 6003.000000
INFO [2022-04-07 22:57:37] Adding h-spike
INFO [2022-04-07 22:57:38] -hspike modeling of Plasma_ref
INFO [2022-04-07 22:59:18] validating infercnv_obj
INFO [2022-04-07 22:59:18] normalizing counts matrix by depth
INFO [2022-04-07 22:59:18] Using specified normalization factor: 6003.000000
INFO [2022-04-07 22:59:19] 

	STEP 04: log transformation of data

INFO [2022-04-07 22:59:19] transforming log2xplus1()
INFO [2022-04-07 22:59:19] -mirroring for hspike
INFO [2022-04-07 22:59:19] transforming log2xplus1()
INFO [2022-04-07 22:59:21] 

	STEP 08: removing average of reference data (before smoothing)

INFO [2022-04-07 22:59:21] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 22:59:21] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 22:59:24] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 23:00:42] -mirroring for hspike
INFO [2022-04-07 23:00:42] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 23:00:42] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 23:00:45] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 23:00:49] 

	STEP 09: apply max centered expression threshold: 3

INFO [2022-04-07 23:00:49] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 23:00:49] -mirroring for hspike
INFO [2022-04-07 23:00:49] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 23:00:52] 

	STEP 10: Smoothing data per cell by chromosome

INFO [2022-04-07 23:00:52] smooth_by_chromosome: chr: chr1
INFO [2022-04-07 23:00:53] smooth_by_chromosome: chr: chr2
INFO [2022-04-07 23:00:53] smooth_by_chromosome: chr: chr3
INFO [2022-04-07 23:00:53] smooth_by_chromosome: chr: chr4
INFO [2022-04-07 23:00:53] smooth_by_chromosome: chr: chr5
INFO [2022-04-07 23:00:54] smooth_by_chromosome: chr: chr6
INFO [2022-04-07 23:00:54] smooth_by_chromosome: chr: chr7
INFO [2022-04-07 23:00:54] smooth_by_chromosome: chr: chr8
INFO [2022-04-07 23:00:55] smooth_by_chromosome: chr: chr9
INFO [2022-04-07 23:00:55] smooth_by_chromosome: chr: chr10
INFO [2022-04-07 23:00:55] smooth_by_chromosome: chr: chr11
INFO [2022-04-07 23:00:55] smooth_by_chromosome: chr: chr12
INFO [2022-04-07 23:00:56] smooth_by_chromosome: chr: chr13
INFO [2022-04-07 23:00:56] smooth_by_chromosome: chr: chr14
INFO [2022-04-07 23:00:56] smooth_by_chromosome: chr: chr15
INFO [2022-04-07 23:00:57] smooth_by_chromosome: chr: chr16
INFO [2022-04-07 23:00:57] smooth_by_chromosome: chr: chr17
INFO [2022-04-07 23:00:57] smooth_by_chromosome: chr: chr18
INFO [2022-04-07 23:00:57] smooth_by_chromosome: chr: chr19
INFO [2022-04-07 23:00:58] smooth_by_chromosome: chr: chr20
INFO [2022-04-07 23:00:58] smooth_by_chromosome: chr: chr21
INFO [2022-04-07 23:00:58] smooth_by_chromosome: chr: chr22
INFO [2022-04-07 23:00:58] -mirroring for hspike
INFO [2022-04-07 23:00:58] smooth_by_chromosome: chr: chrA
INFO [2022-04-07 23:00:59] smooth_by_chromosome: chr: chr_0
INFO [2022-04-07 23:00:59] smooth_by_chromosome: chr: chr_B
INFO [2022-04-07 23:00:59] smooth_by_chromosome: chr: chr_0pt5
INFO [2022-04-07 23:00:59] smooth_by_chromosome: chr: chr_C
INFO [2022-04-07 23:00:59] smooth_by_chromosome: chr: chr_1pt5
INFO [2022-04-07 23:00:59] smooth_by_chromosome: chr: chr_D
INFO [2022-04-07 23:01:00] smooth_by_chromosome: chr: chr_2pt0
INFO [2022-04-07 23:01:00] smooth_by_chromosome: chr: chr_E
INFO [2022-04-07 23:01:00] smooth_by_chromosome: chr: chr_3pt0
INFO [2022-04-07 23:01:00] smooth_by_chromosome: chr: chr_F
INFO [2022-04-07 23:01:05] 

	STEP 11: re-centering data across chromosome after smoothing

INFO [2022-04-07 23:01:05] ::center_smooth across chromosomes per cell
INFO [2022-04-07 23:01:05] -mirroring for hspike
INFO [2022-04-07 23:01:05] ::center_smooth across chromosomes per cell
INFO [2022-04-07 23:01:09] 

	STEP 12: removing average of reference data (after smoothing)

INFO [2022-04-07 23:01:09] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 23:01:09] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 23:01:12] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 23:01:13] -mirroring for hspike
INFO [2022-04-07 23:01:13] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 23:01:13] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 23:01:15] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 23:01:20] 

	STEP 14: invert log2(FC) to FC

INFO [2022-04-07 23:01:20] invert_log2(), computing 2^x
INFO [2022-04-07 23:01:20] -mirroring for hspike
INFO [2022-04-07 23:01:20] invert_log2(), computing 2^x
INFO [2022-04-07 23:01:25] 

	STEP 15: Clustering samples (not defining tumor subclusters)

INFO [2022-04-07 23:01:25] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 23:01:25] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 23:01:27] cut tree into: 1 groups
INFO [2022-04-07 23:01:27] -processing all_observations,all_observations_s1
INFO [2022-04-07 23:01:27] define_signif_tumor_subclusters(), tumor: Plasma_ref
INFO [2022-04-07 23:01:27] -mirroring for hspike
INFO [2022-04-07 23:01:27] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 23:01:27] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 23:01:28] cut tree into: 1 groups
INFO [2022-04-07 23:01:28] -processing all_observations,all_observations_s1
INFO [2022-04-07 23:01:28] define_signif_tumor_subclusters(), tumor: simnorm_cell_Plasma_ref
INFO [2022-04-07 23:01:28] cut tree into: 1 groups
INFO [2022-04-07 23:01:28] -processing simnorm_cell_Plasma_ref,simnorm_cell_Plasma_ref_s1
INFO [2022-04-07 23:01:37] 

	STEP 17: HMM-based CNV prediction

INFO [2022-04-07 23:01:37] predict_CNV_via_HMM_on_whole_tumor_samples
INFO [2022-04-07 23:01:39] -done predicting CNV based on initial tumor subclusters
INFO [2022-04-07 23:01:39] get_predicted_CNV_regions(consensus)
INFO [2022-04-07 23:01:39] -processing cell_group_name: Plasma_ref, size: 2
INFO [2022-04-07 23:01:48] -processing cell_group_name: Plasma, size: 301
INFO [2022-04-07 23:01:59] -writing cell clusters file: /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.9_0/17_HMM_predHMMi6.hmm_mode-samples.cell_groupings
INFO [2022-04-07 23:01:59] -writing cnv regions file: /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.9_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_regions.dat
INFO [2022-04-07 23:01:59] -writing per-gene cnv report: /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.9_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_genes.dat
INFO [2022-04-07 23:01:59] -writing gene ordering info: /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.9_0/17_HMM_predHMMi6.hmm_mode-samples.genes_used.dat
INFO [2022-04-07 23:02:02] ::plot_cnv:Start
INFO [2022-04-07 23:02:02] ::plot_cnv:Current data dimensions (r,c)=12064,303 Total=11168147 Min=1 Max=5.
INFO [2022-04-07 23:02:02] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:02:06] plot_cnv_observation:Start
INFO [2022-04-07 23:02:06] Observation data size: Cells= 301 Genes= 12064
INFO [2022-04-07 23:02:06] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:02:09] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:02:09] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:02:09] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:02:09] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:02:09] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:02:09] Quantiles of plotted data range: 1,3,3,3,5
INFO [2022-04-07 23:02:10] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.9_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.observations.txt
INFO [2022-04-07 23:02:13] plot_cnv_references:Start
INFO [2022-04-07 23:02:13] Reference data size: Cells= 2 Genes= 12064
INFO [2022-04-07 23:02:13] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:02:13] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:02:13] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:02:13] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 23:02:13] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.9_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.references.txt
INFO [2022-04-07 23:02:13] 

	STEP 18: Run Bayesian Network Model on HMM predicted CNVs

INFO [2022-04-07 23:02:15] Initializing new MCM InferCNV Object.
INFO [2022-04-07 23:02:15] validating infercnv_obj
INFO [2022-04-07 23:02:15] Total CNV's:  41
INFO [2022-04-07 23:02:15] Loading BUGS Model.
INFO [2022-04-07 23:02:15] Running Sampling Using Parallel with  30 Cores
INFO [2022-04-07 23:07:18] Obtaining probabilities post-sampling
INFO [2022-04-07 23:08:14] Gibbs sampling time:  5.98905138969421  Minutes
INFO [2022-04-07 23:08:19] ::plot_cnv:Start
INFO [2022-04-07 23:08:19] ::plot_cnv:Current data dimensions (r,c)=12064,303 Total=760611.510399191 Min=0 Max=0.98047911343343.
INFO [2022-04-07 23:08:19] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:08:19] plot_cnv_observation:Start
INFO [2022-04-07 23:08:19] Observation data size: Cells= 301 Genes= 12064
INFO [2022-04-07 23:08:19] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:08:22] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:08:22] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:08:22] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:08:22] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:08:23] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:08:23] Quantiles of plotted data range: 0,0,0,0.656843861112529,0.98047911343343
INFO [2022-04-07 23:08:23] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.9_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.observations.txt
INFO [2022-04-07 23:08:26] plot_cnv_references:Start
INFO [2022-04-07 23:08:26] Reference data size: Cells= 2 Genes= 12064
INFO [2022-04-07 23:08:26] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:08:26] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:08:26] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:08:26] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 23:08:26] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.9_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.references.txt
INFO [2022-04-07 23:08:31] 

	STEP 19: Filter HMM predicted CNVs based on the Bayesian Network Model results and BayesMaxPNormal

INFO [2022-04-07 23:08:31] Attempting to removing CNV(s) with a probability of being normal above  0.5
INFO [2022-04-07 23:08:31] Removing  0  CNV(s) identified by the HMM.
INFO [2022-04-07 23:08:31] Reassigning CNVs based on state probabilities.
INFO [2022-04-07 23:08:31] Creating Plots for CNV and cell Probabilities.
INFO [2022-04-07 23:08:53] ::plot_cnv:Start
INFO [2022-04-07 23:08:53] ::plot_cnv:Current data dimensions (r,c)=12064,303 Total=760611.510399191 Min=0 Max=0.98047911343343.
INFO [2022-04-07 23:08:53] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:08:53] plot_cnv_observation:Start
INFO [2022-04-07 23:08:53] Observation data size: Cells= 301 Genes= 12064
INFO [2022-04-07 23:08:53] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:08:56] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:08:56] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:08:56] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:08:56] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:08:57] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:08:57] Quantiles of plotted data range: 0,0,0,0.656843861112529,0.98047911343343
INFO [2022-04-07 23:08:57] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.9_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.observations.txt
INFO [2022-04-07 23:09:00] plot_cnv_references:Start
INFO [2022-04-07 23:09:00] Reference data size: Cells= 2 Genes= 12064
INFO [2022-04-07 23:09:00] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:09:00] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:09:00] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:09:00] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 23:09:00] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.9_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.references.txt
INFO [2022-04-07 23:09:03] ::plot_cnv:Start
INFO [2022-04-07 23:09:03] ::plot_cnv:Current data dimensions (r,c)=12064,303 Total=11168147 Min=1 Max=5.
INFO [2022-04-07 23:09:03] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:09:07] plot_cnv_observation:Start
INFO [2022-04-07 23:09:07] Observation data size: Cells= 301 Genes= 12064
INFO [2022-04-07 23:09:07] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:09:10] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:09:10] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:09:10] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:09:10] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:09:10] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:09:10] Quantiles of plotted data range: 1,3,3,3,5
INFO [2022-04-07 23:09:11] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.9_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.observations.txt
INFO [2022-04-07 23:09:14] plot_cnv_references:Start
INFO [2022-04-07 23:09:14] Reference data size: Cells= 2 Genes= 12064
INFO [2022-04-07 23:09:14] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:09:14] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:09:14] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:09:14] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 23:09:14] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.9_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.references.txt
INFO [2022-04-07 23:09:14] 

	STEP 20: Converting HMM-based CNV states to repr expr vals

INFO [2022-04-07 23:09:17] ::plot_cnv:Start
INFO [2022-04-07 23:09:17] ::plot_cnv:Current data dimensions (r,c)=12064,303 Total=3756377.5 Min=0 Max=2.
INFO [2022-04-07 23:09:17] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:09:21] plot_cnv_observation:Start
INFO [2022-04-07 23:09:21] Observation data size: Cells= 301 Genes= 12064
INFO [2022-04-07 23:09:21] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:09:24] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:09:24] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:09:24] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:09:24] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:09:24] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:09:24] Quantiles of plotted data range: 0,1,1,1,2
INFO [2022-04-07 23:09:24] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.9_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.observations.txt
INFO [2022-04-07 23:09:28] plot_cnv_references:Start
INFO [2022-04-07 23:09:28] Reference data size: Cells= 2 Genes= 12064
INFO [2022-04-07 23:09:28] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:09:28] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:09:28] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:09:28] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 23:09:28] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.9_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.references.txt
INFO [2022-04-07 23:09:28] 

	STEP 22: Denoising

INFO [2022-04-07 23:09:28] ::process_data:Remove noise, noise threshold defined via ref mean sd_amplifier:  1.5
INFO [2022-04-07 23:09:28] denoising using mean(normal) +- sd_amplifier * sd(normal) per gene per cell across all data
INFO [2022-04-07 23:09:28] :: **** clear_noise_via_ref_quantiles **** : removing noise between bounds:  1 - 1
INFO [2022-04-07 23:09:37] 

## Making the final infercnv heatmap ##
INFO [2022-04-07 23:09:38] ::plot_cnv:Start
INFO [2022-04-07 23:09:38] ::plot_cnv:Current data dimensions (r,c)=12064,303 Total=3659662.240438 Min=0.688078622737277 Max=1.3590636886775.
INFO [2022-04-07 23:09:38] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:09:42] plot_cnv(): auto thresholding at: (0.859805 , 1.140195)
INFO [2022-04-07 23:09:42] plot_cnv_observation:Start
INFO [2022-04-07 23:09:42] Observation data size: Cells= 301 Genes= 12064
INFO [2022-04-07 23:09:42] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:09:45] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:09:45] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:09:45] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:09:45] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:09:46] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:09:46] Quantiles of plotted data range: 0.859804840282663,0.96784203975385,1,1.03433209964652,1.14019515971734
INFO [2022-04-07 23:09:46] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.9_0/infercnv.observations.txt
INFO [2022-04-07 23:09:50] plot_cnv_references:Start
INFO [2022-04-07 23:09:50] Reference data size: Cells= 2 Genes= 12064
INFO [2022-04-07 23:09:50] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:09:50] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:09:50] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:09:50] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 23:09:50] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/59114_Relapse_1_0.9_0/infercnv.references.txt
INFO [2022-04-07 23:09:50] Parsing gene order file: /home/tenggao/inferCNV/hg38_gene_order.txt
INFO [2022-04-07 23:09:50] Parsing cell annotations file: /home/tenggao/paper_data/infercnv_out/37692_Primary_0.1_0/37692_Primary_annot.tsv
INFO [2022-04-07 23:09:50] ::order_reduce:Start.
INFO [2022-04-07 23:09:50] .order_reduce(): expr and order match.
INFO [2022-04-07 23:09:50] ::process_data:order_reduce:Reduction from positional data, new dimensions (r,c) = 21034,216 Total=179117697 Min=0 Max=6089512.
INFO [2022-04-07 23:09:50] num genes removed taking into account provided gene ordering list: 2169 = 10.3118760102691% removed.
INFO [2022-04-07 23:09:50] -filtering out cells < 100 or > Inf, removing 0 % of cells
INFO [2022-04-07 23:09:50] validating infercnv_obj
INFO [2022-04-07 23:09:50] ::process_data:Start
INFO [2022-04-07 23:09:50] 

	STEP 1: incoming data

INFO [2022-04-07 23:09:50] 

	STEP 02: Removing lowly expressed genes

INFO [2022-04-07 23:09:50] ::above_min_mean_expr_cutoff:Start
INFO [2022-04-07 23:09:50] Removing 4324 genes from matrix as below mean expr threshold: 0.1
INFO [2022-04-07 23:09:51] validating infercnv_obj
INFO [2022-04-07 23:09:51] There are 14541 genes and 216 cells remaining in the expr matrix.
INFO [2022-04-07 23:09:51] Removed 3762 genes having fewer than 3 min cells per gene = 25.8717 % genes removed here
INFO [2022-04-07 23:09:51] validating infercnv_obj
INFO [2022-04-07 23:09:51] 

	STEP 03: normalization by sequencing depth

INFO [2022-04-07 23:09:51] normalizing counts matrix by depth
INFO [2022-04-07 23:09:51] Computed total sum normalization factor as median libsize: 2672.000000
INFO [2022-04-07 23:09:51] Adding h-spike
INFO [2022-04-07 23:09:51] -hspike modeling of Plasma_ref
INFO [2022-04-07 23:11:20] validating infercnv_obj
INFO [2022-04-07 23:11:20] normalizing counts matrix by depth
INFO [2022-04-07 23:11:20] Using specified normalization factor: 2672.000000
INFO [2022-04-07 23:11:21] 

	STEP 04: log transformation of data

INFO [2022-04-07 23:11:21] transforming log2xplus1()
INFO [2022-04-07 23:11:21] -mirroring for hspike
INFO [2022-04-07 23:11:21] transforming log2xplus1()
INFO [2022-04-07 23:11:22] 

	STEP 08: removing average of reference data (before smoothing)

INFO [2022-04-07 23:11:22] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 23:11:22] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 23:11:25] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 23:12:07] -mirroring for hspike
INFO [2022-04-07 23:12:07] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 23:12:07] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 23:12:10] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 23:12:12] 

	STEP 09: apply max centered expression threshold: 3

INFO [2022-04-07 23:12:12] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 23:12:12] -mirroring for hspike
INFO [2022-04-07 23:12:12] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 23:12:15] 

	STEP 10: Smoothing data per cell by chromosome

INFO [2022-04-07 23:12:15] smooth_by_chromosome: chr: chr1
INFO [2022-04-07 23:12:15] smooth_by_chromosome: chr: chr2
INFO [2022-04-07 23:12:15] smooth_by_chromosome: chr: chr3
INFO [2022-04-07 23:12:15] smooth_by_chromosome: chr: chr4
INFO [2022-04-07 23:12:15] smooth_by_chromosome: chr: chr5
INFO [2022-04-07 23:12:16] smooth_by_chromosome: chr: chr6
INFO [2022-04-07 23:12:16] smooth_by_chromosome: chr: chr7
INFO [2022-04-07 23:12:16] smooth_by_chromosome: chr: chr8
INFO [2022-04-07 23:12:16] smooth_by_chromosome: chr: chr9
INFO [2022-04-07 23:12:16] smooth_by_chromosome: chr: chr10
INFO [2022-04-07 23:12:17] smooth_by_chromosome: chr: chr11
INFO [2022-04-07 23:12:17] smooth_by_chromosome: chr: chr12
INFO [2022-04-07 23:12:17] smooth_by_chromosome: chr: chr13
INFO [2022-04-07 23:12:17] smooth_by_chromosome: chr: chr14
INFO [2022-04-07 23:12:17] smooth_by_chromosome: chr: chr15
INFO [2022-04-07 23:12:18] smooth_by_chromosome: chr: chr16
INFO [2022-04-07 23:12:18] smooth_by_chromosome: chr: chr17
INFO [2022-04-07 23:12:18] smooth_by_chromosome: chr: chr18
INFO [2022-04-07 23:12:18] smooth_by_chromosome: chr: chr19
INFO [2022-04-07 23:12:18] smooth_by_chromosome: chr: chr20
INFO [2022-04-07 23:12:19] smooth_by_chromosome: chr: chr21
INFO [2022-04-07 23:12:19] smooth_by_chromosome: chr: chr22
INFO [2022-04-07 23:12:19] -mirroring for hspike
INFO [2022-04-07 23:12:19] smooth_by_chromosome: chr: chrA
INFO [2022-04-07 23:12:19] smooth_by_chromosome: chr: chr_0
INFO [2022-04-07 23:12:19] smooth_by_chromosome: chr: chr_B
INFO [2022-04-07 23:12:19] smooth_by_chromosome: chr: chr_0pt5
INFO [2022-04-07 23:12:20] smooth_by_chromosome: chr: chr_C
INFO [2022-04-07 23:12:20] smooth_by_chromosome: chr: chr_1pt5
INFO [2022-04-07 23:12:20] smooth_by_chromosome: chr: chr_D
INFO [2022-04-07 23:12:20] smooth_by_chromosome: chr: chr_2pt0
INFO [2022-04-07 23:12:20] smooth_by_chromosome: chr: chr_E
INFO [2022-04-07 23:12:20] smooth_by_chromosome: chr: chr_3pt0
INFO [2022-04-07 23:12:21] smooth_by_chromosome: chr: chr_F
INFO [2022-04-07 23:12:24] 

	STEP 11: re-centering data across chromosome after smoothing

INFO [2022-04-07 23:12:24] ::center_smooth across chromosomes per cell
INFO [2022-04-07 23:12:24] -mirroring for hspike
INFO [2022-04-07 23:12:24] ::center_smooth across chromosomes per cell
INFO [2022-04-07 23:12:27] 

	STEP 12: removing average of reference data (after smoothing)

INFO [2022-04-07 23:12:27] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 23:12:27] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 23:12:29] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 23:12:30] -mirroring for hspike
INFO [2022-04-07 23:12:30] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 23:12:30] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 23:12:32] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 23:12:36] 

	STEP 14: invert log2(FC) to FC

INFO [2022-04-07 23:12:36] invert_log2(), computing 2^x
INFO [2022-04-07 23:12:36] -mirroring for hspike
INFO [2022-04-07 23:12:36] invert_log2(), computing 2^x
INFO [2022-04-07 23:12:40] 

	STEP 15: Clustering samples (not defining tumor subclusters)

INFO [2022-04-07 23:12:40] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 23:12:40] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 23:12:41] cut tree into: 1 groups
INFO [2022-04-07 23:12:41] -processing all_observations,all_observations_s1
INFO [2022-04-07 23:12:41] define_signif_tumor_subclusters(), tumor: Plasma_ref
INFO [2022-04-07 23:12:41] -mirroring for hspike
INFO [2022-04-07 23:12:41] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 23:12:41] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 23:12:41] cut tree into: 1 groups
INFO [2022-04-07 23:12:41] -processing all_observations,all_observations_s1
INFO [2022-04-07 23:12:41] define_signif_tumor_subclusters(), tumor: simnorm_cell_Plasma_ref
INFO [2022-04-07 23:12:41] cut tree into: 1 groups
INFO [2022-04-07 23:12:41] -processing simnorm_cell_Plasma_ref,simnorm_cell_Plasma_ref_s1
INFO [2022-04-07 23:12:48] 

	STEP 17: HMM-based CNV prediction

INFO [2022-04-07 23:12:48] predict_CNV_via_HMM_on_whole_tumor_samples
INFO [2022-04-07 23:12:50] -done predicting CNV based on initial tumor subclusters
INFO [2022-04-07 23:12:50] get_predicted_CNV_regions(consensus)
INFO [2022-04-07 23:12:50] -processing cell_group_name: Plasma_ref, size: 2
INFO [2022-04-07 23:12:58] -processing cell_group_name: Plasma, size: 214
INFO [2022-04-07 23:13:08] -writing cell clusters file: /home/tenggao/paper_data/infercnv_out/37692_Primary_0.1_0/17_HMM_predHMMi6.hmm_mode-samples.cell_groupings
INFO [2022-04-07 23:13:08] -writing cnv regions file: /home/tenggao/paper_data/infercnv_out/37692_Primary_0.1_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_regions.dat
INFO [2022-04-07 23:13:08] -writing per-gene cnv report: /home/tenggao/paper_data/infercnv_out/37692_Primary_0.1_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_genes.dat
INFO [2022-04-07 23:13:08] -writing gene ordering info: /home/tenggao/paper_data/infercnv_out/37692_Primary_0.1_0/17_HMM_predHMMi6.hmm_mode-samples.genes_used.dat
INFO [2022-04-07 23:13:11] ::plot_cnv:Start
INFO [2022-04-07 23:13:11] ::plot_cnv:Current data dimensions (r,c)=10779,216 Total=7162198 Min=1 Max=6.
INFO [2022-04-07 23:13:11] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:13:13] plot_cnv_observation:Start
INFO [2022-04-07 23:13:13] Observation data size: Cells= 214 Genes= 10779
INFO [2022-04-07 23:13:13] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:13:15] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:13:15] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:13:15] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:13:15] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:13:15] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:13:15] Quantiles of plotted data range: 1,3,3,3,6
INFO [2022-04-07 23:13:15] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.1_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.observations.txt
INFO [2022-04-07 23:13:18] plot_cnv_references:Start
INFO [2022-04-07 23:13:18] Reference data size: Cells= 2 Genes= 10779
INFO [2022-04-07 23:13:18] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:13:18] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:13:18] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:13:18] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 23:13:18] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.1_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.references.txt
INFO [2022-04-07 23:13:18] 

	STEP 18: Run Bayesian Network Model on HMM predicted CNVs

INFO [2022-04-07 23:13:19] Initializing new MCM InferCNV Object.
INFO [2022-04-07 23:13:19] validating infercnv_obj
INFO [2022-04-07 23:13:19] Total CNV's:  39
INFO [2022-04-07 23:13:19] Loading BUGS Model.
INFO [2022-04-07 23:13:19] Running Sampling Using Parallel with  30 Cores
INFO [2022-04-07 23:15:25] Obtaining probabilities post-sampling
INFO [2022-04-07 23:16:03] Gibbs sampling time:  2.73337229887644  Minutes
INFO [2022-04-07 23:16:07] ::plot_cnv:Start
INFO [2022-04-07 23:16:07] ::plot_cnv:Current data dimensions (r,c)=10779,216 Total=322238.777860768 Min=0 Max=0.995466339150442.
INFO [2022-04-07 23:16:07] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:16:08] plot_cnv_observation:Start
INFO [2022-04-07 23:16:08] Observation data size: Cells= 214 Genes= 10779
INFO [2022-04-07 23:16:08] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:16:09] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:16:09] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:16:09] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:16:09] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:16:10] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:16:10] Quantiles of plotted data range: 0,0,0,0,0.995466339150442
INFO [2022-04-07 23:16:10] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.1_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.observations.txt
INFO [2022-04-07 23:16:12] plot_cnv_references:Start
INFO [2022-04-07 23:16:12] Reference data size: Cells= 2 Genes= 10779
INFO [2022-04-07 23:16:12] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:16:12] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:16:12] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:16:12] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 23:16:12] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.1_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.references.txt
INFO [2022-04-07 23:16:16] 

	STEP 19: Filter HMM predicted CNVs based on the Bayesian Network Model results and BayesMaxPNormal

INFO [2022-04-07 23:16:16] Attempting to removing CNV(s) with a probability of being normal above  0.5
INFO [2022-04-07 23:16:16] Removing  0  CNV(s) identified by the HMM.
INFO [2022-04-07 23:16:16] Reassigning CNVs based on state probabilities.
INFO [2022-04-07 23:16:16] Changing the following CNV's states assigned by the HMM to the following based on the CNV's state probabilities.
 chr1-region_26 : 2  (P= 0.293473926204139 ) ->  1 (P= 0.45273752526267 )
chr1-region_32 : 4  (P= 0.459391998888596 ) ->  3 (P= 0.481471781062813 )
chr8-region_55 : 4  (P= 0.423775822526883 ) ->  3 (P= 0.428389424069092 )
INFO [2022-04-07 23:16:16] Creating Plots for CNV and cell Probabilities.
INFO [2022-04-07 23:16:35] ::plot_cnv:Start
INFO [2022-04-07 23:16:35] ::plot_cnv:Current data dimensions (r,c)=10779,216 Total=322238.777860768 Min=0 Max=0.995466339150442.
INFO [2022-04-07 23:16:35] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:16:35] plot_cnv_observation:Start
INFO [2022-04-07 23:16:35] Observation data size: Cells= 214 Genes= 10779
INFO [2022-04-07 23:16:35] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:16:36] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:16:36] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:16:37] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:16:37] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:16:37] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:16:37] Quantiles of plotted data range: 0,0,0,0,0.995466339150442
INFO [2022-04-07 23:16:37] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.1_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.observations.txt
INFO [2022-04-07 23:16:39] plot_cnv_references:Start
INFO [2022-04-07 23:16:39] Reference data size: Cells= 2 Genes= 10779
INFO [2022-04-07 23:16:39] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:16:39] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:16:39] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:16:39] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 23:16:39] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.1_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.references.txt
INFO [2022-04-07 23:16:42] ::plot_cnv:Start
INFO [2022-04-07 23:16:42] ::plot_cnv:Current data dimensions (r,c)=10779,216 Total=7145934 Min=1 Max=6.
INFO [2022-04-07 23:16:42] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:16:44] plot_cnv_observation:Start
INFO [2022-04-07 23:16:44] Observation data size: Cells= 214 Genes= 10779
INFO [2022-04-07 23:16:44] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:16:46] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:16:46] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:16:46] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:16:46] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:16:46] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:16:46] Quantiles of plotted data range: 1,3,3,3,6
INFO [2022-04-07 23:16:47] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.1_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.observations.txt
INFO [2022-04-07 23:16:49] plot_cnv_references:Start
INFO [2022-04-07 23:16:49] Reference data size: Cells= 2 Genes= 10779
INFO [2022-04-07 23:16:49] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:16:49] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:16:49] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:16:49] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 23:16:49] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.1_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.references.txt
INFO [2022-04-07 23:16:49] 

	STEP 20: Converting HMM-based CNV states to repr expr vals

INFO [2022-04-07 23:16:52] ::plot_cnv:Start
INFO [2022-04-07 23:16:52] ::plot_cnv:Current data dimensions (r,c)=10779,216 Total=2410012 Min=0 Max=3.
INFO [2022-04-07 23:16:52] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:16:54] plot_cnv_observation:Start
INFO [2022-04-07 23:16:54] Observation data size: Cells= 214 Genes= 10779
INFO [2022-04-07 23:16:54] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:16:56] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:16:56] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:16:56] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:16:56] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:16:56] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:16:56] Quantiles of plotted data range: 0,1,1,1,3
INFO [2022-04-07 23:16:56] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.1_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.observations.txt
INFO [2022-04-07 23:16:58] plot_cnv_references:Start
INFO [2022-04-07 23:16:58] Reference data size: Cells= 2 Genes= 10779
INFO [2022-04-07 23:16:58] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:16:58] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:16:58] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:16:58] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 23:16:58] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.1_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.references.txt
INFO [2022-04-07 23:16:59] 

	STEP 22: Denoising

INFO [2022-04-07 23:16:59] ::process_data:Remove noise, noise threshold defined via ref mean sd_amplifier:  1.5
INFO [2022-04-07 23:16:59] denoising using mean(normal) +- sd_amplifier * sd(normal) per gene per cell across all data
INFO [2022-04-07 23:16:59] :: **** clear_noise_via_ref_quantiles **** : removing noise between bounds:  1 - 1
INFO [2022-04-07 23:17:06] 

## Making the final infercnv heatmap ##
INFO [2022-04-07 23:17:07] ::plot_cnv:Start
INFO [2022-04-07 23:17:07] ::plot_cnv:Current data dimensions (r,c)=10779,216 Total=2328114.29729903 Min=0.772934804389152 Max=1.29838100018908.
INFO [2022-04-07 23:17:07] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:17:09] plot_cnv(): auto thresholding at: (0.911624 , 1.088376)
INFO [2022-04-07 23:17:09] plot_cnv_observation:Start
INFO [2022-04-07 23:17:09] Observation data size: Cells= 214 Genes= 10779
INFO [2022-04-07 23:17:09] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:17:11] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:17:11] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:17:11] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:17:11] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:17:12] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:17:12] Quantiles of plotted data range: 0.911624258584795,0.9808502633822,1,1.01961826759247,1.08837574141521
INFO [2022-04-07 23:17:12] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.1_0/infercnv.observations.txt
INFO [2022-04-07 23:17:14] plot_cnv_references:Start
INFO [2022-04-07 23:17:14] Reference data size: Cells= 2 Genes= 10779
INFO [2022-04-07 23:17:14] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:17:14] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:17:14] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:17:14] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 23:17:14] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.1_0/infercnv.references.txt
INFO [2022-04-07 23:17:15] Parsing gene order file: /home/tenggao/inferCNV/hg38_gene_order.txt
INFO [2022-04-07 23:17:15] Parsing cell annotations file: /home/tenggao/paper_data/infercnv_out/37692_Primary_0.3_0/37692_Primary_annot.tsv
INFO [2022-04-07 23:17:15] ::order_reduce:Start.
INFO [2022-04-07 23:17:15] .order_reduce(): expr and order match.
INFO [2022-04-07 23:17:15] ::process_data:order_reduce:Reduction from positional data, new dimensions (r,c) = 21034,216 Total=179192883 Min=0 Max=6089512.
INFO [2022-04-07 23:17:15] num genes removed taking into account provided gene ordering list: 2169 = 10.3118760102691% removed.
INFO [2022-04-07 23:17:15] -filtering out cells < 100 or > Inf, removing 0 % of cells
INFO [2022-04-07 23:17:15] validating infercnv_obj
INFO [2022-04-07 23:17:15] ::process_data:Start
INFO [2022-04-07 23:17:15] 

	STEP 1: incoming data

INFO [2022-04-07 23:17:15] 

	STEP 02: Removing lowly expressed genes

INFO [2022-04-07 23:17:15] ::above_min_mean_expr_cutoff:Start
INFO [2022-04-07 23:17:15] Removing 4316 genes from matrix as below mean expr threshold: 0.1
INFO [2022-04-07 23:17:15] validating infercnv_obj
INFO [2022-04-07 23:17:15] There are 14549 genes and 216 cells remaining in the expr matrix.
INFO [2022-04-07 23:17:15] Removed 3566 genes having fewer than 3 min cells per gene = 24.5103 % genes removed here
INFO [2022-04-07 23:17:15] validating infercnv_obj
INFO [2022-04-07 23:17:16] 

	STEP 03: normalization by sequencing depth

INFO [2022-04-07 23:17:16] normalizing counts matrix by depth
INFO [2022-04-07 23:17:16] Computed total sum normalization factor as median libsize: 2720.000000
INFO [2022-04-07 23:17:16] Adding h-spike
INFO [2022-04-07 23:17:16] -hspike modeling of Plasma_ref
INFO [2022-04-07 23:18:46] validating infercnv_obj
INFO [2022-04-07 23:18:46] normalizing counts matrix by depth
INFO [2022-04-07 23:18:46] Using specified normalization factor: 2720.000000
INFO [2022-04-07 23:18:47] 

	STEP 04: log transformation of data

INFO [2022-04-07 23:18:47] transforming log2xplus1()
INFO [2022-04-07 23:18:47] -mirroring for hspike
INFO [2022-04-07 23:18:47] transforming log2xplus1()
INFO [2022-04-07 23:18:49] 

	STEP 08: removing average of reference data (before smoothing)

INFO [2022-04-07 23:18:49] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 23:18:49] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 23:18:51] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 23:19:36] -mirroring for hspike
INFO [2022-04-07 23:19:36] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 23:19:36] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 23:19:38] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 23:19:41] 

	STEP 09: apply max centered expression threshold: 3

INFO [2022-04-07 23:19:41] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 23:19:41] -mirroring for hspike
INFO [2022-04-07 23:19:41] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 23:19:44] 

	STEP 10: Smoothing data per cell by chromosome

INFO [2022-04-07 23:19:44] smooth_by_chromosome: chr: chr1
INFO [2022-04-07 23:19:44] smooth_by_chromosome: chr: chr2
INFO [2022-04-07 23:19:44] smooth_by_chromosome: chr: chr3
INFO [2022-04-07 23:19:44] smooth_by_chromosome: chr: chr4
INFO [2022-04-07 23:19:44] smooth_by_chromosome: chr: chr5
INFO [2022-04-07 23:19:45] smooth_by_chromosome: chr: chr6
INFO [2022-04-07 23:19:45] smooth_by_chromosome: chr: chr7
INFO [2022-04-07 23:19:45] smooth_by_chromosome: chr: chr8
INFO [2022-04-07 23:19:45] smooth_by_chromosome: chr: chr9
INFO [2022-04-07 23:19:45] smooth_by_chromosome: chr: chr10
INFO [2022-04-07 23:19:46] smooth_by_chromosome: chr: chr11
INFO [2022-04-07 23:19:46] smooth_by_chromosome: chr: chr12
INFO [2022-04-07 23:19:46] smooth_by_chromosome: chr: chr13
INFO [2022-04-07 23:19:46] smooth_by_chromosome: chr: chr14
INFO [2022-04-07 23:19:46] smooth_by_chromosome: chr: chr15
INFO [2022-04-07 23:19:46] smooth_by_chromosome: chr: chr16
INFO [2022-04-07 23:19:47] smooth_by_chromosome: chr: chr17
INFO [2022-04-07 23:19:47] smooth_by_chromosome: chr: chr18
INFO [2022-04-07 23:19:47] smooth_by_chromosome: chr: chr19
INFO [2022-04-07 23:19:47] smooth_by_chromosome: chr: chr20
INFO [2022-04-07 23:19:47] smooth_by_chromosome: chr: chr21
INFO [2022-04-07 23:19:48] smooth_by_chromosome: chr: chr22
INFO [2022-04-07 23:19:48] -mirroring for hspike
INFO [2022-04-07 23:19:48] smooth_by_chromosome: chr: chrA
INFO [2022-04-07 23:19:48] smooth_by_chromosome: chr: chr_0
INFO [2022-04-07 23:19:48] smooth_by_chromosome: chr: chr_B
INFO [2022-04-07 23:19:48] smooth_by_chromosome: chr: chr_0pt5
INFO [2022-04-07 23:19:49] smooth_by_chromosome: chr: chr_C
INFO [2022-04-07 23:19:49] smooth_by_chromosome: chr: chr_1pt5
INFO [2022-04-07 23:19:49] smooth_by_chromosome: chr: chr_D
INFO [2022-04-07 23:19:49] smooth_by_chromosome: chr: chr_2pt0
INFO [2022-04-07 23:19:49] smooth_by_chromosome: chr: chr_E
INFO [2022-04-07 23:19:49] smooth_by_chromosome: chr: chr_3pt0
INFO [2022-04-07 23:19:50] smooth_by_chromosome: chr: chr_F
INFO [2022-04-07 23:19:53] 

	STEP 11: re-centering data across chromosome after smoothing

INFO [2022-04-07 23:19:53] ::center_smooth across chromosomes per cell
INFO [2022-04-07 23:19:53] -mirroring for hspike
INFO [2022-04-07 23:19:53] ::center_smooth across chromosomes per cell
INFO [2022-04-07 23:19:56] 

	STEP 12: removing average of reference data (after smoothing)

INFO [2022-04-07 23:19:56] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 23:19:56] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 23:19:59] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 23:19:59] -mirroring for hspike
INFO [2022-04-07 23:19:59] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 23:19:59] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 23:20:02] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 23:20:05] 

	STEP 14: invert log2(FC) to FC

INFO [2022-04-07 23:20:05] invert_log2(), computing 2^x
INFO [2022-04-07 23:20:05] -mirroring for hspike
INFO [2022-04-07 23:20:05] invert_log2(), computing 2^x
INFO [2022-04-07 23:20:09] 

	STEP 15: Clustering samples (not defining tumor subclusters)

INFO [2022-04-07 23:20:09] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 23:20:09] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 23:20:10] cut tree into: 1 groups
INFO [2022-04-07 23:20:10] -processing all_observations,all_observations_s1
INFO [2022-04-07 23:20:10] define_signif_tumor_subclusters(), tumor: Plasma_ref
INFO [2022-04-07 23:20:10] -mirroring for hspike
INFO [2022-04-07 23:20:10] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 23:20:10] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 23:20:10] cut tree into: 1 groups
INFO [2022-04-07 23:20:10] -processing all_observations,all_observations_s1
INFO [2022-04-07 23:20:10] define_signif_tumor_subclusters(), tumor: simnorm_cell_Plasma_ref
INFO [2022-04-07 23:20:10] cut tree into: 1 groups
INFO [2022-04-07 23:20:10] -processing simnorm_cell_Plasma_ref,simnorm_cell_Plasma_ref_s1
INFO [2022-04-07 23:20:18] 

	STEP 17: HMM-based CNV prediction

INFO [2022-04-07 23:20:18] predict_CNV_via_HMM_on_whole_tumor_samples
INFO [2022-04-07 23:20:19] -done predicting CNV based on initial tumor subclusters
INFO [2022-04-07 23:20:19] get_predicted_CNV_regions(consensus)
INFO [2022-04-07 23:20:19] -processing cell_group_name: Plasma_ref, size: 2
INFO [2022-04-07 23:20:27] -processing cell_group_name: Plasma, size: 214
INFO [2022-04-07 23:20:37] -writing cell clusters file: /home/tenggao/paper_data/infercnv_out/37692_Primary_0.3_0/17_HMM_predHMMi6.hmm_mode-samples.cell_groupings
INFO [2022-04-07 23:20:37] -writing cnv regions file: /home/tenggao/paper_data/infercnv_out/37692_Primary_0.3_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_regions.dat
INFO [2022-04-07 23:20:37] -writing per-gene cnv report: /home/tenggao/paper_data/infercnv_out/37692_Primary_0.3_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_genes.dat
INFO [2022-04-07 23:20:37] -writing gene ordering info: /home/tenggao/paper_data/infercnv_out/37692_Primary_0.3_0/17_HMM_predHMMi6.hmm_mode-samples.genes_used.dat
INFO [2022-04-07 23:20:40] ::plot_cnv:Start
INFO [2022-04-07 23:20:40] ::plot_cnv:Current data dimensions (r,c)=10983,216 Total=7048504 Min=1 Max=6.
INFO [2022-04-07 23:20:40] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:20:42] plot_cnv_observation:Start
INFO [2022-04-07 23:20:42] Observation data size: Cells= 214 Genes= 10983
INFO [2022-04-07 23:20:42] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:20:44] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:20:44] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:20:44] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:20:44] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:20:45] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:20:45] Quantiles of plotted data range: 1,3,3,3,6
INFO [2022-04-07 23:20:45] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.3_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.observations.txt
INFO [2022-04-07 23:20:47] plot_cnv_references:Start
INFO [2022-04-07 23:20:47] Reference data size: Cells= 2 Genes= 10983
INFO [2022-04-07 23:20:47] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:20:47] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:20:47] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:20:47] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 23:20:47] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.3_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.references.txt
INFO [2022-04-07 23:20:47] 

	STEP 18: Run Bayesian Network Model on HMM predicted CNVs

INFO [2022-04-07 23:20:49] Initializing new MCM InferCNV Object.
INFO [2022-04-07 23:20:49] validating infercnv_obj
INFO [2022-04-07 23:20:49] Total CNV's:  55
INFO [2022-04-07 23:20:49] Loading BUGS Model.
INFO [2022-04-07 23:20:49] Running Sampling Using Parallel with  30 Cores
INFO [2022-04-07 23:22:55] Obtaining probabilities post-sampling
INFO [2022-04-07 23:23:48] Gibbs sampling time:  2.98778907855352  Minutes
INFO [2022-04-07 23:23:52] ::plot_cnv:Start
INFO [2022-04-07 23:23:52] ::plot_cnv:Current data dimensions (r,c)=10983,216 Total=458418.460673819 Min=0 Max=0.99538566470956.
INFO [2022-04-07 23:23:52] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:23:52] plot_cnv_observation:Start
INFO [2022-04-07 23:23:52] Observation data size: Cells= 214 Genes= 10983
INFO [2022-04-07 23:23:52] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:23:54] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:23:54] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:23:54] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:23:54] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:23:55] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:23:55] Quantiles of plotted data range: 0,0,0,0.590216946318774,0.99538566470956
INFO [2022-04-07 23:23:55] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.3_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.observations.txt
INFO [2022-04-07 23:23:57] plot_cnv_references:Start
INFO [2022-04-07 23:23:57] Reference data size: Cells= 2 Genes= 10983
INFO [2022-04-07 23:23:57] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:23:57] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:23:57] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:23:57] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 23:23:57] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.3_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.references.txt
INFO [2022-04-07 23:24:01] 

	STEP 19: Filter HMM predicted CNVs based on the Bayesian Network Model results and BayesMaxPNormal

INFO [2022-04-07 23:24:01] Attempting to removing CNV(s) with a probability of being normal above  0.5
INFO [2022-04-07 23:24:01] Removing  0  CNV(s) identified by the HMM.
INFO [2022-04-07 23:24:01] Reassigning CNVs based on state probabilities.
INFO [2022-04-07 23:24:01] Changing the following CNV's states assigned by the HMM to the following based on the CNV's state probabilities.
 chr19-region_117 : 4  (P= 0.399042617794079 ) ->  3 (P= 0.402441351857267 )
INFO [2022-04-07 23:24:01] Creating Plots for CNV and cell Probabilities.
INFO [2022-04-07 23:24:28] ::plot_cnv:Start
INFO [2022-04-07 23:24:28] ::plot_cnv:Current data dimensions (r,c)=10983,216 Total=458418.460673819 Min=0 Max=0.99538566470956.
INFO [2022-04-07 23:24:28] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:24:28] plot_cnv_observation:Start
INFO [2022-04-07 23:24:28] Observation data size: Cells= 214 Genes= 10983
INFO [2022-04-07 23:24:28] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:24:30] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:24:30] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:24:30] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:24:30] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:24:30] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:24:30] Quantiles of plotted data range: 0,0,0,0.590216946318774,0.99538566470956
INFO [2022-04-07 23:24:30] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.3_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.observations.txt
INFO [2022-04-07 23:24:32] plot_cnv_references:Start
INFO [2022-04-07 23:24:32] Reference data size: Cells= 2 Genes= 10983
INFO [2022-04-07 23:24:32] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:24:32] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:24:32] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:24:32] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 23:24:32] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.3_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.references.txt
INFO [2022-04-07 23:24:35] ::plot_cnv:Start
INFO [2022-04-07 23:24:35] ::plot_cnv:Current data dimensions (r,c)=10983,216 Total=7042726 Min=1 Max=6.
INFO [2022-04-07 23:24:35] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:24:37] plot_cnv_observation:Start
INFO [2022-04-07 23:24:37] Observation data size: Cells= 214 Genes= 10983
INFO [2022-04-07 23:24:37] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:24:40] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:24:40] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:24:40] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:24:40] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:24:40] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:24:40] Quantiles of plotted data range: 1,3,3,3,6
INFO [2022-04-07 23:24:40] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.3_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.observations.txt
INFO [2022-04-07 23:24:42] plot_cnv_references:Start
INFO [2022-04-07 23:24:42] Reference data size: Cells= 2 Genes= 10983
INFO [2022-04-07 23:24:42] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:24:42] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:24:42] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:24:42] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 23:24:42] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.3_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.references.txt
INFO [2022-04-07 23:24:42] 

	STEP 20: Converting HMM-based CNV states to repr expr vals

INFO [2022-04-07 23:24:45] ::plot_cnv:Start
INFO [2022-04-07 23:24:45] ::plot_cnv:Current data dimensions (r,c)=10983,216 Total=2336162 Min=0 Max=3.
INFO [2022-04-07 23:24:45] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:24:47] plot_cnv_observation:Start
INFO [2022-04-07 23:24:47] Observation data size: Cells= 214 Genes= 10983
INFO [2022-04-07 23:24:47] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:24:49] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:24:49] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:24:49] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:24:49] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:24:50] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:24:50] Quantiles of plotted data range: 0,1,1,1,3
INFO [2022-04-07 23:24:50] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.3_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.observations.txt
INFO [2022-04-07 23:24:52] plot_cnv_references:Start
INFO [2022-04-07 23:24:52] Reference data size: Cells= 2 Genes= 10983
INFO [2022-04-07 23:24:52] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:24:52] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:24:52] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:24:52] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 23:24:52] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.3_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.references.txt
INFO [2022-04-07 23:24:52] 

	STEP 22: Denoising

INFO [2022-04-07 23:24:52] ::process_data:Remove noise, noise threshold defined via ref mean sd_amplifier:  1.5
INFO [2022-04-07 23:24:52] denoising using mean(normal) +- sd_amplifier * sd(normal) per gene per cell across all data
INFO [2022-04-07 23:24:52] :: **** clear_noise_via_ref_quantiles **** : removing noise between bounds:  1 - 1
INFO [2022-04-07 23:25:00] 

## Making the final infercnv heatmap ##
INFO [2022-04-07 23:25:00] ::plot_cnv:Start
INFO [2022-04-07 23:25:00] ::plot_cnv:Current data dimensions (r,c)=10983,216 Total=2371633.96289861 Min=0.758114835780701 Max=1.30468162679101.
INFO [2022-04-07 23:25:00] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:25:03] plot_cnv(): auto thresholding at: (0.903876 , 1.096124)
INFO [2022-04-07 23:25:03] plot_cnv_observation:Start
INFO [2022-04-07 23:25:03] Observation data size: Cells= 214 Genes= 10983
INFO [2022-04-07 23:25:03] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:25:05] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:25:05] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:25:05] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:25:05] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:25:05] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:25:05] Quantiles of plotted data range: 0.90387592809931,0.980259675301816,1,1.02024755932594,1.09612407190069
INFO [2022-04-07 23:25:06] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.3_0/infercnv.observations.txt
INFO [2022-04-07 23:25:08] plot_cnv_references:Start
INFO [2022-04-07 23:25:08] Reference data size: Cells= 2 Genes= 10983
INFO [2022-04-07 23:25:08] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:25:08] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:25:08] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:25:08] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 23:25:08] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.3_0/infercnv.references.txt
INFO [2022-04-07 23:25:08] Parsing gene order file: /home/tenggao/inferCNV/hg38_gene_order.txt
INFO [2022-04-07 23:25:09] Parsing cell annotations file: /home/tenggao/paper_data/infercnv_out/37692_Primary_0.5_0/37692_Primary_annot.tsv
INFO [2022-04-07 23:25:09] ::order_reduce:Start.
INFO [2022-04-07 23:25:09] .order_reduce(): expr and order match.
INFO [2022-04-07 23:25:09] ::process_data:order_reduce:Reduction from positional data, new dimensions (r,c) = 21034,216 Total=179251982 Min=0 Max=6089512.
INFO [2022-04-07 23:25:09] num genes removed taking into account provided gene ordering list: 2169 = 10.3118760102691% removed.
INFO [2022-04-07 23:25:09] -filtering out cells < 100 or > Inf, removing 0 % of cells
INFO [2022-04-07 23:25:09] validating infercnv_obj
INFO [2022-04-07 23:25:09] ::process_data:Start
INFO [2022-04-07 23:25:09] 

	STEP 1: incoming data

INFO [2022-04-07 23:25:09] 

	STEP 02: Removing lowly expressed genes

INFO [2022-04-07 23:25:09] ::above_min_mean_expr_cutoff:Start
INFO [2022-04-07 23:25:09] Removing 4310 genes from matrix as below mean expr threshold: 0.1
INFO [2022-04-07 23:25:09] validating infercnv_obj
INFO [2022-04-07 23:25:09] There are 14555 genes and 216 cells remaining in the expr matrix.
INFO [2022-04-07 23:25:09] Removed 3527 genes having fewer than 3 min cells per gene = 24.2322 % genes removed here
INFO [2022-04-07 23:25:09] validating infercnv_obj
INFO [2022-04-07 23:25:09] 

	STEP 03: normalization by sequencing depth

INFO [2022-04-07 23:25:09] normalizing counts matrix by depth
INFO [2022-04-07 23:25:10] Computed total sum normalization factor as median libsize: 2897.000000
INFO [2022-04-07 23:25:10] Adding h-spike
INFO [2022-04-07 23:25:10] -hspike modeling of Plasma_ref
INFO [2022-04-07 23:26:42] validating infercnv_obj
INFO [2022-04-07 23:26:42] normalizing counts matrix by depth
INFO [2022-04-07 23:26:42] Using specified normalization factor: 2897.000000
INFO [2022-04-07 23:26:43] 

	STEP 04: log transformation of data

INFO [2022-04-07 23:26:43] transforming log2xplus1()
INFO [2022-04-07 23:26:43] -mirroring for hspike
INFO [2022-04-07 23:26:43] transforming log2xplus1()
INFO [2022-04-07 23:26:45] 

	STEP 08: removing average of reference data (before smoothing)

INFO [2022-04-07 23:26:45] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 23:26:45] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 23:26:47] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 23:27:32] -mirroring for hspike
INFO [2022-04-07 23:27:32] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 23:27:32] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 23:27:35] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 23:27:38] 

	STEP 09: apply max centered expression threshold: 3

INFO [2022-04-07 23:27:38] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 23:27:38] -mirroring for hspike
INFO [2022-04-07 23:27:38] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 23:27:40] 

	STEP 10: Smoothing data per cell by chromosome

INFO [2022-04-07 23:27:40] smooth_by_chromosome: chr: chr1
INFO [2022-04-07 23:27:40] smooth_by_chromosome: chr: chr2
INFO [2022-04-07 23:27:40] smooth_by_chromosome: chr: chr3
INFO [2022-04-07 23:27:41] smooth_by_chromosome: chr: chr4
INFO [2022-04-07 23:27:41] smooth_by_chromosome: chr: chr5
INFO [2022-04-07 23:27:41] smooth_by_chromosome: chr: chr6
INFO [2022-04-07 23:27:41] smooth_by_chromosome: chr: chr7
INFO [2022-04-07 23:27:41] smooth_by_chromosome: chr: chr8
INFO [2022-04-07 23:27:42] smooth_by_chromosome: chr: chr9
INFO [2022-04-07 23:27:42] smooth_by_chromosome: chr: chr10
INFO [2022-04-07 23:27:42] smooth_by_chromosome: chr: chr11
INFO [2022-04-07 23:27:42] smooth_by_chromosome: chr: chr12
INFO [2022-04-07 23:27:42] smooth_by_chromosome: chr: chr13
INFO [2022-04-07 23:27:43] smooth_by_chromosome: chr: chr14
INFO [2022-04-07 23:27:43] smooth_by_chromosome: chr: chr15
INFO [2022-04-07 23:27:43] smooth_by_chromosome: chr: chr16
INFO [2022-04-07 23:27:43] smooth_by_chromosome: chr: chr17
INFO [2022-04-07 23:27:43] smooth_by_chromosome: chr: chr18
INFO [2022-04-07 23:27:44] smooth_by_chromosome: chr: chr19
INFO [2022-04-07 23:27:44] smooth_by_chromosome: chr: chr20
INFO [2022-04-07 23:27:44] smooth_by_chromosome: chr: chr21
INFO [2022-04-07 23:27:44] smooth_by_chromosome: chr: chr22
INFO [2022-04-07 23:27:44] -mirroring for hspike
INFO [2022-04-07 23:27:44] smooth_by_chromosome: chr: chrA
INFO [2022-04-07 23:27:44] smooth_by_chromosome: chr: chr_0
INFO [2022-04-07 23:27:45] smooth_by_chromosome: chr: chr_B
INFO [2022-04-07 23:27:45] smooth_by_chromosome: chr: chr_0pt5
INFO [2022-04-07 23:27:45] smooth_by_chromosome: chr: chr_C
INFO [2022-04-07 23:27:45] smooth_by_chromosome: chr: chr_1pt5
INFO [2022-04-07 23:27:45] smooth_by_chromosome: chr: chr_D
INFO [2022-04-07 23:27:45] smooth_by_chromosome: chr: chr_2pt0
INFO [2022-04-07 23:27:46] smooth_by_chromosome: chr: chr_E
INFO [2022-04-07 23:27:46] smooth_by_chromosome: chr: chr_3pt0
INFO [2022-04-07 23:27:46] smooth_by_chromosome: chr: chr_F
INFO [2022-04-07 23:27:49] 

	STEP 11: re-centering data across chromosome after smoothing

INFO [2022-04-07 23:27:49] ::center_smooth across chromosomes per cell
INFO [2022-04-07 23:27:50] -mirroring for hspike
INFO [2022-04-07 23:27:50] ::center_smooth across chromosomes per cell
INFO [2022-04-07 23:27:53] 

	STEP 12: removing average of reference data (after smoothing)

INFO [2022-04-07 23:27:53] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 23:27:53] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 23:27:55] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 23:27:56] -mirroring for hspike
INFO [2022-04-07 23:27:56] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 23:27:56] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 23:27:58] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 23:28:02] 

	STEP 14: invert log2(FC) to FC

INFO [2022-04-07 23:28:02] invert_log2(), computing 2^x
INFO [2022-04-07 23:28:02] -mirroring for hspike
INFO [2022-04-07 23:28:02] invert_log2(), computing 2^x
INFO [2022-04-07 23:28:06] 

	STEP 15: Clustering samples (not defining tumor subclusters)

INFO [2022-04-07 23:28:06] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 23:28:06] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 23:28:07] cut tree into: 1 groups
INFO [2022-04-07 23:28:07] -processing all_observations,all_observations_s1
INFO [2022-04-07 23:28:07] define_signif_tumor_subclusters(), tumor: Plasma_ref
INFO [2022-04-07 23:28:07] -mirroring for hspike
INFO [2022-04-07 23:28:07] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 23:28:07] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 23:28:07] cut tree into: 1 groups
INFO [2022-04-07 23:28:07] -processing all_observations,all_observations_s1
INFO [2022-04-07 23:28:07] define_signif_tumor_subclusters(), tumor: simnorm_cell_Plasma_ref
INFO [2022-04-07 23:28:07] cut tree into: 1 groups
INFO [2022-04-07 23:28:07] -processing simnorm_cell_Plasma_ref,simnorm_cell_Plasma_ref_s1
INFO [2022-04-07 23:28:14] 

	STEP 17: HMM-based CNV prediction

INFO [2022-04-07 23:28:14] predict_CNV_via_HMM_on_whole_tumor_samples
INFO [2022-04-07 23:28:16] -done predicting CNV based on initial tumor subclusters
INFO [2022-04-07 23:28:16] get_predicted_CNV_regions(consensus)
INFO [2022-04-07 23:28:16] -processing cell_group_name: Plasma_ref, size: 2
INFO [2022-04-07 23:28:25] -processing cell_group_name: Plasma, size: 214
INFO [2022-04-07 23:28:35] -writing cell clusters file: /home/tenggao/paper_data/infercnv_out/37692_Primary_0.5_0/17_HMM_predHMMi6.hmm_mode-samples.cell_groupings
INFO [2022-04-07 23:28:35] -writing cnv regions file: /home/tenggao/paper_data/infercnv_out/37692_Primary_0.5_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_regions.dat
INFO [2022-04-07 23:28:35] -writing per-gene cnv report: /home/tenggao/paper_data/infercnv_out/37692_Primary_0.5_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_genes.dat
INFO [2022-04-07 23:28:35] -writing gene ordering info: /home/tenggao/paper_data/infercnv_out/37692_Primary_0.5_0/17_HMM_predHMMi6.hmm_mode-samples.genes_used.dat
INFO [2022-04-07 23:28:37] ::plot_cnv:Start
INFO [2022-04-07 23:28:37] ::plot_cnv:Current data dimensions (r,c)=11028,216 Total=7132448 Min=1 Max=6.
INFO [2022-04-07 23:28:37] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:28:40] plot_cnv_observation:Start
INFO [2022-04-07 23:28:40] Observation data size: Cells= 214 Genes= 11028
INFO [2022-04-07 23:28:40] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:28:42] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:28:42] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:28:42] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:28:42] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:28:42] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:28:42] Quantiles of plotted data range: 1,3,3,3,6
INFO [2022-04-07 23:28:42] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.5_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.observations.txt
INFO [2022-04-07 23:28:45] plot_cnv_references:Start
INFO [2022-04-07 23:28:45] Reference data size: Cells= 2 Genes= 11028
INFO [2022-04-07 23:28:45] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:28:45] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:28:45] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:28:45] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 23:28:45] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.5_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.references.txt
INFO [2022-04-07 23:28:45] 

	STEP 18: Run Bayesian Network Model on HMM predicted CNVs

INFO [2022-04-07 23:28:46] Initializing new MCM InferCNV Object.
INFO [2022-04-07 23:28:46] validating infercnv_obj
INFO [2022-04-07 23:28:46] Total CNV's:  41
INFO [2022-04-07 23:28:46] Loading BUGS Model.
INFO [2022-04-07 23:28:46] Running Sampling Using Parallel with  30 Cores
INFO [2022-04-07 23:30:22] Obtaining probabilities post-sampling
INFO [2022-04-07 23:31:01] Gibbs sampling time:  2.24982753992081  Minutes
INFO [2022-04-07 23:31:05] ::plot_cnv:Start
INFO [2022-04-07 23:31:05] ::plot_cnv:Current data dimensions (r,c)=11028,216 Total=345605.598019185 Min=0 Max=0.995446473203904.
INFO [2022-04-07 23:31:05] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:31:05] plot_cnv_observation:Start
INFO [2022-04-07 23:31:05] Observation data size: Cells= 214 Genes= 11028
INFO [2022-04-07 23:31:05] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:31:07] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:31:07] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:31:07] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:31:07] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:31:08] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:31:08] Quantiles of plotted data range: 0,0,0,0,0.995446473203904
INFO [2022-04-07 23:31:08] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.5_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.observations.txt
INFO [2022-04-07 23:31:10] plot_cnv_references:Start
INFO [2022-04-07 23:31:10] Reference data size: Cells= 2 Genes= 11028
INFO [2022-04-07 23:31:10] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:31:10] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:31:10] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:31:10] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 23:31:10] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.5_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.references.txt
INFO [2022-04-07 23:31:14] 

	STEP 19: Filter HMM predicted CNVs based on the Bayesian Network Model results and BayesMaxPNormal

INFO [2022-04-07 23:31:14] Attempting to removing CNV(s) with a probability of being normal above  0.5
INFO [2022-04-07 23:31:14] Removing  0  CNV(s) identified by the HMM.
INFO [2022-04-07 23:31:14] Reassigning CNVs based on state probabilities.
INFO [2022-04-07 23:31:14] Changing the following CNV's states assigned by the HMM to the following based on the CNV's state probabilities.
 chr22-region_110 : 4  (P= 0.400394567917214 ) ->  3 (P= 0.426878910649918 )
INFO [2022-04-07 23:31:14] Creating Plots for CNV and cell Probabilities.
INFO [2022-04-07 23:31:34] ::plot_cnv:Start
INFO [2022-04-07 23:31:34] ::plot_cnv:Current data dimensions (r,c)=11028,216 Total=345605.598019185 Min=0 Max=0.995446473203904.
INFO [2022-04-07 23:31:34] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:31:34] plot_cnv_observation:Start
INFO [2022-04-07 23:31:34] Observation data size: Cells= 214 Genes= 11028
INFO [2022-04-07 23:31:34] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:31:35] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:31:35] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:31:35] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:31:35] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:31:36] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:31:36] Quantiles of plotted data range: 0,0,0,0,0.995446473203904
INFO [2022-04-07 23:31:36] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.5_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.observations.txt
INFO [2022-04-07 23:31:38] plot_cnv_references:Start
INFO [2022-04-07 23:31:38] Reference data size: Cells= 2 Genes= 11028
INFO [2022-04-07 23:31:38] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:31:38] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:31:38] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:31:38] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 23:31:38] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.5_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.references.txt
INFO [2022-04-07 23:31:41] ::plot_cnv:Start
INFO [2022-04-07 23:31:41] ::plot_cnv:Current data dimensions (r,c)=11028,216 Total=7124102 Min=1 Max=6.
INFO [2022-04-07 23:31:41] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:31:43] plot_cnv_observation:Start
INFO [2022-04-07 23:31:43] Observation data size: Cells= 214 Genes= 11028
INFO [2022-04-07 23:31:43] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:31:45] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:31:45] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:31:45] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:31:45] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:31:45] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:31:45] Quantiles of plotted data range: 1,3,3,3,6
INFO [2022-04-07 23:31:46] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.5_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.observations.txt
INFO [2022-04-07 23:31:48] plot_cnv_references:Start
INFO [2022-04-07 23:31:48] Reference data size: Cells= 2 Genes= 11028
INFO [2022-04-07 23:31:48] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:31:48] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:31:48] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:31:48] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 23:31:48] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.5_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.references.txt
INFO [2022-04-07 23:31:48] 

	STEP 20: Converting HMM-based CNV states to repr expr vals

INFO [2022-04-07 23:31:51] ::plot_cnv:Start
INFO [2022-04-07 23:31:51] ::plot_cnv:Current data dimensions (r,c)=11028,216 Total=2371990 Min=0 Max=3.
INFO [2022-04-07 23:31:51] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:31:53] plot_cnv_observation:Start
INFO [2022-04-07 23:31:53] Observation data size: Cells= 214 Genes= 11028
INFO [2022-04-07 23:31:53] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:31:55] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:31:55] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:31:55] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:31:55] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:31:55] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:31:55] Quantiles of plotted data range: 0,1,1,1,3
INFO [2022-04-07 23:31:55] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.5_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.observations.txt
INFO [2022-04-07 23:31:57] plot_cnv_references:Start
INFO [2022-04-07 23:31:57] Reference data size: Cells= 2 Genes= 11028
INFO [2022-04-07 23:31:57] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:31:57] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:31:57] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:31:57] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 23:31:57] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.5_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.references.txt
INFO [2022-04-07 23:31:58] 

	STEP 22: Denoising

INFO [2022-04-07 23:31:58] ::process_data:Remove noise, noise threshold defined via ref mean sd_amplifier:  1.5
INFO [2022-04-07 23:31:58] denoising using mean(normal) +- sd_amplifier * sd(normal) per gene per cell across all data
INFO [2022-04-07 23:31:58] :: **** clear_noise_via_ref_quantiles **** : removing noise between bounds:  1 - 1
INFO [2022-04-07 23:32:05] 

## Making the final infercnv heatmap ##
INFO [2022-04-07 23:32:06] ::plot_cnv:Start
INFO [2022-04-07 23:32:06] ::plot_cnv:Current data dimensions (r,c)=11028,216 Total=2380743.75059305 Min=0.752775855327944 Max=1.30245799966668.
INFO [2022-04-07 23:32:06] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:32:08] plot_cnv(): auto thresholding at: (0.892195 , 1.107805)
INFO [2022-04-07 23:32:08] plot_cnv_observation:Start
INFO [2022-04-07 23:32:08] Observation data size: Cells= 214 Genes= 11028
INFO [2022-04-07 23:32:08] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:32:11] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:32:11] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:32:11] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:32:11] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:32:11] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:32:11] Quantiles of plotted data range: 0.892195105423234,0.978792045398321,1,1.02163124242911,1.10780489457677
INFO [2022-04-07 23:32:11] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.5_0/infercnv.observations.txt
INFO [2022-04-07 23:32:14] plot_cnv_references:Start
INFO [2022-04-07 23:32:14] Reference data size: Cells= 2 Genes= 11028
INFO [2022-04-07 23:32:14] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:32:14] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:32:14] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:32:14] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 23:32:14] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.5_0/infercnv.references.txt
INFO [2022-04-07 23:32:14] Parsing gene order file: /home/tenggao/inferCNV/hg38_gene_order.txt
INFO [2022-04-07 23:32:14] Parsing cell annotations file: /home/tenggao/paper_data/infercnv_out/37692_Primary_0.7_0/37692_Primary_annot.tsv
INFO [2022-04-07 23:32:14] ::order_reduce:Start.
INFO [2022-04-07 23:32:14] .order_reduce(): expr and order match.
INFO [2022-04-07 23:32:14] ::process_data:order_reduce:Reduction from positional data, new dimensions (r,c) = 21034,216 Total=179324790 Min=0 Max=6089512.
INFO [2022-04-07 23:32:14] num genes removed taking into account provided gene ordering list: 2169 = 10.3118760102691% removed.
INFO [2022-04-07 23:32:14] -filtering out cells < 100 or > Inf, removing 0 % of cells
INFO [2022-04-07 23:32:14] validating infercnv_obj
INFO [2022-04-07 23:32:14] ::process_data:Start
INFO [2022-04-07 23:32:14] 

	STEP 1: incoming data

INFO [2022-04-07 23:32:15] 

	STEP 02: Removing lowly expressed genes

INFO [2022-04-07 23:32:15] ::above_min_mean_expr_cutoff:Start
INFO [2022-04-07 23:32:15] Removing 4308 genes from matrix as below mean expr threshold: 0.1
INFO [2022-04-07 23:32:15] validating infercnv_obj
INFO [2022-04-07 23:32:15] There are 14557 genes and 216 cells remaining in the expr matrix.
INFO [2022-04-07 23:32:15] Removed 3526 genes having fewer than 3 min cells per gene = 24.222 % genes removed here
INFO [2022-04-07 23:32:15] validating infercnv_obj
INFO [2022-04-07 23:32:15] 

	STEP 03: normalization by sequencing depth

INFO [2022-04-07 23:32:15] normalizing counts matrix by depth
INFO [2022-04-07 23:32:15] Computed total sum normalization factor as median libsize: 3386.500000
INFO [2022-04-07 23:32:15] Adding h-spike
INFO [2022-04-07 23:32:15] -hspike modeling of Plasma_ref
INFO [2022-04-07 23:33:47] validating infercnv_obj
INFO [2022-04-07 23:33:47] normalizing counts matrix by depth
INFO [2022-04-07 23:33:47] Using specified normalization factor: 3386.500000
INFO [2022-04-07 23:33:48] 

	STEP 04: log transformation of data

INFO [2022-04-07 23:33:48] transforming log2xplus1()
INFO [2022-04-07 23:33:48] -mirroring for hspike
INFO [2022-04-07 23:33:48] transforming log2xplus1()
INFO [2022-04-07 23:33:50] 

	STEP 08: removing average of reference data (before smoothing)

INFO [2022-04-07 23:33:50] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 23:33:50] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 23:33:52] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 23:34:37] -mirroring for hspike
INFO [2022-04-07 23:34:37] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 23:34:37] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 23:34:39] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 23:34:42] 

	STEP 09: apply max centered expression threshold: 3

INFO [2022-04-07 23:34:42] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 23:34:42] -mirroring for hspike
INFO [2022-04-07 23:34:42] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 23:34:45] 

	STEP 10: Smoothing data per cell by chromosome

INFO [2022-04-07 23:34:45] smooth_by_chromosome: chr: chr1
INFO [2022-04-07 23:34:45] smooth_by_chromosome: chr: chr2
INFO [2022-04-07 23:34:45] smooth_by_chromosome: chr: chr3
INFO [2022-04-07 23:34:45] smooth_by_chromosome: chr: chr4
INFO [2022-04-07 23:34:46] smooth_by_chromosome: chr: chr5
INFO [2022-04-07 23:34:46] smooth_by_chromosome: chr: chr6
INFO [2022-04-07 23:34:46] smooth_by_chromosome: chr: chr7
INFO [2022-04-07 23:34:46] smooth_by_chromosome: chr: chr8
INFO [2022-04-07 23:34:46] smooth_by_chromosome: chr: chr9
INFO [2022-04-07 23:34:47] smooth_by_chromosome: chr: chr10
INFO [2022-04-07 23:34:47] smooth_by_chromosome: chr: chr11
INFO [2022-04-07 23:34:47] smooth_by_chromosome: chr: chr12
INFO [2022-04-07 23:34:47] smooth_by_chromosome: chr: chr13
INFO [2022-04-07 23:34:47] smooth_by_chromosome: chr: chr14
INFO [2022-04-07 23:34:48] smooth_by_chromosome: chr: chr15
INFO [2022-04-07 23:34:48] smooth_by_chromosome: chr: chr16
INFO [2022-04-07 23:34:48] smooth_by_chromosome: chr: chr17
INFO [2022-04-07 23:34:48] smooth_by_chromosome: chr: chr18
INFO [2022-04-07 23:34:48] smooth_by_chromosome: chr: chr19
INFO [2022-04-07 23:34:49] smooth_by_chromosome: chr: chr20
INFO [2022-04-07 23:34:49] smooth_by_chromosome: chr: chr21
INFO [2022-04-07 23:34:49] smooth_by_chromosome: chr: chr22
INFO [2022-04-07 23:34:49] -mirroring for hspike
INFO [2022-04-07 23:34:49] smooth_by_chromosome: chr: chrA
INFO [2022-04-07 23:34:49] smooth_by_chromosome: chr: chr_0
INFO [2022-04-07 23:34:49] smooth_by_chromosome: chr: chr_B
INFO [2022-04-07 23:34:50] smooth_by_chromosome: chr: chr_0pt5
INFO [2022-04-07 23:34:50] smooth_by_chromosome: chr: chr_C
INFO [2022-04-07 23:34:50] smooth_by_chromosome: chr: chr_1pt5
INFO [2022-04-07 23:34:50] smooth_by_chromosome: chr: chr_D
INFO [2022-04-07 23:34:50] smooth_by_chromosome: chr: chr_2pt0
INFO [2022-04-07 23:34:50] smooth_by_chromosome: chr: chr_E
INFO [2022-04-07 23:34:51] smooth_by_chromosome: chr: chr_3pt0
INFO [2022-04-07 23:34:51] smooth_by_chromosome: chr: chr_F
INFO [2022-04-07 23:34:54] 

	STEP 11: re-centering data across chromosome after smoothing

INFO [2022-04-07 23:34:54] ::center_smooth across chromosomes per cell
INFO [2022-04-07 23:34:54] -mirroring for hspike
INFO [2022-04-07 23:34:54] ::center_smooth across chromosomes per cell
INFO [2022-04-07 23:34:57] 

	STEP 12: removing average of reference data (after smoothing)

INFO [2022-04-07 23:34:57] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 23:34:57] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 23:35:00] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 23:35:00] -mirroring for hspike
INFO [2022-04-07 23:35:00] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 23:35:00] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 23:35:03] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 23:35:06] 

	STEP 14: invert log2(FC) to FC

INFO [2022-04-07 23:35:06] invert_log2(), computing 2^x
INFO [2022-04-07 23:35:06] -mirroring for hspike
INFO [2022-04-07 23:35:06] invert_log2(), computing 2^x
INFO [2022-04-07 23:35:10] 

	STEP 15: Clustering samples (not defining tumor subclusters)

INFO [2022-04-07 23:35:10] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 23:35:10] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 23:35:11] cut tree into: 1 groups
INFO [2022-04-07 23:35:11] -processing all_observations,all_observations_s1
INFO [2022-04-07 23:35:11] define_signif_tumor_subclusters(), tumor: Plasma_ref
INFO [2022-04-07 23:35:11] -mirroring for hspike
INFO [2022-04-07 23:35:11] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 23:35:11] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 23:35:11] cut tree into: 1 groups
INFO [2022-04-07 23:35:11] -processing all_observations,all_observations_s1
INFO [2022-04-07 23:35:11] define_signif_tumor_subclusters(), tumor: simnorm_cell_Plasma_ref
INFO [2022-04-07 23:35:12] cut tree into: 1 groups
INFO [2022-04-07 23:35:12] -processing simnorm_cell_Plasma_ref,simnorm_cell_Plasma_ref_s1
INFO [2022-04-07 23:35:19] 

	STEP 17: HMM-based CNV prediction

INFO [2022-04-07 23:35:19] predict_CNV_via_HMM_on_whole_tumor_samples
INFO [2022-04-07 23:35:21] -done predicting CNV based on initial tumor subclusters
INFO [2022-04-07 23:35:21] get_predicted_CNV_regions(consensus)
INFO [2022-04-07 23:35:21] -processing cell_group_name: Plasma_ref, size: 2
INFO [2022-04-07 23:35:29] -processing cell_group_name: Plasma, size: 214
INFO [2022-04-07 23:35:39] -writing cell clusters file: /home/tenggao/paper_data/infercnv_out/37692_Primary_0.7_0/17_HMM_predHMMi6.hmm_mode-samples.cell_groupings
INFO [2022-04-07 23:35:39] -writing cnv regions file: /home/tenggao/paper_data/infercnv_out/37692_Primary_0.7_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_regions.dat
INFO [2022-04-07 23:35:39] -writing per-gene cnv report: /home/tenggao/paper_data/infercnv_out/37692_Primary_0.7_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_genes.dat
INFO [2022-04-07 23:35:39] -writing gene ordering info: /home/tenggao/paper_data/infercnv_out/37692_Primary_0.7_0/17_HMM_predHMMi6.hmm_mode-samples.genes_used.dat
INFO [2022-04-07 23:35:41] ::plot_cnv:Start
INFO [2022-04-07 23:35:41] ::plot_cnv:Current data dimensions (r,c)=11031,216 Total=7095872 Min=1 Max=6.
INFO [2022-04-07 23:35:41] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:35:44] plot_cnv_observation:Start
INFO [2022-04-07 23:35:44] Observation data size: Cells= 214 Genes= 11031
INFO [2022-04-07 23:35:44] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:35:46] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:35:46] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:35:46] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:35:46] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:35:46] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:35:46] Quantiles of plotted data range: 1,3,3,3,6
INFO [2022-04-07 23:35:46] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.7_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.observations.txt
INFO [2022-04-07 23:35:48] plot_cnv_references:Start
INFO [2022-04-07 23:35:48] Reference data size: Cells= 2 Genes= 11031
INFO [2022-04-07 23:35:48] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:35:48] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:35:48] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:35:48] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 23:35:48] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.7_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.references.txt
INFO [2022-04-07 23:35:49] 

	STEP 18: Run Bayesian Network Model on HMM predicted CNVs

INFO [2022-04-07 23:35:50] Initializing new MCM InferCNV Object.
INFO [2022-04-07 23:35:50] validating infercnv_obj
INFO [2022-04-07 23:35:50] Total CNV's:  53
INFO [2022-04-07 23:35:50] Loading BUGS Model.
INFO [2022-04-07 23:35:50] Running Sampling Using Parallel with  30 Cores
INFO [2022-04-07 23:37:54] Obtaining probabilities post-sampling
INFO [2022-04-07 23:38:45] Gibbs sampling time:  2.92152840296427  Minutes
INFO [2022-04-07 23:38:50] ::plot_cnv:Start
INFO [2022-04-07 23:38:50] ::plot_cnv:Current data dimensions (r,c)=11031,216 Total=492560.430075796 Min=0 Max=0.995437582992446.
INFO [2022-04-07 23:38:50] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:38:50] plot_cnv_observation:Start
INFO [2022-04-07 23:38:50] Observation data size: Cells= 214 Genes= 11031
INFO [2022-04-07 23:38:50] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:38:52] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:38:52] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:38:52] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:38:52] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:38:52] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:38:52] Quantiles of plotted data range: 0,0,0,0.629751565021052,0.995437582992446
INFO [2022-04-07 23:38:52] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.7_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.observations.txt
INFO [2022-04-07 23:38:54] plot_cnv_references:Start
INFO [2022-04-07 23:38:54] Reference data size: Cells= 2 Genes= 11031
INFO [2022-04-07 23:38:54] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:38:54] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:38:54] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:38:54] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 23:38:54] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.7_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.references.txt
INFO [2022-04-07 23:38:59] 

	STEP 19: Filter HMM predicted CNVs based on the Bayesian Network Model results and BayesMaxPNormal

INFO [2022-04-07 23:38:59] Attempting to removing CNV(s) with a probability of being normal above  0.5
INFO [2022-04-07 23:38:59] Removing  0  CNV(s) identified by the HMM.
INFO [2022-04-07 23:38:59] Reassigning CNVs based on state probabilities.
INFO [2022-04-07 23:38:59] Creating Plots for CNV and cell Probabilities.
INFO [2022-04-07 23:39:25] ::plot_cnv:Start
INFO [2022-04-07 23:39:25] ::plot_cnv:Current data dimensions (r,c)=11031,216 Total=492560.430075796 Min=0 Max=0.995437582992446.
INFO [2022-04-07 23:39:25] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:39:25] plot_cnv_observation:Start
INFO [2022-04-07 23:39:25] Observation data size: Cells= 214 Genes= 11031
INFO [2022-04-07 23:39:25] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:39:27] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:39:27] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:39:27] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:39:27] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:39:28] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:39:28] Quantiles of plotted data range: 0,0,0,0.629751565021052,0.995437582992446
INFO [2022-04-07 23:39:28] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.7_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.observations.txt
INFO [2022-04-07 23:39:30] plot_cnv_references:Start
INFO [2022-04-07 23:39:30] Reference data size: Cells= 2 Genes= 11031
INFO [2022-04-07 23:39:30] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:39:30] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:39:30] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:39:30] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 23:39:30] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.7_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.references.txt
INFO [2022-04-07 23:39:33] ::plot_cnv:Start
INFO [2022-04-07 23:39:33] ::plot_cnv:Current data dimensions (r,c)=11031,216 Total=7095872 Min=1 Max=6.
INFO [2022-04-07 23:39:33] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:39:35] plot_cnv_observation:Start
INFO [2022-04-07 23:39:35] Observation data size: Cells= 214 Genes= 11031
INFO [2022-04-07 23:39:35] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:39:37] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:39:37] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:39:37] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:39:37] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:39:37] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:39:37] Quantiles of plotted data range: 1,3,3,3,6
INFO [2022-04-07 23:39:38] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.7_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.observations.txt
INFO [2022-04-07 23:39:40] plot_cnv_references:Start
INFO [2022-04-07 23:39:40] Reference data size: Cells= 2 Genes= 11031
INFO [2022-04-07 23:39:40] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:39:40] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:39:40] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:39:40] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 23:39:40] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.7_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.references.txt
INFO [2022-04-07 23:39:40] 

	STEP 20: Converting HMM-based CNV states to repr expr vals

INFO [2022-04-07 23:39:43] ::plot_cnv:Start
INFO [2022-04-07 23:39:43] ::plot_cnv:Current data dimensions (r,c)=11031,216 Total=2357551 Min=0 Max=3.
INFO [2022-04-07 23:39:43] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:39:45] plot_cnv_observation:Start
INFO [2022-04-07 23:39:45] Observation data size: Cells= 214 Genes= 11031
INFO [2022-04-07 23:39:45] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:39:47] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:39:47] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:39:47] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:39:47] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:39:47] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:39:47] Quantiles of plotted data range: 0,1,1,1,3
INFO [2022-04-07 23:39:48] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.7_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.observations.txt
INFO [2022-04-07 23:39:50] plot_cnv_references:Start
INFO [2022-04-07 23:39:50] Reference data size: Cells= 2 Genes= 11031
INFO [2022-04-07 23:39:50] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:39:50] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:39:50] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:39:50] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 23:39:50] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.7_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.references.txt
INFO [2022-04-07 23:39:50] 

	STEP 22: Denoising

INFO [2022-04-07 23:39:50] ::process_data:Remove noise, noise threshold defined via ref mean sd_amplifier:  1.5
INFO [2022-04-07 23:39:50] denoising using mean(normal) +- sd_amplifier * sd(normal) per gene per cell across all data
INFO [2022-04-07 23:39:50] :: **** clear_noise_via_ref_quantiles **** : removing noise between bounds:  1 - 1
INFO [2022-04-07 23:39:57] 

## Making the final infercnv heatmap ##
INFO [2022-04-07 23:39:58] ::plot_cnv:Start
INFO [2022-04-07 23:39:58] ::plot_cnv:Current data dimensions (r,c)=11031,216 Total=2381099.78766498 Min=0.735992621654262 Max=1.36421307257531.
INFO [2022-04-07 23:39:58] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:40:00] plot_cnv(): auto thresholding at: (0.878144 , 1.121856)
INFO [2022-04-07 23:40:00] plot_cnv_observation:Start
INFO [2022-04-07 23:40:00] Observation data size: Cells= 214 Genes= 11031
INFO [2022-04-07 23:40:00] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:40:03] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:40:03] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:40:03] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:40:03] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:40:03] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:40:03] Quantiles of plotted data range: 0.878143668017412,0.97606431734858,1,1.02447492262476,1.12185633198259
INFO [2022-04-07 23:40:03] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.7_0/infercnv.observations.txt
INFO [2022-04-07 23:40:06] plot_cnv_references:Start
INFO [2022-04-07 23:40:06] Reference data size: Cells= 2 Genes= 11031
INFO [2022-04-07 23:40:06] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:40:06] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:40:06] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:40:06] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 23:40:06] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.7_0/infercnv.references.txt
INFO [2022-04-07 23:40:06] Parsing gene order file: /home/tenggao/inferCNV/hg38_gene_order.txt
INFO [2022-04-07 23:40:06] Parsing cell annotations file: /home/tenggao/paper_data/infercnv_out/37692_Primary_0.9_0/37692_Primary_annot.tsv
INFO [2022-04-07 23:40:06] ::order_reduce:Start.
INFO [2022-04-07 23:40:06] .order_reduce(): expr and order match.
INFO [2022-04-07 23:40:06] ::process_data:order_reduce:Reduction from positional data, new dimensions (r,c) = 21034,216 Total=179356757 Min=0 Max=6089512.
INFO [2022-04-07 23:40:06] num genes removed taking into account provided gene ordering list: 2169 = 10.3118760102691% removed.
INFO [2022-04-07 23:40:06] -filtering out cells < 100 or > Inf, removing 0 % of cells
INFO [2022-04-07 23:40:06] validating infercnv_obj
INFO [2022-04-07 23:40:06] ::process_data:Start
INFO [2022-04-07 23:40:06] 

	STEP 1: incoming data

INFO [2022-04-07 23:40:07] 

	STEP 02: Removing lowly expressed genes

INFO [2022-04-07 23:40:07] ::above_min_mean_expr_cutoff:Start
INFO [2022-04-07 23:40:07] Removing 4306 genes from matrix as below mean expr threshold: 0.1
INFO [2022-04-07 23:40:07] validating infercnv_obj
INFO [2022-04-07 23:40:07] There are 14559 genes and 216 cells remaining in the expr matrix.
INFO [2022-04-07 23:40:07] Removed 3710 genes having fewer than 3 min cells per gene = 25.4825 % genes removed here
INFO [2022-04-07 23:40:07] validating infercnv_obj
INFO [2022-04-07 23:40:07] 

	STEP 03: normalization by sequencing depth

INFO [2022-04-07 23:40:07] normalizing counts matrix by depth
INFO [2022-04-07 23:40:07] Computed total sum normalization factor as median libsize: 3615.500000
INFO [2022-04-07 23:40:07] Adding h-spike
INFO [2022-04-07 23:40:07] -hspike modeling of Plasma_ref
INFO [2022-04-07 23:41:38] validating infercnv_obj
INFO [2022-04-07 23:41:38] normalizing counts matrix by depth
INFO [2022-04-07 23:41:38] Using specified normalization factor: 3615.500000
INFO [2022-04-07 23:41:39] 

	STEP 04: log transformation of data

INFO [2022-04-07 23:41:39] transforming log2xplus1()
INFO [2022-04-07 23:41:39] -mirroring for hspike
INFO [2022-04-07 23:41:39] transforming log2xplus1()
INFO [2022-04-07 23:41:40] 

	STEP 08: removing average of reference data (before smoothing)

INFO [2022-04-07 23:41:40] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 23:41:40] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 23:41:43] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 23:42:27] -mirroring for hspike
INFO [2022-04-07 23:42:27] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 23:42:27] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 23:42:29] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 23:42:32] 

	STEP 09: apply max centered expression threshold: 3

INFO [2022-04-07 23:42:32] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 23:42:32] -mirroring for hspike
INFO [2022-04-07 23:42:32] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 23:42:35] 

	STEP 10: Smoothing data per cell by chromosome

INFO [2022-04-07 23:42:35] smooth_by_chromosome: chr: chr1
INFO [2022-04-07 23:42:35] smooth_by_chromosome: chr: chr2
INFO [2022-04-07 23:42:35] smooth_by_chromosome: chr: chr3
INFO [2022-04-07 23:42:35] smooth_by_chromosome: chr: chr4
INFO [2022-04-07 23:42:35] smooth_by_chromosome: chr: chr5
INFO [2022-04-07 23:42:36] smooth_by_chromosome: chr: chr6
INFO [2022-04-07 23:42:36] smooth_by_chromosome: chr: chr7
INFO [2022-04-07 23:42:36] smooth_by_chromosome: chr: chr8
INFO [2022-04-07 23:42:36] smooth_by_chromosome: chr: chr9
INFO [2022-04-07 23:42:36] smooth_by_chromosome: chr: chr10
INFO [2022-04-07 23:42:37] smooth_by_chromosome: chr: chr11
INFO [2022-04-07 23:42:37] smooth_by_chromosome: chr: chr12
INFO [2022-04-07 23:42:37] smooth_by_chromosome: chr: chr13
INFO [2022-04-07 23:42:37] smooth_by_chromosome: chr: chr14
INFO [2022-04-07 23:42:37] smooth_by_chromosome: chr: chr15
INFO [2022-04-07 23:42:38] smooth_by_chromosome: chr: chr16
INFO [2022-04-07 23:42:38] smooth_by_chromosome: chr: chr17
INFO [2022-04-07 23:42:38] smooth_by_chromosome: chr: chr18
INFO [2022-04-07 23:42:38] smooth_by_chromosome: chr: chr19
INFO [2022-04-07 23:42:38] smooth_by_chromosome: chr: chr20
INFO [2022-04-07 23:42:39] smooth_by_chromosome: chr: chr21
INFO [2022-04-07 23:42:39] smooth_by_chromosome: chr: chr22
INFO [2022-04-07 23:42:39] -mirroring for hspike
INFO [2022-04-07 23:42:39] smooth_by_chromosome: chr: chrA
INFO [2022-04-07 23:42:39] smooth_by_chromosome: chr: chr_0
INFO [2022-04-07 23:42:39] smooth_by_chromosome: chr: chr_B
INFO [2022-04-07 23:42:39] smooth_by_chromosome: chr: chr_0pt5
INFO [2022-04-07 23:42:40] smooth_by_chromosome: chr: chr_C
INFO [2022-04-07 23:42:40] smooth_by_chromosome: chr: chr_1pt5
INFO [2022-04-07 23:42:40] smooth_by_chromosome: chr: chr_D
INFO [2022-04-07 23:42:40] smooth_by_chromosome: chr: chr_2pt0
INFO [2022-04-07 23:42:40] smooth_by_chromosome: chr: chr_E
INFO [2022-04-07 23:42:40] smooth_by_chromosome: chr: chr_3pt0
INFO [2022-04-07 23:42:41] smooth_by_chromosome: chr: chr_F
INFO [2022-04-07 23:42:44] 

	STEP 11: re-centering data across chromosome after smoothing

INFO [2022-04-07 23:42:44] ::center_smooth across chromosomes per cell
INFO [2022-04-07 23:42:44] -mirroring for hspike
INFO [2022-04-07 23:42:44] ::center_smooth across chromosomes per cell
INFO [2022-04-07 23:42:47] 

	STEP 12: removing average of reference data (after smoothing)

INFO [2022-04-07 23:42:47] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 23:42:47] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 23:42:50] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 23:42:50] -mirroring for hspike
INFO [2022-04-07 23:42:50] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 23:42:50] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 23:42:53] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 23:42:56] 

	STEP 14: invert log2(FC) to FC

INFO [2022-04-07 23:42:56] invert_log2(), computing 2^x
INFO [2022-04-07 23:42:56] -mirroring for hspike
INFO [2022-04-07 23:42:56] invert_log2(), computing 2^x
INFO [2022-04-07 23:43:00] 

	STEP 15: Clustering samples (not defining tumor subclusters)

INFO [2022-04-07 23:43:00] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 23:43:00] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 23:43:01] cut tree into: 1 groups
INFO [2022-04-07 23:43:01] -processing all_observations,all_observations_s1
INFO [2022-04-07 23:43:01] define_signif_tumor_subclusters(), tumor: Plasma_ref
INFO [2022-04-07 23:43:01] -mirroring for hspike
INFO [2022-04-07 23:43:01] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 23:43:01] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 23:43:01] cut tree into: 1 groups
INFO [2022-04-07 23:43:01] -processing all_observations,all_observations_s1
INFO [2022-04-07 23:43:01] define_signif_tumor_subclusters(), tumor: simnorm_cell_Plasma_ref
INFO [2022-04-07 23:43:01] cut tree into: 1 groups
INFO [2022-04-07 23:43:01] -processing simnorm_cell_Plasma_ref,simnorm_cell_Plasma_ref_s1
INFO [2022-04-07 23:43:08] 

	STEP 17: HMM-based CNV prediction

INFO [2022-04-07 23:43:08] predict_CNV_via_HMM_on_whole_tumor_samples
INFO [2022-04-07 23:43:10] -done predicting CNV based on initial tumor subclusters
INFO [2022-04-07 23:43:10] get_predicted_CNV_regions(consensus)
INFO [2022-04-07 23:43:10] -processing cell_group_name: Plasma_ref, size: 2
INFO [2022-04-07 23:43:18] -processing cell_group_name: Plasma, size: 214
INFO [2022-04-07 23:43:28] -writing cell clusters file: /home/tenggao/paper_data/infercnv_out/37692_Primary_0.9_0/17_HMM_predHMMi6.hmm_mode-samples.cell_groupings
INFO [2022-04-07 23:43:28] -writing cnv regions file: /home/tenggao/paper_data/infercnv_out/37692_Primary_0.9_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_regions.dat
INFO [2022-04-07 23:43:28] -writing per-gene cnv report: /home/tenggao/paper_data/infercnv_out/37692_Primary_0.9_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_genes.dat
INFO [2022-04-07 23:43:28] -writing gene ordering info: /home/tenggao/paper_data/infercnv_out/37692_Primary_0.9_0/17_HMM_predHMMi6.hmm_mode-samples.genes_used.dat
INFO [2022-04-07 23:43:30] ::plot_cnv:Start
INFO [2022-04-07 23:43:30] ::plot_cnv:Current data dimensions (r,c)=10849,216 Total=7034004 Min=1 Max=6.
INFO [2022-04-07 23:43:30] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:43:32] plot_cnv_observation:Start
INFO [2022-04-07 23:43:32] Observation data size: Cells= 214 Genes= 10849
INFO [2022-04-07 23:43:33] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:43:35] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:43:35] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:43:35] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:43:35] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:43:35] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:43:35] Quantiles of plotted data range: 1,3,3,3,6
INFO [2022-04-07 23:43:35] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.9_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.observations.txt
INFO [2022-04-07 23:43:37] plot_cnv_references:Start
INFO [2022-04-07 23:43:37] Reference data size: Cells= 2 Genes= 10849
INFO [2022-04-07 23:43:37] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:43:37] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:43:37] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:43:37] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 23:43:37] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.9_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.references.txt
INFO [2022-04-07 23:43:38] 

	STEP 18: Run Bayesian Network Model on HMM predicted CNVs

INFO [2022-04-07 23:43:39] Initializing new MCM InferCNV Object.
INFO [2022-04-07 23:43:39] validating infercnv_obj
INFO [2022-04-07 23:43:39] Total CNV's:  55
INFO [2022-04-07 23:43:39] Loading BUGS Model.
INFO [2022-04-07 23:43:39] Running Sampling Using Parallel with  30 Cores
INFO [2022-04-07 23:46:04] Obtaining probabilities post-sampling
INFO [2022-04-07 23:46:57] Gibbs sampling time:  3.30057042439779  Minutes
INFO [2022-04-07 23:47:01] ::plot_cnv:Start
INFO [2022-04-07 23:47:01] ::plot_cnv:Current data dimensions (r,c)=10849,216 Total=628350.282510116 Min=0 Max=0.995504345478132.
INFO [2022-04-07 23:47:01] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:47:01] plot_cnv_observation:Start
INFO [2022-04-07 23:47:01] Observation data size: Cells= 214 Genes= 10849
INFO [2022-04-07 23:47:01] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:47:03] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:47:03] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:47:03] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:47:03] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:47:04] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:47:04] Quantiles of plotted data range: 0,0,0,0.726742973366193,0.995504345478132
INFO [2022-04-07 23:47:04] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.9_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.observations.txt
INFO [2022-04-07 23:47:06] plot_cnv_references:Start
INFO [2022-04-07 23:47:06] Reference data size: Cells= 2 Genes= 10849
INFO [2022-04-07 23:47:06] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:47:06] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:47:06] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:47:06] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 23:47:06] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.9_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.references.txt
INFO [2022-04-07 23:47:10] 

	STEP 19: Filter HMM predicted CNVs based on the Bayesian Network Model results and BayesMaxPNormal

INFO [2022-04-07 23:47:10] Attempting to removing CNV(s) with a probability of being normal above  0.5
INFO [2022-04-07 23:47:10] Removing  0  CNV(s) identified by the HMM.
INFO [2022-04-07 23:47:10] Reassigning CNVs based on state probabilities.
INFO [2022-04-07 23:47:10] Creating Plots for CNV and cell Probabilities.
INFO [2022-04-07 23:47:37] ::plot_cnv:Start
INFO [2022-04-07 23:47:37] ::plot_cnv:Current data dimensions (r,c)=10849,216 Total=628350.282510116 Min=0 Max=0.995504345478132.
INFO [2022-04-07 23:47:37] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:47:37] plot_cnv_observation:Start
INFO [2022-04-07 23:47:37] Observation data size: Cells= 214 Genes= 10849
INFO [2022-04-07 23:47:37] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:47:39] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:47:39] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:47:39] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:47:39] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:47:39] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:47:39] Quantiles of plotted data range: 0,0,0,0.726742973366193,0.995504345478132
INFO [2022-04-07 23:47:39] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.9_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.observations.txt
INFO [2022-04-07 23:47:41] plot_cnv_references:Start
INFO [2022-04-07 23:47:41] Reference data size: Cells= 2 Genes= 10849
INFO [2022-04-07 23:47:41] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:47:41] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:47:41] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:47:41] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 23:47:41] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.9_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.references.txt
INFO [2022-04-07 23:47:44] ::plot_cnv:Start
INFO [2022-04-07 23:47:44] ::plot_cnv:Current data dimensions (r,c)=10849,216 Total=7034004 Min=1 Max=6.
INFO [2022-04-07 23:47:44] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:47:46] plot_cnv_observation:Start
INFO [2022-04-07 23:47:46] Observation data size: Cells= 214 Genes= 10849
INFO [2022-04-07 23:47:46] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:47:48] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:47:48] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:47:48] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:47:48] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:47:49] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:47:49] Quantiles of plotted data range: 1,3,3,3,6
INFO [2022-04-07 23:47:49] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.9_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.observations.txt
INFO [2022-04-07 23:47:51] plot_cnv_references:Start
INFO [2022-04-07 23:47:51] Reference data size: Cells= 2 Genes= 10849
INFO [2022-04-07 23:47:51] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:47:51] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:47:51] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:47:51] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 23:47:51] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.9_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.references.txt
INFO [2022-04-07 23:47:51] 

	STEP 20: Converting HMM-based CNV states to repr expr vals

INFO [2022-04-07 23:47:54] ::plot_cnv:Start
INFO [2022-04-07 23:47:54] ::plot_cnv:Current data dimensions (r,c)=10849,216 Total=2346166 Min=0 Max=3.
INFO [2022-04-07 23:47:54] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:47:56] plot_cnv_observation:Start
INFO [2022-04-07 23:47:56] Observation data size: Cells= 214 Genes= 10849
INFO [2022-04-07 23:47:56] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:47:58] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:47:58] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:47:58] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:47:58] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:47:58] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:47:58] Quantiles of plotted data range: 0,1,1,1,3
INFO [2022-04-07 23:47:59] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.9_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.observations.txt
INFO [2022-04-07 23:48:01] plot_cnv_references:Start
INFO [2022-04-07 23:48:01] Reference data size: Cells= 2 Genes= 10849
INFO [2022-04-07 23:48:01] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:48:01] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:48:01] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:48:01] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 23:48:01] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.9_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.references.txt
INFO [2022-04-07 23:48:01] 

	STEP 22: Denoising

INFO [2022-04-07 23:48:01] ::process_data:Remove noise, noise threshold defined via ref mean sd_amplifier:  1.5
INFO [2022-04-07 23:48:01] denoising using mean(normal) +- sd_amplifier * sd(normal) per gene per cell across all data
INFO [2022-04-07 23:48:01] :: **** clear_noise_via_ref_quantiles **** : removing noise between bounds:  1 - 1
INFO [2022-04-07 23:48:08] 

## Making the final infercnv heatmap ##
INFO [2022-04-07 23:48:09] ::plot_cnv:Start
INFO [2022-04-07 23:48:09] ::plot_cnv:Current data dimensions (r,c)=10849,216 Total=2342129.83632576 Min=0.724659662903715 Max=1.36541792245349.
INFO [2022-04-07 23:48:09] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:48:11] plot_cnv(): auto thresholding at: (0.869682 , 1.130318)
INFO [2022-04-07 23:48:11] plot_cnv_observation:Start
INFO [2022-04-07 23:48:11] Observation data size: Cells= 214 Genes= 10849
INFO [2022-04-07 23:48:11] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:48:13] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:48:13] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:48:13] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:48:13] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:48:14] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:48:14] Quantiles of plotted data range: 0.869682293139344,0.974001157898776,1,1.0267906822854,1.13031770686066
INFO [2022-04-07 23:48:14] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.9_0/infercnv.observations.txt
INFO [2022-04-07 23:48:16] plot_cnv_references:Start
INFO [2022-04-07 23:48:16] Reference data size: Cells= 2 Genes= 10849
INFO [2022-04-07 23:48:16] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:48:16] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:48:16] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:48:16] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 23:48:16] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/37692_Primary_0.9_0/infercnv.references.txt
INFO [2022-04-07 23:48:17] Parsing gene order file: /home/tenggao/inferCNV/hg38_gene_order.txt
INFO [2022-04-07 23:48:17] Parsing cell annotations file: /home/tenggao/paper_data/infercnv_out/58408_Primary_0.1_0/58408_Primary_annot.tsv
INFO [2022-04-07 23:48:17] ::order_reduce:Start.
INFO [2022-04-07 23:48:17] .order_reduce(): expr and order match.
INFO [2022-04-07 23:48:17] ::process_data:order_reduce:Reduction from positional data, new dimensions (r,c) = 21034,416 Total=179981720 Min=0 Max=6089512.
INFO [2022-04-07 23:48:17] num genes removed taking into account provided gene ordering list: 2169 = 10.3118760102691% removed.
INFO [2022-04-07 23:48:17] -filtering out cells < 100 or > Inf, removing 0 % of cells
INFO [2022-04-07 23:48:17] validating infercnv_obj
INFO [2022-04-07 23:48:17] ::process_data:Start
INFO [2022-04-07 23:48:17] 

	STEP 1: incoming data

INFO [2022-04-07 23:48:17] 

	STEP 02: Removing lowly expressed genes

INFO [2022-04-07 23:48:17] ::above_min_mean_expr_cutoff:Start
INFO [2022-04-07 23:48:18] Removing 4902 genes from matrix as below mean expr threshold: 0.1
INFO [2022-04-07 23:48:18] validating infercnv_obj
INFO [2022-04-07 23:48:18] There are 13963 genes and 416 cells remaining in the expr matrix.
INFO [2022-04-07 23:48:18] Removed 2455 genes having fewer than 3 min cells per gene = 17.5822 % genes removed here
INFO [2022-04-07 23:48:18] validating infercnv_obj
INFO [2022-04-07 23:48:18] 

	STEP 03: normalization by sequencing depth

INFO [2022-04-07 23:48:18] normalizing counts matrix by depth
INFO [2022-04-07 23:48:18] Computed total sum normalization factor as median libsize: 2871.000000
INFO [2022-04-07 23:48:18] Adding h-spike
INFO [2022-04-07 23:48:18] -hspike modeling of Plasma_ref
INFO [2022-04-07 23:49:56] validating infercnv_obj
INFO [2022-04-07 23:49:56] normalizing counts matrix by depth
INFO [2022-04-07 23:49:56] Using specified normalization factor: 2871.000000
INFO [2022-04-07 23:49:57] 

	STEP 04: log transformation of data

INFO [2022-04-07 23:49:57] transforming log2xplus1()
INFO [2022-04-07 23:49:57] -mirroring for hspike
INFO [2022-04-07 23:49:57] transforming log2xplus1()
INFO [2022-04-07 23:49:59] 

	STEP 08: removing average of reference data (before smoothing)

INFO [2022-04-07 23:49:59] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 23:49:59] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 23:50:03] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 23:51:47] -mirroring for hspike
INFO [2022-04-07 23:51:47] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 23:51:47] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 23:51:50] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 23:51:53] 

	STEP 09: apply max centered expression threshold: 3

INFO [2022-04-07 23:51:53] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 23:51:53] -mirroring for hspike
INFO [2022-04-07 23:51:53] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-07 23:51:56] 

	STEP 10: Smoothing data per cell by chromosome

INFO [2022-04-07 23:51:56] smooth_by_chromosome: chr: chr1
INFO [2022-04-07 23:51:57] smooth_by_chromosome: chr: chr2
INFO [2022-04-07 23:51:57] smooth_by_chromosome: chr: chr3
INFO [2022-04-07 23:51:58] smooth_by_chromosome: chr: chr4
INFO [2022-04-07 23:51:58] smooth_by_chromosome: chr: chr5
INFO [2022-04-07 23:51:58] smooth_by_chromosome: chr: chr6
INFO [2022-04-07 23:51:59] smooth_by_chromosome: chr: chr7
INFO [2022-04-07 23:51:59] smooth_by_chromosome: chr: chr8
INFO [2022-04-07 23:51:59] smooth_by_chromosome: chr: chr9
INFO [2022-04-07 23:52:00] smooth_by_chromosome: chr: chr10
INFO [2022-04-07 23:52:00] smooth_by_chromosome: chr: chr11
INFO [2022-04-07 23:52:01] smooth_by_chromosome: chr: chr12
INFO [2022-04-07 23:52:01] smooth_by_chromosome: chr: chr13
INFO [2022-04-07 23:52:01] smooth_by_chromosome: chr: chr14
INFO [2022-04-07 23:52:02] smooth_by_chromosome: chr: chr15
INFO [2022-04-07 23:52:02] smooth_by_chromosome: chr: chr16
INFO [2022-04-07 23:52:02] smooth_by_chromosome: chr: chr17
INFO [2022-04-07 23:52:03] smooth_by_chromosome: chr: chr18
INFO [2022-04-07 23:52:03] smooth_by_chromosome: chr: chr19
INFO [2022-04-07 23:52:04] smooth_by_chromosome: chr: chr20
INFO [2022-04-07 23:52:04] smooth_by_chromosome: chr: chr21
INFO [2022-04-07 23:52:04] smooth_by_chromosome: chr: chr22
INFO [2022-04-07 23:52:05] -mirroring for hspike
INFO [2022-04-07 23:52:05] smooth_by_chromosome: chr: chrA
INFO [2022-04-07 23:52:05] smooth_by_chromosome: chr: chr_0
INFO [2022-04-07 23:52:05] smooth_by_chromosome: chr: chr_B
INFO [2022-04-07 23:52:05] smooth_by_chromosome: chr: chr_0pt5
INFO [2022-04-07 23:52:05] smooth_by_chromosome: chr: chr_C
INFO [2022-04-07 23:52:06] smooth_by_chromosome: chr: chr_1pt5
INFO [2022-04-07 23:52:06] smooth_by_chromosome: chr: chr_D
INFO [2022-04-07 23:52:06] smooth_by_chromosome: chr: chr_2pt0
INFO [2022-04-07 23:52:06] smooth_by_chromosome: chr: chr_E
INFO [2022-04-07 23:52:06] smooth_by_chromosome: chr: chr_3pt0
INFO [2022-04-07 23:52:06] smooth_by_chromosome: chr: chr_F
INFO [2022-04-07 23:52:11] 

	STEP 11: re-centering data across chromosome after smoothing

INFO [2022-04-07 23:52:11] ::center_smooth across chromosomes per cell
INFO [2022-04-07 23:52:11] -mirroring for hspike
INFO [2022-04-07 23:52:11] ::center_smooth across chromosomes per cell
INFO [2022-04-07 23:52:15] 

	STEP 12: removing average of reference data (after smoothing)

INFO [2022-04-07 23:52:15] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 23:52:15] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 23:52:18] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 23:52:19] -mirroring for hspike
INFO [2022-04-07 23:52:19] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-07 23:52:19] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-07 23:52:21] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-07 23:52:26] 

	STEP 14: invert log2(FC) to FC

INFO [2022-04-07 23:52:26] invert_log2(), computing 2^x
INFO [2022-04-07 23:52:26] -mirroring for hspike
INFO [2022-04-07 23:52:26] invert_log2(), computing 2^x
INFO [2022-04-07 23:52:32] 

	STEP 15: Clustering samples (not defining tumor subclusters)

INFO [2022-04-07 23:52:32] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 23:52:32] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 23:52:37] cut tree into: 1 groups
INFO [2022-04-07 23:52:37] -processing all_observations,all_observations_s1
INFO [2022-04-07 23:52:37] define_signif_tumor_subclusters(), tumor: Plasma_ref
INFO [2022-04-07 23:52:37] -mirroring for hspike
INFO [2022-04-07 23:52:37] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-07 23:52:37] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-07 23:52:37] cut tree into: 1 groups
INFO [2022-04-07 23:52:37] -processing all_observations,all_observations_s1
INFO [2022-04-07 23:52:37] define_signif_tumor_subclusters(), tumor: simnorm_cell_Plasma_ref
INFO [2022-04-07 23:52:37] cut tree into: 1 groups
INFO [2022-04-07 23:52:37] -processing simnorm_cell_Plasma_ref,simnorm_cell_Plasma_ref_s1
INFO [2022-04-07 23:52:49] 

	STEP 17: HMM-based CNV prediction

INFO [2022-04-07 23:52:49] predict_CNV_via_HMM_on_whole_tumor_samples
INFO [2022-04-07 23:52:50] -done predicting CNV based on initial tumor subclusters
INFO [2022-04-07 23:52:50] get_predicted_CNV_regions(consensus)
INFO [2022-04-07 23:52:50] -processing cell_group_name: Plasma_ref, size: 2
INFO [2022-04-07 23:52:59] -processing cell_group_name: Plasma, size: 414
INFO [2022-04-07 23:53:11] -writing cell clusters file: /home/tenggao/paper_data/infercnv_out/58408_Primary_0.1_0/17_HMM_predHMMi6.hmm_mode-samples.cell_groupings
INFO [2022-04-07 23:53:11] -writing cnv regions file: /home/tenggao/paper_data/infercnv_out/58408_Primary_0.1_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_regions.dat
INFO [2022-04-07 23:53:11] -writing per-gene cnv report: /home/tenggao/paper_data/infercnv_out/58408_Primary_0.1_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_genes.dat
INFO [2022-04-07 23:53:11] -writing gene ordering info: /home/tenggao/paper_data/infercnv_out/58408_Primary_0.1_0/17_HMM_predHMMi6.hmm_mode-samples.genes_used.dat
INFO [2022-04-07 23:53:14] ::plot_cnv:Start
INFO [2022-04-07 23:53:14] ::plot_cnv:Current data dimensions (r,c)=11508,416 Total=14400072 Min=1 Max=5.
INFO [2022-04-07 23:53:14] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:53:18] plot_cnv_observation:Start
INFO [2022-04-07 23:53:18] Observation data size: Cells= 414 Genes= 11508
INFO [2022-04-07 23:53:18] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:53:22] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:53:22] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:53:22] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:53:22] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:53:23] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:53:23] Quantiles of plotted data range: 1,3,3,3,5
INFO [2022-04-07 23:53:23] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.1_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.observations.txt
INFO [2022-04-07 23:53:28] plot_cnv_references:Start
INFO [2022-04-07 23:53:28] Reference data size: Cells= 2 Genes= 11508
INFO [2022-04-07 23:53:28] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:53:28] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:53:28] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:53:28] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 23:53:28] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.1_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.references.txt
INFO [2022-04-07 23:53:28] 

	STEP 18: Run Bayesian Network Model on HMM predicted CNVs

INFO [2022-04-07 23:53:30] Initializing new MCM InferCNV Object.
INFO [2022-04-07 23:53:30] validating infercnv_obj
INFO [2022-04-07 23:53:30] Total CNV's:  31
INFO [2022-04-07 23:53:30] Loading BUGS Model.
INFO [2022-04-07 23:53:30] Running Sampling Using Parallel with  30 Cores
INFO [2022-04-07 23:55:33] Obtaining probabilities post-sampling
INFO [2022-04-07 23:56:31] Gibbs sampling time:  3.0171656092008  Minutes
INFO [2022-04-07 23:56:37] ::plot_cnv:Start
INFO [2022-04-07 23:56:37] ::plot_cnv:Current data dimensions (r,c)=11508,416 Total=411547.778788283 Min=0 Max=0.930433293105881.
INFO [2022-04-07 23:56:37] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:56:37] plot_cnv_observation:Start
INFO [2022-04-07 23:56:37] Observation data size: Cells= 414 Genes= 11508
INFO [2022-04-07 23:56:37] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:56:40] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:56:40] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:56:40] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:56:40] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:56:41] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:56:41] Quantiles of plotted data range: 0,0,0,0,0.930433293105881
INFO [2022-04-07 23:56:41] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.1_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.observations.txt
INFO [2022-04-07 23:56:45] plot_cnv_references:Start
INFO [2022-04-07 23:56:45] Reference data size: Cells= 2 Genes= 11508
INFO [2022-04-07 23:56:45] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:56:45] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:56:45] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:56:45] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 23:56:45] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.1_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.references.txt
INFO [2022-04-07 23:56:51] 

	STEP 19: Filter HMM predicted CNVs based on the Bayesian Network Model results and BayesMaxPNormal

INFO [2022-04-07 23:56:51] Attempting to removing CNV(s) with a probability of being normal above  0.5
INFO [2022-04-07 23:56:51] Removing  1  CNV(s) identified by the HMM.
INFO [2022-04-07 23:56:51] Total CNV's after removing:  30
INFO [2022-04-07 23:56:51] Reassigning CNVs based on state probabilities.
INFO [2022-04-07 23:56:51] Changing the following CNV's states assigned by the HMM to the following based on the CNV's state probabilities.
 chr6-region_44 : 1  (P= 0.029591563794564 ) ->  2 (P= 0.658747399649964 )
chr22-region_92 : 4  (P= 0.288342302061178 ) ->  3 (P= 0.375552119139274 )
INFO [2022-04-07 23:56:51] Creating Plots for CNV and cell Probabilities.
INFO [2022-04-07 23:57:10] ::plot_cnv:Start
INFO [2022-04-07 23:57:10] ::plot_cnv:Current data dimensions (r,c)=11508,416 Total=401761.707247813 Min=0 Max=0.930433293105881.
INFO [2022-04-07 23:57:10] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:57:11] plot_cnv_observation:Start
INFO [2022-04-07 23:57:11] Observation data size: Cells= 414 Genes= 11508
INFO [2022-04-07 23:57:11] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:57:14] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:57:14] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:57:14] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:57:14] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:57:15] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:57:15] Quantiles of plotted data range: 0,0,0,0,0.930433293105881
INFO [2022-04-07 23:57:15] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.1_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.observations.txt
INFO [2022-04-07 23:57:19] plot_cnv_references:Start
INFO [2022-04-07 23:57:19] Reference data size: Cells= 2 Genes= 11508
INFO [2022-04-07 23:57:19] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:57:19] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:57:19] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:57:19] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-07 23:57:19] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.1_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.references.txt
INFO [2022-04-07 23:57:22] ::plot_cnv:Start
INFO [2022-04-07 23:57:22] ::plot_cnv:Current data dimensions (r,c)=11508,416 Total=14389722 Min=1 Max=5.
INFO [2022-04-07 23:57:22] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:57:26] plot_cnv_observation:Start
INFO [2022-04-07 23:57:26] Observation data size: Cells= 414 Genes= 11508
INFO [2022-04-07 23:57:26] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:57:30] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:57:30] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:57:30] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:57:30] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:57:31] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:57:31] Quantiles of plotted data range: 1,3,3,3,5
INFO [2022-04-07 23:57:31] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.1_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.observations.txt
INFO [2022-04-07 23:57:36] plot_cnv_references:Start
INFO [2022-04-07 23:57:36] Reference data size: Cells= 2 Genes= 11508
INFO [2022-04-07 23:57:36] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:57:36] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:57:36] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:57:36] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-07 23:57:36] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.1_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.references.txt
INFO [2022-04-07 23:57:36] 

	STEP 20: Converting HMM-based CNV states to repr expr vals

INFO [2022-04-07 23:57:39] ::plot_cnv:Start
INFO [2022-04-07 23:57:39] ::plot_cnv:Current data dimensions (r,c)=11508,416 Total=4801197 Min=0 Max=2.
INFO [2022-04-07 23:57:39] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:57:43] plot_cnv_observation:Start
INFO [2022-04-07 23:57:43] Observation data size: Cells= 414 Genes= 11508
INFO [2022-04-07 23:57:43] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:57:47] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:57:47] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:57:47] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:57:47] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:57:48] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:57:48] Quantiles of plotted data range: 0,1,1,1,2
INFO [2022-04-07 23:57:48] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.1_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.observations.txt
INFO [2022-04-07 23:57:52] plot_cnv_references:Start
INFO [2022-04-07 23:57:52] Reference data size: Cells= 2 Genes= 11508
INFO [2022-04-07 23:57:52] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:57:52] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:57:52] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:57:52] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 23:57:52] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.1_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.references.txt
INFO [2022-04-07 23:57:52] 

	STEP 22: Denoising

INFO [2022-04-07 23:57:52] ::process_data:Remove noise, noise threshold defined via ref mean sd_amplifier:  1.5
INFO [2022-04-07 23:57:52] denoising using mean(normal) +- sd_amplifier * sd(normal) per gene per cell across all data
INFO [2022-04-07 23:57:52] :: **** clear_noise_via_ref_quantiles **** : removing noise between bounds:  1 - 1
INFO [2022-04-07 23:58:04] 

## Making the final infercnv heatmap ##
INFO [2022-04-07 23:58:04] ::plot_cnv:Start
INFO [2022-04-07 23:58:04] ::plot_cnv:Current data dimensions (r,c)=11508,416 Total=4791135.00571554 Min=0.779395219435906 Max=1.25691544903908.
INFO [2022-04-07 23:58:04] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-07 23:58:09] plot_cnv(): auto thresholding at: (0.918348 , 1.081652)
INFO [2022-04-07 23:58:09] plot_cnv_observation:Start
INFO [2022-04-07 23:58:09] Observation data size: Cells= 414 Genes= 11508
INFO [2022-04-07 23:58:09] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-07 23:58:14] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-07 23:58:14] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-07 23:58:14] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-07 23:58:14] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-07 23:58:14] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:58:14] Quantiles of plotted data range: 0.918348363414698,0.981389199582341,1,1.01962678399175,1.0816516365853
INFO [2022-04-07 23:58:15] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.1_0/infercnv.observations.txt
INFO [2022-04-07 23:58:20] plot_cnv_references:Start
INFO [2022-04-07 23:58:20] Reference data size: Cells= 2 Genes= 11508
INFO [2022-04-07 23:58:20] plot_cnv_references:Number reference groups= 1
INFO [2022-04-07 23:58:20] plot_cnv_references:Plotting heatmap.
INFO [2022-04-07 23:58:20] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-07 23:58:20] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-07 23:58:20] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.1_0/infercnv.references.txt
INFO [2022-04-07 23:58:20] Parsing gene order file: /home/tenggao/inferCNV/hg38_gene_order.txt
INFO [2022-04-07 23:58:20] Parsing cell annotations file: /home/tenggao/paper_data/infercnv_out/58408_Primary_0.3_0/58408_Primary_annot.tsv
INFO [2022-04-07 23:58:20] ::order_reduce:Start.
INFO [2022-04-07 23:58:20] .order_reduce(): expr and order match.
INFO [2022-04-07 23:58:20] ::process_data:order_reduce:Reduction from positional data, new dimensions (r,c) = 21034,416 Total=180192365 Min=0 Max=6089512.
INFO [2022-04-07 23:58:20] num genes removed taking into account provided gene ordering list: 2169 = 10.3118760102691% removed.
INFO [2022-04-07 23:58:20] -filtering out cells < 100 or > Inf, removing 0 % of cells
INFO [2022-04-07 23:58:20] validating infercnv_obj
INFO [2022-04-07 23:58:20] ::process_data:Start
INFO [2022-04-07 23:58:20] 

	STEP 1: incoming data

INFO [2022-04-07 23:58:21] 

	STEP 02: Removing lowly expressed genes

INFO [2022-04-07 23:58:21] ::above_min_mean_expr_cutoff:Start
INFO [2022-04-07 23:58:21] Removing 4889 genes from matrix as below mean expr threshold: 0.1
INFO [2022-04-07 23:58:21] validating infercnv_obj
INFO [2022-04-07 23:58:21] There are 13976 genes and 416 cells remaining in the expr matrix.
INFO [2022-04-07 23:58:21] Removed 2295 genes having fewer than 3 min cells per gene = 16.421 % genes removed here
INFO [2022-04-07 23:58:21] validating infercnv_obj
INFO [2022-04-07 23:58:22] 

	STEP 03: normalization by sequencing depth

INFO [2022-04-07 23:58:22] normalizing counts matrix by depth
INFO [2022-04-07 23:58:22] Computed total sum normalization factor as median libsize: 3158.500000
INFO [2022-04-07 23:58:22] Adding h-spike
INFO [2022-04-07 23:58:22] -hspike modeling of Plasma_ref
INFO [2022-04-08 00:00:01] validating infercnv_obj
INFO [2022-04-08 00:00:01] normalizing counts matrix by depth
INFO [2022-04-08 00:00:01] Using specified normalization factor: 3158.500000
INFO [2022-04-08 00:00:02] 

	STEP 04: log transformation of data

INFO [2022-04-08 00:00:02] transforming log2xplus1()
INFO [2022-04-08 00:00:02] -mirroring for hspike
INFO [2022-04-08 00:00:02] transforming log2xplus1()
INFO [2022-04-08 00:00:04] 

	STEP 08: removing average of reference data (before smoothing)

INFO [2022-04-08 00:00:04] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-08 00:00:04] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-08 00:00:07] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-08 00:01:55] -mirroring for hspike
INFO [2022-04-08 00:01:55] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-08 00:01:55] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-08 00:01:57] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-08 00:02:01] 

	STEP 09: apply max centered expression threshold: 3

INFO [2022-04-08 00:02:01] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-08 00:02:01] -mirroring for hspike
INFO [2022-04-08 00:02:01] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-08 00:02:04] 

	STEP 10: Smoothing data per cell by chromosome

INFO [2022-04-08 00:02:04] smooth_by_chromosome: chr: chr1
INFO [2022-04-08 00:02:05] smooth_by_chromosome: chr: chr2
INFO [2022-04-08 00:02:05] smooth_by_chromosome: chr: chr3
INFO [2022-04-08 00:02:06] smooth_by_chromosome: chr: chr4
INFO [2022-04-08 00:02:06] smooth_by_chromosome: chr: chr5
INFO [2022-04-08 00:02:06] smooth_by_chromosome: chr: chr6
INFO [2022-04-08 00:02:07] smooth_by_chromosome: chr: chr7
INFO [2022-04-08 00:02:07] smooth_by_chromosome: chr: chr8
INFO [2022-04-08 00:02:07] smooth_by_chromosome: chr: chr9
INFO [2022-04-08 00:02:08] smooth_by_chromosome: chr: chr10
INFO [2022-04-08 00:02:08] smooth_by_chromosome: chr: chr11
INFO [2022-04-08 00:02:09] smooth_by_chromosome: chr: chr12
INFO [2022-04-08 00:02:09] smooth_by_chromosome: chr: chr13
INFO [2022-04-08 00:02:09] smooth_by_chromosome: chr: chr14
INFO [2022-04-08 00:02:10] smooth_by_chromosome: chr: chr15
INFO [2022-04-08 00:02:10] smooth_by_chromosome: chr: chr16
INFO [2022-04-08 00:02:10] smooth_by_chromosome: chr: chr17
INFO [2022-04-08 00:02:11] smooth_by_chromosome: chr: chr18
INFO [2022-04-08 00:02:11] smooth_by_chromosome: chr: chr19
INFO [2022-04-08 00:02:12] smooth_by_chromosome: chr: chr20
INFO [2022-04-08 00:02:12] smooth_by_chromosome: chr: chr21
INFO [2022-04-08 00:02:12] smooth_by_chromosome: chr: chr22
INFO [2022-04-08 00:02:13] -mirroring for hspike
INFO [2022-04-08 00:02:13] smooth_by_chromosome: chr: chrA
INFO [2022-04-08 00:02:13] smooth_by_chromosome: chr: chr_0
INFO [2022-04-08 00:02:13] smooth_by_chromosome: chr: chr_B
INFO [2022-04-08 00:02:13] smooth_by_chromosome: chr: chr_0pt5
INFO [2022-04-08 00:02:13] smooth_by_chromosome: chr: chr_C
INFO [2022-04-08 00:02:13] smooth_by_chromosome: chr: chr_1pt5
INFO [2022-04-08 00:02:14] smooth_by_chromosome: chr: chr_D
INFO [2022-04-08 00:02:14] smooth_by_chromosome: chr: chr_2pt0
INFO [2022-04-08 00:02:14] smooth_by_chromosome: chr: chr_E
INFO [2022-04-08 00:02:14] smooth_by_chromosome: chr: chr_3pt0
INFO [2022-04-08 00:02:14] smooth_by_chromosome: chr: chr_F
INFO [2022-04-08 00:02:19] 

	STEP 11: re-centering data across chromosome after smoothing

INFO [2022-04-08 00:02:19] ::center_smooth across chromosomes per cell
INFO [2022-04-08 00:02:19] -mirroring for hspike
INFO [2022-04-08 00:02:19] ::center_smooth across chromosomes per cell
INFO [2022-04-08 00:02:23] 

	STEP 12: removing average of reference data (after smoothing)

INFO [2022-04-08 00:02:23] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-08 00:02:23] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-08 00:02:26] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-08 00:02:27] -mirroring for hspike
INFO [2022-04-08 00:02:27] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-08 00:02:27] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-08 00:02:30] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-08 00:02:34] 

	STEP 14: invert log2(FC) to FC

INFO [2022-04-08 00:02:34] invert_log2(), computing 2^x
INFO [2022-04-08 00:02:35] -mirroring for hspike
INFO [2022-04-08 00:02:35] invert_log2(), computing 2^x
INFO [2022-04-08 00:02:41] 

	STEP 15: Clustering samples (not defining tumor subclusters)

INFO [2022-04-08 00:02:41] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-08 00:02:41] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-08 00:02:46] cut tree into: 1 groups
INFO [2022-04-08 00:02:46] -processing all_observations,all_observations_s1
INFO [2022-04-08 00:02:46] define_signif_tumor_subclusters(), tumor: Plasma_ref
INFO [2022-04-08 00:02:46] -mirroring for hspike
INFO [2022-04-08 00:02:46] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-08 00:02:46] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-08 00:02:46] cut tree into: 1 groups
INFO [2022-04-08 00:02:46] -processing all_observations,all_observations_s1
INFO [2022-04-08 00:02:46] define_signif_tumor_subclusters(), tumor: simnorm_cell_Plasma_ref
INFO [2022-04-08 00:02:46] cut tree into: 1 groups
INFO [2022-04-08 00:02:46] -processing simnorm_cell_Plasma_ref,simnorm_cell_Plasma_ref_s1
INFO [2022-04-08 00:02:57] 

	STEP 17: HMM-based CNV prediction

INFO [2022-04-08 00:02:57] predict_CNV_via_HMM_on_whole_tumor_samples
INFO [2022-04-08 00:02:59] -done predicting CNV based on initial tumor subclusters
INFO [2022-04-08 00:02:59] get_predicted_CNV_regions(consensus)
INFO [2022-04-08 00:02:59] -processing cell_group_name: Plasma_ref, size: 2
INFO [2022-04-08 00:03:08] -processing cell_group_name: Plasma, size: 414
INFO [2022-04-08 00:03:20] -writing cell clusters file: /home/tenggao/paper_data/infercnv_out/58408_Primary_0.3_0/17_HMM_predHMMi6.hmm_mode-samples.cell_groupings
INFO [2022-04-08 00:03:20] -writing cnv regions file: /home/tenggao/paper_data/infercnv_out/58408_Primary_0.3_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_regions.dat
INFO [2022-04-08 00:03:20] -writing per-gene cnv report: /home/tenggao/paper_data/infercnv_out/58408_Primary_0.3_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_genes.dat
INFO [2022-04-08 00:03:20] -writing gene ordering info: /home/tenggao/paper_data/infercnv_out/58408_Primary_0.3_0/17_HMM_predHMMi6.hmm_mode-samples.genes_used.dat
INFO [2022-04-08 00:03:23] ::plot_cnv:Start
INFO [2022-04-08 00:03:23] ::plot_cnv:Current data dimensions (r,c)=11681,416 Total=14658618 Min=1 Max=5.
INFO [2022-04-08 00:03:23] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-08 00:03:27] plot_cnv_observation:Start
INFO [2022-04-08 00:03:27] Observation data size: Cells= 414 Genes= 11681
INFO [2022-04-08 00:03:28] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-08 00:03:32] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-08 00:03:32] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-08 00:03:32] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-08 00:03:32] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-08 00:03:32] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:03:32] Quantiles of plotted data range: 1,3,3,3,5
INFO [2022-04-08 00:03:33] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.3_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.observations.txt
INFO [2022-04-08 00:03:37] plot_cnv_references:Start
INFO [2022-04-08 00:03:37] Reference data size: Cells= 2 Genes= 11681
INFO [2022-04-08 00:03:37] plot_cnv_references:Number reference groups= 1
INFO [2022-04-08 00:03:37] plot_cnv_references:Plotting heatmap.
INFO [2022-04-08 00:03:37] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:03:37] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-08 00:03:37] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.3_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.references.txt
INFO [2022-04-08 00:03:38] 

	STEP 18: Run Bayesian Network Model on HMM predicted CNVs

INFO [2022-04-08 00:03:39] Initializing new MCM InferCNV Object.
INFO [2022-04-08 00:03:39] validating infercnv_obj
INFO [2022-04-08 00:03:39] Total CNV's:  31
INFO [2022-04-08 00:03:39] Loading BUGS Model.
INFO [2022-04-08 00:03:39] Running Sampling Using Parallel with  30 Cores
INFO [2022-04-08 00:06:23] Obtaining probabilities post-sampling
INFO [2022-04-08 00:07:21] Gibbs sampling time:  3.7001735885938  Minutes
INFO [2022-04-08 00:07:27] ::plot_cnv:Start
INFO [2022-04-08 00:07:27] ::plot_cnv:Current data dimensions (r,c)=11681,416 Total=487122.919075155 Min=0 Max=0.943902758095016.
INFO [2022-04-08 00:07:27] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-08 00:07:27] plot_cnv_observation:Start
INFO [2022-04-08 00:07:27] Observation data size: Cells= 414 Genes= 11681
INFO [2022-04-08 00:07:27] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-08 00:07:31] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-08 00:07:31] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-08 00:07:31] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-08 00:07:31] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-08 00:07:31] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:07:31] Quantiles of plotted data range: 0,0,0,0,0.943902758095016
INFO [2022-04-08 00:07:32] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.3_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.observations.txt
INFO [2022-04-08 00:07:35] plot_cnv_references:Start
INFO [2022-04-08 00:07:35] Reference data size: Cells= 2 Genes= 11681
INFO [2022-04-08 00:07:35] plot_cnv_references:Number reference groups= 1
INFO [2022-04-08 00:07:35] plot_cnv_references:Plotting heatmap.
INFO [2022-04-08 00:07:35] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:07:35] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-08 00:07:35] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.3_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.references.txt
INFO [2022-04-08 00:07:41] 

	STEP 19: Filter HMM predicted CNVs based on the Bayesian Network Model results and BayesMaxPNormal

INFO [2022-04-08 00:07:41] Attempting to removing CNV(s) with a probability of being normal above  0.5
INFO [2022-04-08 00:07:41] Removing  1  CNV(s) identified by the HMM.
INFO [2022-04-08 00:07:41] Total CNV's after removing:  30
INFO [2022-04-08 00:07:41] Reassigning CNVs based on state probabilities.
INFO [2022-04-08 00:07:41] Changing the following CNV's states assigned by the HMM to the following based on the CNV's state probabilities.
 chr1-region_27 : 2  (P= 0.174437530673553 ) ->  1 (P= 0.448512157967854 )
chr6-region_45 : 2  (P= 0.338407203991164 ) ->  1 (P= 0.36969538258338 )
chr11-region_57 : 2  (P= 0.309456354654963 ) ->  1 (P= 0.342354777786311 )
chr15-region_67 : 4  (P= 0.342867565783766 ) ->  3 (P= 0.488738780157339 )
chr22-region_92 : 4  (P= 0.25414052932682 ) ->  3 (P= 0.439364271234527 )
INFO [2022-04-08 00:07:41] Creating Plots for CNV and cell Probabilities.
INFO [2022-04-08 00:08:00] ::plot_cnv:Start
INFO [2022-04-08 00:08:00] ::plot_cnv:Current data dimensions (r,c)=11681,416 Total=477257.517931053 Min=0 Max=0.943902758095016.
INFO [2022-04-08 00:08:00] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-08 00:08:00] plot_cnv_observation:Start
INFO [2022-04-08 00:08:00] Observation data size: Cells= 414 Genes= 11681
INFO [2022-04-08 00:08:01] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-08 00:08:04] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-08 00:08:04] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-08 00:08:04] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-08 00:08:04] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-08 00:08:05] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:08:05] Quantiles of plotted data range: 0,0,0,0,0.943902758095016
INFO [2022-04-08 00:08:05] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.3_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.observations.txt
INFO [2022-04-08 00:08:09] plot_cnv_references:Start
INFO [2022-04-08 00:08:09] Reference data size: Cells= 2 Genes= 11681
INFO [2022-04-08 00:08:09] plot_cnv_references:Number reference groups= 1
INFO [2022-04-08 00:08:09] plot_cnv_references:Plotting heatmap.
INFO [2022-04-08 00:08:09] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:08:09] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-08 00:08:09] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.3_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.references.txt
INFO [2022-04-08 00:08:12] ::plot_cnv:Start
INFO [2022-04-08 00:08:12] ::plot_cnv:Current data dimensions (r,c)=11681,416 Total=14515788 Min=1 Max=5.
INFO [2022-04-08 00:08:12] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-08 00:08:17] plot_cnv_observation:Start
INFO [2022-04-08 00:08:17] Observation data size: Cells= 414 Genes= 11681
INFO [2022-04-08 00:08:17] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-08 00:08:21] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-08 00:08:21] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-08 00:08:21] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-08 00:08:21] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-08 00:08:21] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:08:21] Quantiles of plotted data range: 1,3,3,3,5
INFO [2022-04-08 00:08:22] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.3_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.observations.txt
INFO [2022-04-08 00:08:26] plot_cnv_references:Start
INFO [2022-04-08 00:08:26] Reference data size: Cells= 2 Genes= 11681
INFO [2022-04-08 00:08:26] plot_cnv_references:Number reference groups= 1
INFO [2022-04-08 00:08:26] plot_cnv_references:Plotting heatmap.
INFO [2022-04-08 00:08:26] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:08:26] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-08 00:08:26] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.3_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.references.txt
INFO [2022-04-08 00:08:26] 

	STEP 20: Converting HMM-based CNV states to repr expr vals

INFO [2022-04-08 00:08:30] ::plot_cnv:Start
INFO [2022-04-08 00:08:30] ::plot_cnv:Current data dimensions (r,c)=11681,416 Total=4828246 Min=0 Max=2.
INFO [2022-04-08 00:08:30] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-08 00:08:34] plot_cnv_observation:Start
INFO [2022-04-08 00:08:34] Observation data size: Cells= 414 Genes= 11681
INFO [2022-04-08 00:08:34] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-08 00:08:38] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-08 00:08:38] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-08 00:08:38] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-08 00:08:38] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-08 00:08:38] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:08:38] Quantiles of plotted data range: 0,1,1,1,2
INFO [2022-04-08 00:08:39] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.3_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.observations.txt
INFO [2022-04-08 00:08:43] plot_cnv_references:Start
INFO [2022-04-08 00:08:43] Reference data size: Cells= 2 Genes= 11681
INFO [2022-04-08 00:08:43] plot_cnv_references:Number reference groups= 1
INFO [2022-04-08 00:08:43] plot_cnv_references:Plotting heatmap.
INFO [2022-04-08 00:08:43] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:08:43] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-08 00:08:43] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.3_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.references.txt
INFO [2022-04-08 00:08:43] 

	STEP 22: Denoising

INFO [2022-04-08 00:08:43] ::process_data:Remove noise, noise threshold defined via ref mean sd_amplifier:  1.5
INFO [2022-04-08 00:08:43] denoising using mean(normal) +- sd_amplifier * sd(normal) per gene per cell across all data
INFO [2022-04-08 00:08:43] :: **** clear_noise_via_ref_quantiles **** : removing noise between bounds:  1 - 1
INFO [2022-04-08 00:08:54] 

## Making the final infercnv heatmap ##
INFO [2022-04-08 00:08:55] ::plot_cnv:Start
INFO [2022-04-08 00:08:55] ::plot_cnv:Current data dimensions (r,c)=11681,416 Total=4863136.82859434 Min=0.759935129604928 Max=1.28189025368181.
INFO [2022-04-08 00:08:55] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-08 00:09:00] plot_cnv(): auto thresholding at: (0.910287 , 1.089713)
INFO [2022-04-08 00:09:00] plot_cnv_observation:Start
INFO [2022-04-08 00:09:00] Observation data size: Cells= 414 Genes= 11681
INFO [2022-04-08 00:09:00] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-08 00:09:05] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-08 00:09:05] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-08 00:09:05] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-08 00:09:05] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-08 00:09:05] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:09:05] Quantiles of plotted data range: 0.910286911346971,0.979779104398693,1,1.02133306733466,1.08971308865303
INFO [2022-04-08 00:09:06] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.3_0/infercnv.observations.txt
INFO [2022-04-08 00:09:11] plot_cnv_references:Start
INFO [2022-04-08 00:09:11] Reference data size: Cells= 2 Genes= 11681
INFO [2022-04-08 00:09:11] plot_cnv_references:Number reference groups= 1
INFO [2022-04-08 00:09:11] plot_cnv_references:Plotting heatmap.
INFO [2022-04-08 00:09:11] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:09:11] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-08 00:09:11] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.3_0/infercnv.references.txt
INFO [2022-04-08 00:09:11] Parsing gene order file: /home/tenggao/inferCNV/hg38_gene_order.txt
INFO [2022-04-08 00:09:11] Parsing cell annotations file: /home/tenggao/paper_data/infercnv_out/58408_Primary_0.5_0/58408_Primary_annot.tsv
INFO [2022-04-08 00:09:11] ::order_reduce:Start.
INFO [2022-04-08 00:09:11] .order_reduce(): expr and order match.
INFO [2022-04-08 00:09:11] ::process_data:order_reduce:Reduction from positional data, new dimensions (r,c) = 21034,416 Total=180471912 Min=0 Max=6089512.
INFO [2022-04-08 00:09:11] num genes removed taking into account provided gene ordering list: 2169 = 10.3118760102691% removed.
INFO [2022-04-08 00:09:11] -filtering out cells < 100 or > Inf, removing 0 % of cells
INFO [2022-04-08 00:09:11] validating infercnv_obj
INFO [2022-04-08 00:09:11] ::process_data:Start
INFO [2022-04-08 00:09:11] 

	STEP 1: incoming data

INFO [2022-04-08 00:09:12] 

	STEP 02: Removing lowly expressed genes

INFO [2022-04-08 00:09:12] ::above_min_mean_expr_cutoff:Start
INFO [2022-04-08 00:09:12] Removing 4878 genes from matrix as below mean expr threshold: 0.1
INFO [2022-04-08 00:09:12] validating infercnv_obj
INFO [2022-04-08 00:09:12] There are 13987 genes and 416 cells remaining in the expr matrix.
INFO [2022-04-08 00:09:12] Removed 2180 genes having fewer than 3 min cells per gene = 15.5859 % genes removed here
INFO [2022-04-08 00:09:12] validating infercnv_obj
INFO [2022-04-08 00:09:13] 

	STEP 03: normalization by sequencing depth

INFO [2022-04-08 00:09:13] normalizing counts matrix by depth
INFO [2022-04-08 00:09:13] Computed total sum normalization factor as median libsize: 3802.500000
INFO [2022-04-08 00:09:13] Adding h-spike
INFO [2022-04-08 00:09:13] -hspike modeling of Plasma_ref
INFO [2022-04-08 00:10:52] validating infercnv_obj
INFO [2022-04-08 00:10:52] normalizing counts matrix by depth
INFO [2022-04-08 00:10:52] Using specified normalization factor: 3802.500000
INFO [2022-04-08 00:10:53] 

	STEP 04: log transformation of data

INFO [2022-04-08 00:10:53] transforming log2xplus1()
INFO [2022-04-08 00:10:53] -mirroring for hspike
INFO [2022-04-08 00:10:53] transforming log2xplus1()
INFO [2022-04-08 00:10:55] 

	STEP 08: removing average of reference data (before smoothing)

INFO [2022-04-08 00:10:55] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-08 00:10:55] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-08 00:10:58] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-08 00:12:48] -mirroring for hspike
INFO [2022-04-08 00:12:48] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-08 00:12:48] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-08 00:12:51] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-08 00:12:55] 

	STEP 09: apply max centered expression threshold: 3

INFO [2022-04-08 00:12:55] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-08 00:12:55] -mirroring for hspike
INFO [2022-04-08 00:12:55] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-08 00:12:58] 

	STEP 10: Smoothing data per cell by chromosome

INFO [2022-04-08 00:12:58] smooth_by_chromosome: chr: chr1
INFO [2022-04-08 00:12:58] smooth_by_chromosome: chr: chr2
INFO [2022-04-08 00:12:59] smooth_by_chromosome: chr: chr3
INFO [2022-04-08 00:12:59] smooth_by_chromosome: chr: chr4
INFO [2022-04-08 00:13:00] smooth_by_chromosome: chr: chr5
INFO [2022-04-08 00:13:00] smooth_by_chromosome: chr: chr6
INFO [2022-04-08 00:13:00] smooth_by_chromosome: chr: chr7
INFO [2022-04-08 00:13:01] smooth_by_chromosome: chr: chr8
INFO [2022-04-08 00:13:01] smooth_by_chromosome: chr: chr9
INFO [2022-04-08 00:13:02] smooth_by_chromosome: chr: chr10
INFO [2022-04-08 00:13:02] smooth_by_chromosome: chr: chr11
INFO [2022-04-08 00:13:02] smooth_by_chromosome: chr: chr12
INFO [2022-04-08 00:13:03] smooth_by_chromosome: chr: chr13
INFO [2022-04-08 00:13:03] smooth_by_chromosome: chr: chr14
INFO [2022-04-08 00:13:03] smooth_by_chromosome: chr: chr15
INFO [2022-04-08 00:13:04] smooth_by_chromosome: chr: chr16
INFO [2022-04-08 00:13:04] smooth_by_chromosome: chr: chr17
INFO [2022-04-08 00:13:04] smooth_by_chromosome: chr: chr18
INFO [2022-04-08 00:13:05] smooth_by_chromosome: chr: chr19
INFO [2022-04-08 00:13:05] smooth_by_chromosome: chr: chr20
INFO [2022-04-08 00:13:06] smooth_by_chromosome: chr: chr21
INFO [2022-04-08 00:13:06] smooth_by_chromosome: chr: chr22
INFO [2022-04-08 00:13:06] -mirroring for hspike
INFO [2022-04-08 00:13:06] smooth_by_chromosome: chr: chrA
INFO [2022-04-08 00:13:06] smooth_by_chromosome: chr: chr_0
INFO [2022-04-08 00:13:07] smooth_by_chromosome: chr: chr_B
INFO [2022-04-08 00:13:07] smooth_by_chromosome: chr: chr_0pt5
INFO [2022-04-08 00:13:07] smooth_by_chromosome: chr: chr_C
INFO [2022-04-08 00:13:07] smooth_by_chromosome: chr: chr_1pt5
INFO [2022-04-08 00:13:07] smooth_by_chromosome: chr: chr_D
INFO [2022-04-08 00:13:07] smooth_by_chromosome: chr: chr_2pt0
INFO [2022-04-08 00:13:08] smooth_by_chromosome: chr: chr_E
INFO [2022-04-08 00:13:08] smooth_by_chromosome: chr: chr_3pt0
INFO [2022-04-08 00:13:08] smooth_by_chromosome: chr: chr_F
INFO [2022-04-08 00:13:13] 

	STEP 11: re-centering data across chromosome after smoothing

INFO [2022-04-08 00:13:13] ::center_smooth across chromosomes per cell
INFO [2022-04-08 00:13:13] -mirroring for hspike
INFO [2022-04-08 00:13:13] ::center_smooth across chromosomes per cell
INFO [2022-04-08 00:13:17] 

	STEP 12: removing average of reference data (after smoothing)

INFO [2022-04-08 00:13:17] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-08 00:13:17] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-08 00:13:20] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-08 00:13:21] -mirroring for hspike
INFO [2022-04-08 00:13:21] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-08 00:13:21] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-08 00:13:24] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-08 00:13:28] 

	STEP 14: invert log2(FC) to FC

INFO [2022-04-08 00:13:28] invert_log2(), computing 2^x
INFO [2022-04-08 00:13:28] -mirroring for hspike
INFO [2022-04-08 00:13:28] invert_log2(), computing 2^x
INFO [2022-04-08 00:13:34] 

	STEP 15: Clustering samples (not defining tumor subclusters)

INFO [2022-04-08 00:13:34] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-08 00:13:34] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-08 00:13:39] cut tree into: 1 groups
INFO [2022-04-08 00:13:39] -processing all_observations,all_observations_s1
INFO [2022-04-08 00:13:39] define_signif_tumor_subclusters(), tumor: Plasma_ref
INFO [2022-04-08 00:13:39] -mirroring for hspike
INFO [2022-04-08 00:13:39] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-08 00:13:39] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-08 00:13:40] cut tree into: 1 groups
INFO [2022-04-08 00:13:40] -processing all_observations,all_observations_s1
INFO [2022-04-08 00:13:40] define_signif_tumor_subclusters(), tumor: simnorm_cell_Plasma_ref
INFO [2022-04-08 00:13:40] cut tree into: 1 groups
INFO [2022-04-08 00:13:40] -processing simnorm_cell_Plasma_ref,simnorm_cell_Plasma_ref_s1
INFO [2022-04-08 00:13:51] 

	STEP 17: HMM-based CNV prediction

INFO [2022-04-08 00:13:51] predict_CNV_via_HMM_on_whole_tumor_samples
INFO [2022-04-08 00:13:53] -done predicting CNV based on initial tumor subclusters
INFO [2022-04-08 00:13:53] get_predicted_CNV_regions(consensus)
INFO [2022-04-08 00:13:53] -processing cell_group_name: Plasma_ref, size: 2
INFO [2022-04-08 00:14:01] -processing cell_group_name: Plasma, size: 414
INFO [2022-04-08 00:14:14] -writing cell clusters file: /home/tenggao/paper_data/infercnv_out/58408_Primary_0.5_0/17_HMM_predHMMi6.hmm_mode-samples.cell_groupings
INFO [2022-04-08 00:14:14] -writing cnv regions file: /home/tenggao/paper_data/infercnv_out/58408_Primary_0.5_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_regions.dat
INFO [2022-04-08 00:14:14] -writing per-gene cnv report: /home/tenggao/paper_data/infercnv_out/58408_Primary_0.5_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_genes.dat
INFO [2022-04-08 00:14:14] -writing gene ordering info: /home/tenggao/paper_data/infercnv_out/58408_Primary_0.5_0/17_HMM_predHMMi6.hmm_mode-samples.genes_used.dat
INFO [2022-04-08 00:14:17] ::plot_cnv:Start
INFO [2022-04-08 00:14:17] ::plot_cnv:Current data dimensions (r,c)=11807,416 Total=14887902 Min=1 Max=5.
INFO [2022-04-08 00:14:17] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-08 00:14:21] plot_cnv_observation:Start
INFO [2022-04-08 00:14:21] Observation data size: Cells= 414 Genes= 11807
INFO [2022-04-08 00:14:21] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-08 00:14:25] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-08 00:14:25] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-08 00:14:25] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-08 00:14:25] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-08 00:14:26] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:14:26] Quantiles of plotted data range: 1,3,3,3,5
INFO [2022-04-08 00:14:26] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.5_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.observations.txt
INFO [2022-04-08 00:14:31] plot_cnv_references:Start
INFO [2022-04-08 00:14:31] Reference data size: Cells= 2 Genes= 11807
INFO [2022-04-08 00:14:31] plot_cnv_references:Number reference groups= 1
INFO [2022-04-08 00:14:31] plot_cnv_references:Plotting heatmap.
INFO [2022-04-08 00:14:31] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:14:31] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-08 00:14:31] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.5_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.references.txt
INFO [2022-04-08 00:14:31] 

	STEP 18: Run Bayesian Network Model on HMM predicted CNVs

INFO [2022-04-08 00:14:33] Initializing new MCM InferCNV Object.
INFO [2022-04-08 00:14:33] validating infercnv_obj
INFO [2022-04-08 00:14:33] Total CNV's:  32
INFO [2022-04-08 00:14:33] Loading BUGS Model.
INFO [2022-04-08 00:14:33] Running Sampling Using Parallel with  30 Cores
INFO [2022-04-08 00:19:03] Obtaining probabilities post-sampling
INFO [2022-04-08 00:20:02] Gibbs sampling time:  5.49356543223063  Minutes
INFO [2022-04-08 00:20:08] ::plot_cnv:Start
INFO [2022-04-08 00:20:08] ::plot_cnv:Current data dimensions (r,c)=11807,416 Total=616307.703639442 Min=0 Max=0.954929056601406.
INFO [2022-04-08 00:20:08] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-08 00:20:08] plot_cnv_observation:Start
INFO [2022-04-08 00:20:08] Observation data size: Cells= 414 Genes= 11807
INFO [2022-04-08 00:20:08] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-08 00:20:12] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-08 00:20:12] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-08 00:20:12] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-08 00:20:12] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-08 00:20:13] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:20:13] Quantiles of plotted data range: 0,0,0,0,0.954929056601406
INFO [2022-04-08 00:20:13] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.5_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.observations.txt
INFO [2022-04-08 00:20:17] plot_cnv_references:Start
INFO [2022-04-08 00:20:17] Reference data size: Cells= 2 Genes= 11807
INFO [2022-04-08 00:20:17] plot_cnv_references:Number reference groups= 1
INFO [2022-04-08 00:20:17] plot_cnv_references:Plotting heatmap.
INFO [2022-04-08 00:20:17] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:20:17] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-08 00:20:17] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.5_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.references.txt
INFO [2022-04-08 00:20:23] 

	STEP 19: Filter HMM predicted CNVs based on the Bayesian Network Model results and BayesMaxPNormal

INFO [2022-04-08 00:20:23] Attempting to removing CNV(s) with a probability of being normal above  0.5
INFO [2022-04-08 00:20:23] Removing  0  CNV(s) identified by the HMM.
INFO [2022-04-08 00:20:23] Reassigning CNVs based on state probabilities.
INFO [2022-04-08 00:20:23] Changing the following CNV's states assigned by the HMM to the following based on the CNV's state probabilities.
 chr1-region_27 : 2  (P= 0.316378200780073 ) ->  1 (P= 0.381306877689065 )
chr5-region_37 : 4  (P= 0.419938093117645 ) ->  3 (P= 0.429000059178637 )
chr15-region_67 : 4  (P= 0.395203176722218 ) ->  3 (P= 0.4076087380299 )
chr22-region_92 : 4  (P= 0.290728932264747 ) ->  3 (P= 0.45792497549279 )
INFO [2022-04-08 00:20:23] Creating Plots for CNV and cell Probabilities.
INFO [2022-04-08 00:20:43] ::plot_cnv:Start
INFO [2022-04-08 00:20:43] ::plot_cnv:Current data dimensions (r,c)=11807,416 Total=616307.703639442 Min=0 Max=0.954929056601406.
INFO [2022-04-08 00:20:43] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-08 00:20:44] plot_cnv_observation:Start
INFO [2022-04-08 00:20:44] Observation data size: Cells= 414 Genes= 11807
INFO [2022-04-08 00:20:44] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-08 00:20:47] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-08 00:20:47] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-08 00:20:47] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-08 00:20:47] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-08 00:20:48] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:20:48] Quantiles of plotted data range: 0,0,0,0,0.954929056601406
INFO [2022-04-08 00:20:48] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.5_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.observations.txt
INFO [2022-04-08 00:20:52] plot_cnv_references:Start
INFO [2022-04-08 00:20:52] Reference data size: Cells= 2 Genes= 11807
INFO [2022-04-08 00:20:52] plot_cnv_references:Number reference groups= 1
INFO [2022-04-08 00:20:52] plot_cnv_references:Plotting heatmap.
INFO [2022-04-08 00:20:52] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:20:52] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-08 00:20:52] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.5_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.references.txt
INFO [2022-04-08 00:20:56] ::plot_cnv:Start
INFO [2022-04-08 00:20:56] ::plot_cnv:Current data dimensions (r,c)=11807,416 Total=14705742 Min=1 Max=5.
INFO [2022-04-08 00:20:56] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-08 00:21:00] plot_cnv_observation:Start
INFO [2022-04-08 00:21:00] Observation data size: Cells= 414 Genes= 11807
INFO [2022-04-08 00:21:00] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-08 00:21:05] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-08 00:21:05] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-08 00:21:05] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-08 00:21:05] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-08 00:21:05] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:21:05] Quantiles of plotted data range: 1,3,3,3,5
INFO [2022-04-08 00:21:06] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.5_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.observations.txt
INFO [2022-04-08 00:21:10] plot_cnv_references:Start
INFO [2022-04-08 00:21:10] Reference data size: Cells= 2 Genes= 11807
INFO [2022-04-08 00:21:10] plot_cnv_references:Number reference groups= 1
INFO [2022-04-08 00:21:10] plot_cnv_references:Plotting heatmap.
INFO [2022-04-08 00:21:10] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:21:10] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-08 00:21:10] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.5_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.references.txt
INFO [2022-04-08 00:21:10] 

	STEP 20: Converting HMM-based CNV states to repr expr vals

INFO [2022-04-08 00:21:14] ::plot_cnv:Start
INFO [2022-04-08 00:21:14] ::plot_cnv:Current data dimensions (r,c)=11807,416 Total=4897015 Min=0 Max=2.
INFO [2022-04-08 00:21:14] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-08 00:21:18] plot_cnv_observation:Start
INFO [2022-04-08 00:21:18] Observation data size: Cells= 414 Genes= 11807
INFO [2022-04-08 00:21:18] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-08 00:21:22] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-08 00:21:22] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-08 00:21:22] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-08 00:21:22] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-08 00:21:23] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:21:23] Quantiles of plotted data range: 0,1,1,1,2
INFO [2022-04-08 00:21:23] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.5_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.observations.txt
INFO [2022-04-08 00:21:28] plot_cnv_references:Start
INFO [2022-04-08 00:21:28] Reference data size: Cells= 2 Genes= 11807
INFO [2022-04-08 00:21:28] plot_cnv_references:Number reference groups= 1
INFO [2022-04-08 00:21:28] plot_cnv_references:Plotting heatmap.
INFO [2022-04-08 00:21:28] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:21:28] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-08 00:21:28] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.5_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.references.txt
INFO [2022-04-08 00:21:28] 

	STEP 22: Denoising

INFO [2022-04-08 00:21:28] ::process_data:Remove noise, noise threshold defined via ref mean sd_amplifier:  1.5
INFO [2022-04-08 00:21:28] denoising using mean(normal) +- sd_amplifier * sd(normal) per gene per cell across all data
INFO [2022-04-08 00:21:28] :: **** clear_noise_via_ref_quantiles **** : removing noise between bounds:  1 - 1
INFO [2022-04-08 00:21:39] 

## Making the final infercnv heatmap ##
INFO [2022-04-08 00:21:40] ::plot_cnv:Start
INFO [2022-04-08 00:21:40] ::plot_cnv:Current data dimensions (r,c)=11807,416 Total=4916352.84731525 Min=0.749853880734202 Max=1.32075505042105.
INFO [2022-04-08 00:21:40] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-08 00:21:45] plot_cnv(): auto thresholding at: (0.897350 , 1.102650)
INFO [2022-04-08 00:21:45] plot_cnv_observation:Start
INFO [2022-04-08 00:21:45] Observation data size: Cells= 414 Genes= 11807
INFO [2022-04-08 00:21:45] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-08 00:21:50] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-08 00:21:50] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-08 00:21:50] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-08 00:21:50] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-08 00:21:50] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:21:50] Quantiles of plotted data range: 0.897350454266509,0.976938650034836,1,1.02446144764128,1.10264954573349
INFO [2022-04-08 00:21:51] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.5_0/infercnv.observations.txt
INFO [2022-04-08 00:21:56] plot_cnv_references:Start
INFO [2022-04-08 00:21:56] Reference data size: Cells= 2 Genes= 11807
INFO [2022-04-08 00:21:56] plot_cnv_references:Number reference groups= 1
INFO [2022-04-08 00:21:56] plot_cnv_references:Plotting heatmap.
INFO [2022-04-08 00:21:56] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:21:56] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-08 00:21:56] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.5_0/infercnv.references.txt
INFO [2022-04-08 00:21:56] Parsing gene order file: /home/tenggao/inferCNV/hg38_gene_order.txt
INFO [2022-04-08 00:21:56] Parsing cell annotations file: /home/tenggao/paper_data/infercnv_out/58408_Primary_0.7_0/58408_Primary_annot.tsv
INFO [2022-04-08 00:21:56] ::order_reduce:Start.
INFO [2022-04-08 00:21:56] .order_reduce(): expr and order match.
INFO [2022-04-08 00:21:56] ::process_data:order_reduce:Reduction from positional data, new dimensions (r,c) = 21034,416 Total=180704149 Min=0 Max=6089512.
INFO [2022-04-08 00:21:56] num genes removed taking into account provided gene ordering list: 2169 = 10.3118760102691% removed.
INFO [2022-04-08 00:21:56] -filtering out cells < 100 or > Inf, removing 0 % of cells
INFO [2022-04-08 00:21:56] validating infercnv_obj
INFO [2022-04-08 00:21:56] ::process_data:Start
INFO [2022-04-08 00:21:56] 

	STEP 1: incoming data

INFO [2022-04-08 00:21:57] 

	STEP 02: Removing lowly expressed genes

INFO [2022-04-08 00:21:57] ::above_min_mean_expr_cutoff:Start
INFO [2022-04-08 00:21:57] Removing 4871 genes from matrix as below mean expr threshold: 0.1
INFO [2022-04-08 00:21:57] validating infercnv_obj
INFO [2022-04-08 00:21:57] There are 13994 genes and 416 cells remaining in the expr matrix.
INFO [2022-04-08 00:21:57] Removed 2181 genes having fewer than 3 min cells per gene = 15.5853 % genes removed here
INFO [2022-04-08 00:21:57] validating infercnv_obj
INFO [2022-04-08 00:21:58] 

	STEP 03: normalization by sequencing depth

INFO [2022-04-08 00:21:58] normalizing counts matrix by depth
INFO [2022-04-08 00:21:58] Computed total sum normalization factor as median libsize: 4488.000000
INFO [2022-04-08 00:21:58] Adding h-spike
INFO [2022-04-08 00:21:58] -hspike modeling of Plasma_ref
INFO [2022-04-08 00:23:37] validating infercnv_obj
INFO [2022-04-08 00:23:37] normalizing counts matrix by depth
INFO [2022-04-08 00:23:37] Using specified normalization factor: 4488.000000
INFO [2022-04-08 00:23:38] 

	STEP 04: log transformation of data

INFO [2022-04-08 00:23:38] transforming log2xplus1()
INFO [2022-04-08 00:23:39] -mirroring for hspike
INFO [2022-04-08 00:23:39] transforming log2xplus1()
INFO [2022-04-08 00:23:41] 

	STEP 08: removing average of reference data (before smoothing)

INFO [2022-04-08 00:23:41] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-08 00:23:41] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-08 00:23:43] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-08 00:25:24] -mirroring for hspike
INFO [2022-04-08 00:25:24] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-08 00:25:24] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-08 00:25:27] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-08 00:25:31] 

	STEP 09: apply max centered expression threshold: 3

INFO [2022-04-08 00:25:31] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-08 00:25:31] -mirroring for hspike
INFO [2022-04-08 00:25:31] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-08 00:25:35] 

	STEP 10: Smoothing data per cell by chromosome

INFO [2022-04-08 00:25:35] smooth_by_chromosome: chr: chr1
INFO [2022-04-08 00:25:35] smooth_by_chromosome: chr: chr2
INFO [2022-04-08 00:25:35] smooth_by_chromosome: chr: chr3
INFO [2022-04-08 00:25:36] smooth_by_chromosome: chr: chr4
INFO [2022-04-08 00:25:36] smooth_by_chromosome: chr: chr5
INFO [2022-04-08 00:25:37] smooth_by_chromosome: chr: chr6
INFO [2022-04-08 00:25:37] smooth_by_chromosome: chr: chr7
INFO [2022-04-08 00:25:38] smooth_by_chromosome: chr: chr8
INFO [2022-04-08 00:25:38] smooth_by_chromosome: chr: chr9
INFO [2022-04-08 00:25:39] smooth_by_chromosome: chr: chr10
INFO [2022-04-08 00:25:39] smooth_by_chromosome: chr: chr11
INFO [2022-04-08 00:25:39] smooth_by_chromosome: chr: chr12
INFO [2022-04-08 00:25:40] smooth_by_chromosome: chr: chr13
INFO [2022-04-08 00:25:40] smooth_by_chromosome: chr: chr14
INFO [2022-04-08 00:25:41] smooth_by_chromosome: chr: chr15
INFO [2022-04-08 00:25:41] smooth_by_chromosome: chr: chr16
INFO [2022-04-08 00:25:41] smooth_by_chromosome: chr: chr17
INFO [2022-04-08 00:25:42] smooth_by_chromosome: chr: chr18
INFO [2022-04-08 00:25:42] smooth_by_chromosome: chr: chr19
INFO [2022-04-08 00:25:43] smooth_by_chromosome: chr: chr20
INFO [2022-04-08 00:25:43] smooth_by_chromosome: chr: chr21
INFO [2022-04-08 00:25:43] smooth_by_chromosome: chr: chr22
INFO [2022-04-08 00:25:44] -mirroring for hspike
INFO [2022-04-08 00:25:44] smooth_by_chromosome: chr: chrA
INFO [2022-04-08 00:25:44] smooth_by_chromosome: chr: chr_0
INFO [2022-04-08 00:25:44] smooth_by_chromosome: chr: chr_B
INFO [2022-04-08 00:25:44] smooth_by_chromosome: chr: chr_0pt5
INFO [2022-04-08 00:25:44] smooth_by_chromosome: chr: chr_C
INFO [2022-04-08 00:25:45] smooth_by_chromosome: chr: chr_1pt5
INFO [2022-04-08 00:25:45] smooth_by_chromosome: chr: chr_D
INFO [2022-04-08 00:25:45] smooth_by_chromosome: chr: chr_2pt0
INFO [2022-04-08 00:25:45] smooth_by_chromosome: chr: chr_E
INFO [2022-04-08 00:25:45] smooth_by_chromosome: chr: chr_3pt0
INFO [2022-04-08 00:25:45] smooth_by_chromosome: chr: chr_F
INFO [2022-04-08 00:25:50] 

	STEP 11: re-centering data across chromosome after smoothing

INFO [2022-04-08 00:25:50] ::center_smooth across chromosomes per cell
INFO [2022-04-08 00:25:51] -mirroring for hspike
INFO [2022-04-08 00:25:51] ::center_smooth across chromosomes per cell
INFO [2022-04-08 00:25:55] 

	STEP 12: removing average of reference data (after smoothing)

INFO [2022-04-08 00:25:55] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-08 00:25:55] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-08 00:25:58] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-08 00:25:58] -mirroring for hspike
INFO [2022-04-08 00:25:58] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-08 00:25:58] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-08 00:26:01] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-08 00:26:07] 

	STEP 14: invert log2(FC) to FC

INFO [2022-04-08 00:26:07] invert_log2(), computing 2^x
INFO [2022-04-08 00:26:07] -mirroring for hspike
INFO [2022-04-08 00:26:07] invert_log2(), computing 2^x
INFO [2022-04-08 00:26:16] 

	STEP 15: Clustering samples (not defining tumor subclusters)

INFO [2022-04-08 00:26:16] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-08 00:26:16] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-08 00:26:22] cut tree into: 1 groups
INFO [2022-04-08 00:26:22] -processing all_observations,all_observations_s1
INFO [2022-04-08 00:26:22] define_signif_tumor_subclusters(), tumor: Plasma_ref
INFO [2022-04-08 00:26:22] -mirroring for hspike
INFO [2022-04-08 00:26:22] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-08 00:26:22] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-08 00:26:23] cut tree into: 1 groups
INFO [2022-04-08 00:26:23] -processing all_observations,all_observations_s1
INFO [2022-04-08 00:26:23] define_signif_tumor_subclusters(), tumor: simnorm_cell_Plasma_ref
INFO [2022-04-08 00:26:23] cut tree into: 1 groups
INFO [2022-04-08 00:26:23] -processing simnorm_cell_Plasma_ref,simnorm_cell_Plasma_ref_s1
INFO [2022-04-08 00:26:34] 

	STEP 17: HMM-based CNV prediction

INFO [2022-04-08 00:26:34] predict_CNV_via_HMM_on_whole_tumor_samples
INFO [2022-04-08 00:26:35] -done predicting CNV based on initial tumor subclusters
INFO [2022-04-08 00:26:35] get_predicted_CNV_regions(consensus)
INFO [2022-04-08 00:26:35] -processing cell_group_name: Plasma_ref, size: 2
INFO [2022-04-08 00:26:44] -processing cell_group_name: Plasma, size: 414
INFO [2022-04-08 00:26:57] -writing cell clusters file: /home/tenggao/paper_data/infercnv_out/58408_Primary_0.7_0/17_HMM_predHMMi6.hmm_mode-samples.cell_groupings
INFO [2022-04-08 00:26:57] -writing cnv regions file: /home/tenggao/paper_data/infercnv_out/58408_Primary_0.7_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_regions.dat
INFO [2022-04-08 00:26:57] -writing per-gene cnv report: /home/tenggao/paper_data/infercnv_out/58408_Primary_0.7_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_genes.dat
INFO [2022-04-08 00:26:57] -writing gene ordering info: /home/tenggao/paper_data/infercnv_out/58408_Primary_0.7_0/17_HMM_predHMMi6.hmm_mode-samples.genes_used.dat
INFO [2022-04-08 00:27:01] ::plot_cnv:Start
INFO [2022-04-08 00:27:01] ::plot_cnv:Current data dimensions (r,c)=11813,416 Total=14916918 Min=1 Max=5.
INFO [2022-04-08 00:27:01] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-08 00:27:06] plot_cnv_observation:Start
INFO [2022-04-08 00:27:06] Observation data size: Cells= 414 Genes= 11813
INFO [2022-04-08 00:27:06] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-08 00:27:10] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-08 00:27:10] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-08 00:27:10] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-08 00:27:10] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-08 00:27:11] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:27:11] Quantiles of plotted data range: 1,3,3,3,5
INFO [2022-04-08 00:27:11] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.7_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.observations.txt
INFO [2022-04-08 00:27:16] plot_cnv_references:Start
INFO [2022-04-08 00:27:16] Reference data size: Cells= 2 Genes= 11813
INFO [2022-04-08 00:27:16] plot_cnv_references:Number reference groups= 1
INFO [2022-04-08 00:27:16] plot_cnv_references:Plotting heatmap.
INFO [2022-04-08 00:27:16] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:27:16] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-08 00:27:16] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.7_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.references.txt
INFO [2022-04-08 00:27:16] 

	STEP 18: Run Bayesian Network Model on HMM predicted CNVs

INFO [2022-04-08 00:27:18] Initializing new MCM InferCNV Object.
INFO [2022-04-08 00:27:18] validating infercnv_obj
INFO [2022-04-08 00:27:18] Total CNV's:  48
INFO [2022-04-08 00:27:18] Loading BUGS Model.
INFO [2022-04-08 00:27:18] Running Sampling Using Parallel with  30 Cores
INFO [2022-04-08 00:35:14] Obtaining probabilities post-sampling
INFO [2022-04-08 00:36:44] Gibbs sampling time:  9.4393750111262  Minutes
INFO [2022-04-08 00:36:51] ::plot_cnv:Start
INFO [2022-04-08 00:36:51] ::plot_cnv:Current data dimensions (r,c)=11813,416 Total=1136976.49313658 Min=0 Max=0.96753805141244.
INFO [2022-04-08 00:36:51] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-08 00:36:51] plot_cnv_observation:Start
INFO [2022-04-08 00:36:51] Observation data size: Cells= 414 Genes= 11813
INFO [2022-04-08 00:36:51] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-08 00:36:55] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-08 00:36:55] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-08 00:36:55] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-08 00:36:55] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-08 00:36:55] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:36:55] Quantiles of plotted data range: 0,0,0,0.664183245886484,0.96753805141244
INFO [2022-04-08 00:36:56] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.7_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.observations.txt
INFO [2022-04-08 00:37:00] plot_cnv_references:Start
INFO [2022-04-08 00:37:00] Reference data size: Cells= 2 Genes= 11813
INFO [2022-04-08 00:37:00] plot_cnv_references:Number reference groups= 1
INFO [2022-04-08 00:37:00] plot_cnv_references:Plotting heatmap.
INFO [2022-04-08 00:37:00] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:37:00] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-08 00:37:00] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.7_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.references.txt
INFO [2022-04-08 00:37:06] 

	STEP 19: Filter HMM predicted CNVs based on the Bayesian Network Model results and BayesMaxPNormal

INFO [2022-04-08 00:37:06] Attempting to removing CNV(s) with a probability of being normal above  0.5
INFO [2022-04-08 00:37:06] Removing  0  CNV(s) identified by the HMM.
INFO [2022-04-08 00:37:06] Reassigning CNVs based on state probabilities.
INFO [2022-04-08 00:37:06] Changing the following CNV's states assigned by the HMM to the following based on the CNV's state probabilities.
 chr1-region_27 : 2  (P= 0.16184666515942 ) ->  1 (P= 0.621684233487615 )
chr11-region_74 : 2  (P= 0.367820289313249 ) ->  1 (P= 0.43355364817108 )
chr22-region_120 : 4  (P= 0.306853806777611 ) ->  3 (P= 0.447405147024298 )
INFO [2022-04-08 00:37:06] Creating Plots for CNV and cell Probabilities.
INFO [2022-04-08 00:37:39] ::plot_cnv:Start
INFO [2022-04-08 00:37:39] ::plot_cnv:Current data dimensions (r,c)=11813,416 Total=1136976.49313658 Min=0 Max=0.96753805141244.
INFO [2022-04-08 00:37:39] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-08 00:37:39] plot_cnv_observation:Start
INFO [2022-04-08 00:37:39] Observation data size: Cells= 414 Genes= 11813
INFO [2022-04-08 00:37:39] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-08 00:37:43] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-08 00:37:43] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-08 00:37:43] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-08 00:37:43] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-08 00:37:44] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:37:44] Quantiles of plotted data range: 0,0,0,0.664183245886484,0.96753805141244
INFO [2022-04-08 00:37:44] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.7_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.observations.txt
INFO [2022-04-08 00:37:49] plot_cnv_references:Start
INFO [2022-04-08 00:37:49] Reference data size: Cells= 2 Genes= 11813
INFO [2022-04-08 00:37:49] plot_cnv_references:Number reference groups= 1
INFO [2022-04-08 00:37:49] plot_cnv_references:Plotting heatmap.
INFO [2022-04-08 00:37:49] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:37:49] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-08 00:37:49] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.7_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.references.txt
INFO [2022-04-08 00:37:52] ::plot_cnv:Start
INFO [2022-04-08 00:37:52] ::plot_cnv:Current data dimensions (r,c)=11813,416 Total=14852748 Min=1 Max=5.
INFO [2022-04-08 00:37:53] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-08 00:37:57] plot_cnv_observation:Start
INFO [2022-04-08 00:37:57] Observation data size: Cells= 414 Genes= 11813
INFO [2022-04-08 00:37:57] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-08 00:38:02] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-08 00:38:02] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-08 00:38:02] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-08 00:38:02] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-08 00:38:03] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:38:03] Quantiles of plotted data range: 1,3,3,3,5
INFO [2022-04-08 00:38:03] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.7_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.observations.txt
INFO [2022-04-08 00:38:07] plot_cnv_references:Start
INFO [2022-04-08 00:38:07] Reference data size: Cells= 2 Genes= 11813
INFO [2022-04-08 00:38:07] plot_cnv_references:Number reference groups= 1
INFO [2022-04-08 00:38:07] plot_cnv_references:Plotting heatmap.
INFO [2022-04-08 00:38:07] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:38:07] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-08 00:38:07] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.7_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.references.txt
INFO [2022-04-08 00:38:08] 

	STEP 20: Converting HMM-based CNV states to repr expr vals

INFO [2022-04-08 00:38:11] ::plot_cnv:Start
INFO [2022-04-08 00:38:11] ::plot_cnv:Current data dimensions (r,c)=11813,416 Total=4969270 Min=0 Max=2.
INFO [2022-04-08 00:38:11] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-08 00:38:15] plot_cnv_observation:Start
INFO [2022-04-08 00:38:15] Observation data size: Cells= 414 Genes= 11813
INFO [2022-04-08 00:38:15] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-08 00:38:20] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-08 00:38:20] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-08 00:38:20] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-08 00:38:20] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-08 00:38:20] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:38:20] Quantiles of plotted data range: 0,1,1,1,2
INFO [2022-04-08 00:38:20] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.7_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.observations.txt
INFO [2022-04-08 00:38:25] plot_cnv_references:Start
INFO [2022-04-08 00:38:25] Reference data size: Cells= 2 Genes= 11813
INFO [2022-04-08 00:38:25] plot_cnv_references:Number reference groups= 1
INFO [2022-04-08 00:38:25] plot_cnv_references:Plotting heatmap.
INFO [2022-04-08 00:38:25] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:38:25] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-08 00:38:25] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.7_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.references.txt
INFO [2022-04-08 00:38:25] 

	STEP 22: Denoising

INFO [2022-04-08 00:38:25] ::process_data:Remove noise, noise threshold defined via ref mean sd_amplifier:  1.5
INFO [2022-04-08 00:38:25] denoising using mean(normal) +- sd_amplifier * sd(normal) per gene per cell across all data
INFO [2022-04-08 00:38:25] :: **** clear_noise_via_ref_quantiles **** : removing noise between bounds:  1 - 1
INFO [2022-04-08 00:38:36] 

## Making the final infercnv heatmap ##
INFO [2022-04-08 00:38:37] ::plot_cnv:Start
INFO [2022-04-08 00:38:37] ::plot_cnv:Current data dimensions (r,c)=11813,416 Total=4918335.78364907 Min=0.730626860467794 Max=1.35494242198483.
INFO [2022-04-08 00:38:37] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-08 00:38:42] plot_cnv(): auto thresholding at: (0.883486 , 1.116514)
INFO [2022-04-08 00:38:42] plot_cnv_observation:Start
INFO [2022-04-08 00:38:42] Observation data size: Cells= 414 Genes= 11813
INFO [2022-04-08 00:38:42] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-08 00:38:47] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-08 00:38:47] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-08 00:38:47] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-08 00:38:47] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-08 00:38:47] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:38:47] Quantiles of plotted data range: 0.883485986820065,0.973426638619085,1,1.02794762316776,1.11651401317994
INFO [2022-04-08 00:38:48] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.7_0/infercnv.observations.txt
INFO [2022-04-08 00:38:53] plot_cnv_references:Start
INFO [2022-04-08 00:38:53] Reference data size: Cells= 2 Genes= 11813
INFO [2022-04-08 00:38:53] plot_cnv_references:Number reference groups= 1
INFO [2022-04-08 00:38:53] plot_cnv_references:Plotting heatmap.
INFO [2022-04-08 00:38:53] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:38:53] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-08 00:38:53] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.7_0/infercnv.references.txt
INFO [2022-04-08 00:38:53] Parsing gene order file: /home/tenggao/inferCNV/hg38_gene_order.txt
INFO [2022-04-08 00:38:54] Parsing cell annotations file: /home/tenggao/paper_data/infercnv_out/58408_Primary_0.9_0/58408_Primary_annot.tsv
INFO [2022-04-08 00:38:54] ::order_reduce:Start.
INFO [2022-04-08 00:38:54] .order_reduce(): expr and order match.
INFO [2022-04-08 00:38:54] ::process_data:order_reduce:Reduction from positional data, new dimensions (r,c) = 21034,416 Total=180872853 Min=0 Max=6089512.
INFO [2022-04-08 00:38:54] num genes removed taking into account provided gene ordering list: 2169 = 10.3118760102691% removed.
INFO [2022-04-08 00:38:54] -filtering out cells < 100 or > Inf, removing 0 % of cells
INFO [2022-04-08 00:38:54] validating infercnv_obj
INFO [2022-04-08 00:38:54] ::process_data:Start
INFO [2022-04-08 00:38:54] 

	STEP 1: incoming data

INFO [2022-04-08 00:38:55] 

	STEP 02: Removing lowly expressed genes

INFO [2022-04-08 00:38:55] ::above_min_mean_expr_cutoff:Start
INFO [2022-04-08 00:38:55] Removing 4873 genes from matrix as below mean expr threshold: 0.1
INFO [2022-04-08 00:38:55] validating infercnv_obj
INFO [2022-04-08 00:38:55] There are 13992 genes and 416 cells remaining in the expr matrix.
INFO [2022-04-08 00:38:55] Removed 2186 genes having fewer than 3 min cells per gene = 15.6232 % genes removed here
INFO [2022-04-08 00:38:55] validating infercnv_obj
INFO [2022-04-08 00:38:56] 

	STEP 03: normalization by sequencing depth

INFO [2022-04-08 00:38:56] normalizing counts matrix by depth
INFO [2022-04-08 00:38:56] Computed total sum normalization factor as median libsize: 5099.500000
INFO [2022-04-08 00:38:56] Adding h-spike
INFO [2022-04-08 00:38:56] -hspike modeling of Plasma_ref
INFO [2022-04-08 00:40:41] validating infercnv_obj
INFO [2022-04-08 00:40:41] normalizing counts matrix by depth
INFO [2022-04-08 00:40:41] Using specified normalization factor: 5099.500000
INFO [2022-04-08 00:40:42] 

	STEP 04: log transformation of data

INFO [2022-04-08 00:40:42] transforming log2xplus1()
INFO [2022-04-08 00:40:42] -mirroring for hspike
INFO [2022-04-08 00:40:42] transforming log2xplus1()
INFO [2022-04-08 00:40:44] 

	STEP 08: removing average of reference data (before smoothing)

INFO [2022-04-08 00:40:44] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-08 00:40:44] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-08 00:40:47] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-08 00:42:32] -mirroring for hspike
INFO [2022-04-08 00:42:32] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-08 00:42:32] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-08 00:42:35] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-08 00:42:39] 

	STEP 09: apply max centered expression threshold: 3

INFO [2022-04-08 00:42:39] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-08 00:42:39] -mirroring for hspike
INFO [2022-04-08 00:42:39] ::process_data:setting max centered expr, threshold set to: +/-:  3
INFO [2022-04-08 00:42:42] 

	STEP 10: Smoothing data per cell by chromosome

INFO [2022-04-08 00:42:42] smooth_by_chromosome: chr: chr1
INFO [2022-04-08 00:42:43] smooth_by_chromosome: chr: chr2
INFO [2022-04-08 00:42:43] smooth_by_chromosome: chr: chr3
INFO [2022-04-08 00:42:44] smooth_by_chromosome: chr: chr4
INFO [2022-04-08 00:42:44] smooth_by_chromosome: chr: chr5
INFO [2022-04-08 00:42:44] smooth_by_chromosome: chr: chr6
INFO [2022-04-08 00:42:45] smooth_by_chromosome: chr: chr7
INFO [2022-04-08 00:42:45] smooth_by_chromosome: chr: chr8
INFO [2022-04-08 00:42:46] smooth_by_chromosome: chr: chr9
INFO [2022-04-08 00:42:46] smooth_by_chromosome: chr: chr10
INFO [2022-04-08 00:42:46] smooth_by_chromosome: chr: chr11
INFO [2022-04-08 00:42:47] smooth_by_chromosome: chr: chr12
INFO [2022-04-08 00:42:47] smooth_by_chromosome: chr: chr13
INFO [2022-04-08 00:42:47] smooth_by_chromosome: chr: chr14
INFO [2022-04-08 00:42:48] smooth_by_chromosome: chr: chr15
INFO [2022-04-08 00:42:48] smooth_by_chromosome: chr: chr16
INFO [2022-04-08 00:42:49] smooth_by_chromosome: chr: chr17
INFO [2022-04-08 00:42:49] smooth_by_chromosome: chr: chr18
INFO [2022-04-08 00:42:49] smooth_by_chromosome: chr: chr19
INFO [2022-04-08 00:42:50] smooth_by_chromosome: chr: chr20
INFO [2022-04-08 00:42:50] smooth_by_chromosome: chr: chr21
INFO [2022-04-08 00:42:51] smooth_by_chromosome: chr: chr22
INFO [2022-04-08 00:42:51] -mirroring for hspike
INFO [2022-04-08 00:42:51] smooth_by_chromosome: chr: chrA
INFO [2022-04-08 00:42:51] smooth_by_chromosome: chr: chr_0
INFO [2022-04-08 00:42:51] smooth_by_chromosome: chr: chr_B
INFO [2022-04-08 00:42:51] smooth_by_chromosome: chr: chr_0pt5
INFO [2022-04-08 00:42:52] smooth_by_chromosome: chr: chr_C
INFO [2022-04-08 00:42:52] smooth_by_chromosome: chr: chr_1pt5
INFO [2022-04-08 00:42:52] smooth_by_chromosome: chr: chr_D
INFO [2022-04-08 00:42:52] smooth_by_chromosome: chr: chr_2pt0
INFO [2022-04-08 00:42:52] smooth_by_chromosome: chr: chr_E
INFO [2022-04-08 00:42:52] smooth_by_chromosome: chr: chr_3pt0
INFO [2022-04-08 00:42:53] smooth_by_chromosome: chr: chr_F
INFO [2022-04-08 00:42:57] 

	STEP 11: re-centering data across chromosome after smoothing

INFO [2022-04-08 00:42:57] ::center_smooth across chromosomes per cell
INFO [2022-04-08 00:42:58] -mirroring for hspike
INFO [2022-04-08 00:42:58] ::center_smooth across chromosomes per cell
INFO [2022-04-08 00:43:02] 

	STEP 12: removing average of reference data (after smoothing)

INFO [2022-04-08 00:43:02] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-08 00:43:02] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-08 00:43:05] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-08 00:43:05] -mirroring for hspike
INFO [2022-04-08 00:43:05] ::subtract_ref_expr_from_obs:Start inv_log=FALSE, use_bounds=TRUE
INFO [2022-04-08 00:43:05] subtracting mean(normal) per gene per cell across all data
INFO [2022-04-08 00:43:09] -subtracting expr per gene, use_bounds=TRUE
INFO [2022-04-08 00:43:14] 

	STEP 14: invert log2(FC) to FC

INFO [2022-04-08 00:43:14] invert_log2(), computing 2^x
INFO [2022-04-08 00:43:14] -mirroring for hspike
INFO [2022-04-08 00:43:14] invert_log2(), computing 2^x
INFO [2022-04-08 00:43:20] 

	STEP 15: Clustering samples (not defining tumor subclusters)

INFO [2022-04-08 00:43:20] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-08 00:43:20] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-08 00:43:25] cut tree into: 1 groups
INFO [2022-04-08 00:43:25] -processing all_observations,all_observations_s1
INFO [2022-04-08 00:43:25] define_signif_tumor_subclusters(), tumor: Plasma_ref
INFO [2022-04-08 00:43:25] -mirroring for hspike
INFO [2022-04-08 00:43:25] define_signif_tumor_subclusters(p_val=0.1
INFO [2022-04-08 00:43:25] define_signif_tumor_subclusters(), tumor: all_observations
INFO [2022-04-08 00:43:25] cut tree into: 1 groups
INFO [2022-04-08 00:43:25] -processing all_observations,all_observations_s1
INFO [2022-04-08 00:43:25] define_signif_tumor_subclusters(), tumor: simnorm_cell_Plasma_ref
INFO [2022-04-08 00:43:25] cut tree into: 1 groups
INFO [2022-04-08 00:43:25] -processing simnorm_cell_Plasma_ref,simnorm_cell_Plasma_ref_s1
INFO [2022-04-08 00:43:36] 

	STEP 17: HMM-based CNV prediction

INFO [2022-04-08 00:43:36] predict_CNV_via_HMM_on_whole_tumor_samples
INFO [2022-04-08 00:43:37] -done predicting CNV based on initial tumor subclusters
INFO [2022-04-08 00:43:37] get_predicted_CNV_regions(consensus)
INFO [2022-04-08 00:43:37] -processing cell_group_name: Plasma_ref, size: 2
INFO [2022-04-08 00:43:46] -processing cell_group_name: Plasma, size: 414
INFO [2022-04-08 00:43:59] -writing cell clusters file: /home/tenggao/paper_data/infercnv_out/58408_Primary_0.9_0/17_HMM_predHMMi6.hmm_mode-samples.cell_groupings
INFO [2022-04-08 00:43:59] -writing cnv regions file: /home/tenggao/paper_data/infercnv_out/58408_Primary_0.9_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_regions.dat
INFO [2022-04-08 00:43:59] -writing per-gene cnv report: /home/tenggao/paper_data/infercnv_out/58408_Primary_0.9_0/17_HMM_predHMMi6.hmm_mode-samples.pred_cnv_genes.dat
INFO [2022-04-08 00:43:59] -writing gene ordering info: /home/tenggao/paper_data/infercnv_out/58408_Primary_0.9_0/17_HMM_predHMMi6.hmm_mode-samples.genes_used.dat
INFO [2022-04-08 00:44:02] ::plot_cnv:Start
INFO [2022-04-08 00:44:02] ::plot_cnv:Current data dimensions (r,c)=11806,416 Total=14911494 Min=1 Max=5.
INFO [2022-04-08 00:44:02] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-08 00:44:06] plot_cnv_observation:Start
INFO [2022-04-08 00:44:06] Observation data size: Cells= 414 Genes= 11806
INFO [2022-04-08 00:44:06] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-08 00:44:11] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-08 00:44:11] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-08 00:44:11] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-08 00:44:11] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-08 00:44:11] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:44:11] Quantiles of plotted data range: 1,3,3,3,5
INFO [2022-04-08 00:44:12] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.9_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.observations.txt
INFO [2022-04-08 00:44:16] plot_cnv_references:Start
INFO [2022-04-08 00:44:16] Reference data size: Cells= 2 Genes= 11806
INFO [2022-04-08 00:44:16] plot_cnv_references:Number reference groups= 1
INFO [2022-04-08 00:44:16] plot_cnv_references:Plotting heatmap.
INFO [2022-04-08 00:44:16] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:44:16] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-08 00:44:16] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.9_0/infercnv.17_HMM_predHMMi6.hmm_mode-samples.references.txt
INFO [2022-04-08 00:44:16] 

	STEP 18: Run Bayesian Network Model on HMM predicted CNVs

INFO [2022-04-08 00:44:18] Initializing new MCM InferCNV Object.
INFO [2022-04-08 00:44:18] validating infercnv_obj
INFO [2022-04-08 00:44:18] Total CNV's:  50
INFO [2022-04-08 00:44:18] Loading BUGS Model.
INFO [2022-04-08 00:44:18] Running Sampling Using Parallel with  30 Cores
INFO [2022-04-08 00:49:59] Obtaining probabilities post-sampling
INFO [2022-04-08 00:51:32] Gibbs sampling time:  7.22897530794144  Minutes
INFO [2022-04-08 00:51:38] ::plot_cnv:Start
INFO [2022-04-08 00:51:38] ::plot_cnv:Current data dimensions (r,c)=11806,416 Total=1081783.77380478 Min=0 Max=0.990185528473818.
INFO [2022-04-08 00:51:38] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-08 00:51:38] plot_cnv_observation:Start
INFO [2022-04-08 00:51:38] Observation data size: Cells= 414 Genes= 11806
INFO [2022-04-08 00:51:38] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-08 00:51:42] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-08 00:51:42] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-08 00:51:42] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-08 00:51:42] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-08 00:51:42] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:51:42] Quantiles of plotted data range: 0,0,0,0.684206962350881,0.990185528473818
INFO [2022-04-08 00:51:43] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.9_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.observations.txt
INFO [2022-04-08 00:51:46] plot_cnv_references:Start
INFO [2022-04-08 00:51:46] Reference data size: Cells= 2 Genes= 11806
INFO [2022-04-08 00:51:46] plot_cnv_references:Number reference groups= 1
INFO [2022-04-08 00:51:46] plot_cnv_references:Plotting heatmap.
INFO [2022-04-08 00:51:46] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:51:46] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-08 00:51:46] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.9_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PreFiltering.references.txt
INFO [2022-04-08 00:51:53] 

	STEP 19: Filter HMM predicted CNVs based on the Bayesian Network Model results and BayesMaxPNormal

INFO [2022-04-08 00:51:53] Attempting to removing CNV(s) with a probability of being normal above  0.5
INFO [2022-04-08 00:51:53] Removing  0  CNV(s) identified by the HMM.
INFO [2022-04-08 00:51:53] Reassigning CNVs based on state probabilities.
INFO [2022-04-08 00:51:53] Changing the following CNV's states assigned by the HMM to the following based on the CNV's state probabilities.
 chr22-region_119 : 4  (P= 0.357835628763176 ) ->  3 (P= 0.475666317495171 )
INFO [2022-04-08 00:51:53] Creating Plots for CNV and cell Probabilities.
INFO [2022-04-08 00:52:25] ::plot_cnv:Start
INFO [2022-04-08 00:52:25] ::plot_cnv:Current data dimensions (r,c)=11806,416 Total=1081783.77380478 Min=0 Max=0.990185528473818.
INFO [2022-04-08 00:52:25] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-08 00:52:25] plot_cnv_observation:Start
INFO [2022-04-08 00:52:25] Observation data size: Cells= 414 Genes= 11806
INFO [2022-04-08 00:52:25] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-08 00:52:29] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-08 00:52:29] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-08 00:52:29] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-08 00:52:29] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-08 00:52:30] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:52:30] Quantiles of plotted data range: 0,0,0,0.684206962350881,0.990185528473818
INFO [2022-04-08 00:52:30] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.9_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.observations.txt
INFO [2022-04-08 00:52:34] plot_cnv_references:Start
INFO [2022-04-08 00:52:34] Reference data size: Cells= 2 Genes= 11806
INFO [2022-04-08 00:52:34] plot_cnv_references:Number reference groups= 1
INFO [2022-04-08 00:52:34] plot_cnv_references:Plotting heatmap.
INFO [2022-04-08 00:52:34] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:52:34] Quantiles of plotted data range: 0,0,0,0,0
INFO [2022-04-08 00:52:34] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.9_0/BayesNetOutput.HMMi6.hmm_mode-samples/infercnv.NormalProbabilities.PostFiltering.references.txt
INFO [2022-04-08 00:52:38] ::plot_cnv:Start
INFO [2022-04-08 00:52:38] ::plot_cnv:Current data dimensions (r,c)=11806,416 Total=14904870 Min=1 Max=5.
INFO [2022-04-08 00:52:38] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-08 00:52:42] plot_cnv_observation:Start
INFO [2022-04-08 00:52:42] Observation data size: Cells= 414 Genes= 11806
INFO [2022-04-08 00:52:42] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-08 00:52:46] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-08 00:52:46] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-08 00:52:46] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-08 00:52:46] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-08 00:52:47] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:52:47] Quantiles of plotted data range: 1,3,3,3,5
INFO [2022-04-08 00:52:47] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.9_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.observations.txt
INFO [2022-04-08 00:52:52] plot_cnv_references:Start
INFO [2022-04-08 00:52:52] Reference data size: Cells= 2 Genes= 11806
INFO [2022-04-08 00:52:52] plot_cnv_references:Number reference groups= 1
INFO [2022-04-08 00:52:52] plot_cnv_references:Plotting heatmap.
INFO [2022-04-08 00:52:52] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:52:52] Quantiles of plotted data range: 3,3,3,3,3
INFO [2022-04-08 00:52:52] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.9_0/infercnv.19_HMM_pred.Bayes_Net.Pnorm_0.5.references.txt
INFO [2022-04-08 00:52:52] 

	STEP 20: Converting HMM-based CNV states to repr expr vals

INFO [2022-04-08 00:52:55] ::plot_cnv:Start
INFO [2022-04-08 00:52:55] ::plot_cnv:Current data dimensions (r,c)=11806,416 Total=4996787 Min=0 Max=2.
INFO [2022-04-08 00:52:55] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-08 00:53:00] plot_cnv_observation:Start
INFO [2022-04-08 00:53:00] Observation data size: Cells= 414 Genes= 11806
INFO [2022-04-08 00:53:00] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-08 00:53:04] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-08 00:53:04] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-08 00:53:04] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-08 00:53:04] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-08 00:53:05] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:53:05] Quantiles of plotted data range: 0,1,1,1,2
INFO [2022-04-08 00:53:05] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.9_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.observations.txt
INFO [2022-04-08 00:53:09] plot_cnv_references:Start
INFO [2022-04-08 00:53:09] Reference data size: Cells= 2 Genes= 11806
INFO [2022-04-08 00:53:09] plot_cnv_references:Number reference groups= 1
INFO [2022-04-08 00:53:09] plot_cnv_references:Plotting heatmap.
INFO [2022-04-08 00:53:09] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:53:09] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-08 00:53:09] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.9_0/infercnv.20_HMM_predHMMi6.hmm_mode-samples.Pnorm_0.5.repr_intensities.references.txt
INFO [2022-04-08 00:53:10] 

	STEP 22: Denoising

INFO [2022-04-08 00:53:10] ::process_data:Remove noise, noise threshold defined via ref mean sd_amplifier:  1.5
INFO [2022-04-08 00:53:10] denoising using mean(normal) +- sd_amplifier * sd(normal) per gene per cell across all data
INFO [2022-04-08 00:53:10] :: **** clear_noise_via_ref_quantiles **** : removing noise between bounds:  1 - 1
INFO [2022-04-08 00:53:20] 

## Making the final infercnv heatmap ##
INFO [2022-04-08 00:53:21] ::plot_cnv:Start
INFO [2022-04-08 00:53:21] ::plot_cnv:Current data dimensions (r,c)=11806,416 Total=4916676.52106144 Min=0.716887793841446 Max=1.38356079078936.
INFO [2022-04-08 00:53:21] ::plot_cnv:Depending on the size of the matrix this may take a moment.
INFO [2022-04-08 00:53:26] plot_cnv(): auto thresholding at: (0.870305 , 1.129695)
INFO [2022-04-08 00:53:26] plot_cnv_observation:Start
INFO [2022-04-08 00:53:26] Observation data size: Cells= 414 Genes= 11806
INFO [2022-04-08 00:53:26] plot_cnv_observation:Writing observations by grouping.
INFO [2022-04-08 00:53:31] plot_cnv_observation:Writing observation groupings/color.
INFO [2022-04-08 00:53:31] plot_cnv_observation:Done writing observation groupings/color.
INFO [2022-04-08 00:53:31] plot_cnv_observation:Writing observation heatmap thresholds.
INFO [2022-04-08 00:53:31] plot_cnv_observation:Done writing observation heatmap thresholds.
INFO [2022-04-08 00:53:32] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:53:32] Quantiles of plotted data range: 0.870305292660656,0.970607004088188,1,1.03116125420833,1.12969470733934
INFO [2022-04-08 00:53:32] plot_cnv_observations:Writing observation data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.9_0/infercnv.observations.txt
INFO [2022-04-08 00:53:37] plot_cnv_references:Start
INFO [2022-04-08 00:53:37] Reference data size: Cells= 2 Genes= 11806
INFO [2022-04-08 00:53:37] plot_cnv_references:Number reference groups= 1
INFO [2022-04-08 00:53:37] plot_cnv_references:Plotting heatmap.
INFO [2022-04-08 00:53:37] Colors for breaks:  #00008B,#24249B,#4848AB,#6D6DBC,#9191CC,#B6B6DD,#DADAEE,#FFFFFF,#EEDADA,#DDB6B6,#CC9191,#BC6D6D,#AB4848,#9B2424,#8B0000
INFO [2022-04-08 00:53:37] Quantiles of plotted data range: 1,1,1,1,1
INFO [2022-04-08 00:53:37] plot_cnv_references:Writing reference data to /home/tenggao/paper_data/infercnv_out/58408_Primary_0.9_0/infercnv.references.txt
There were 50 or more warnings (use warnings() to see the first 50)
